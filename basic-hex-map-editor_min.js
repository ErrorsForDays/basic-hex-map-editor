(function(a,b){function c(a,c,d){if(d===b&&1===a.nodeType)if(d="data-"+c.replace(Ta,"-$1").toLowerCase(),d=a.getAttribute(d),"string"===typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:Pa.test(d)?j.parseJSON(d):d}catch(e){}j.data(a,c,d)}else d=b;return d}function d(a){for(var b in a)if(!("data"===b&&j.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function e(){return!1}function f(){return!0}function g(a){return!a||!a.parentNode||11===a.parentNode.nodeType}function h(a,
b){do a=a[b];while(a&&1!==a.nodeType);return a}function l(a,b,c){b=b||0;if(j.isFunction(b))return j.grep(a,function(a,aa){return!!b.call(a,aa,a)===c});if(b.nodeType)return j.grep(a,function(a){return a===b===c});if("string"===typeof b){var d=j.grep(a,function(a){return 1===a.nodeType});if(re.test(b))return j.filter(b,d,!c);b=j.filter(b,d)}return j.grep(a,function(a){return 0<=j.inArray(a,b)===c})}function m(a){var b=Wd.split("|");a=a.createDocumentFragment();if(a.createElement)for(;b.length;)a.createElement(b.pop());
return a}function n(a,b){if(1===b.nodeType&&j.hasData(a)){var c,d,e;d=j._data(a);var f=j._data(b,d),g=d.events;if(g)for(c in delete f.handle,f.events={},g){d=0;for(e=g[c].length;d<e;d++)j.event.add(b,c,g[c][d])}f.data&&(f.data=j.extend({},f.data))}}function q(a,b){var c;1===b.nodeType&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),j.support.html5Clone&&(a.innerHTML&&!j.trim(b.innerHTML))&&
(b.innerHTML=a.innerHTML)):"input"===c&&Xd.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.selected=a.defaultSelected:"input"===c||"textarea"===c?b.defaultValue=a.defaultValue:"script"===c&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(j.expando))}function p(a){return"undefined"!==typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!==typeof a.querySelectorAll?a.querySelectorAll("*"):[]}function t(a){Xd.test(a.type)&&(a.defaultChecked=
a.checked)}function u(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=jc.length;e--;)if(b=jc[e]+c,b in a)return b;return d}function r(a,b){a=b||a;return"none"===j.css(a,"display")||!j.contains(a.ownerDocument,a)}function s(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)c=a[f],c.style&&(e[f]=j._data(c,"olddisplay"),b?(!e[f]&&"none"===c.style.display&&(c.style.display=""),""===c.style.display&&r(c)&&(e[f]=j._data(c,"olddisplay",w(c.nodeName)))):(d=ib(c,"display"),!e[f]&&"none"!==
d&&j._data(c,"olddisplay",d)));for(f=0;f<g;f++)if(c=a[f],c.style&&(!b||"none"===c.style.display||""===c.style.display))c.style.display=b?e[f]||"":"none";return a}function A(a,b,c){return(a=oc.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function v(a,b,c,d){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var e=0;4>b;b+=2)"margin"===c&&(e+=j.css(a,c+Qa[b],!0)),d?("content"===c&&(e-=parseFloat(ib(a,"padding"+Qa[b]))||0),"margin"!==c&&(e-=parseFloat(ib(a,"border"+Qa[b]+"Width"))||0)):(e+=parseFloat(ib(a,
"padding"+Qa[b]))||0,"padding"!==c&&(e+=parseFloat(ib(a,"border"+Qa[b]+"Width"))||0));return e}function B(a,b,c){var d="width"===b?a.offsetWidth:a.offsetHeight,e=!0,f=j.support.boxSizing&&"border-box"===j.css(a,"boxSizing");if(0>=d||null==d){d=ib(a,b);if(0>d||null==d)d=a.style[b];if(kc.test(d))return d;e=f&&(j.support.boxSizingReliable||d===a.style[b]);d=parseFloat(d)||0}return d+v(a,b,c||(f?"border":"content"),e)+"px"}function w(a){if(jb[a])return jb[a];var b=j("<"+a+">").appendTo(E.body),c=b.css("display");
b.remove();if("none"===c||""===c){bc=E.body.appendChild(bc||j.extend(E.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Hb||!bc.createElement)Hb=(bc.contentWindow||bc.contentDocument).document,Hb.write("<!doctype html><html><body>"),Hb.close();b=Hb.body.appendChild(Hb.createElement(a));c=ib(b,"display");E.body.removeChild(bc)}return jb[a]=c}function F(a,b,c,d){var e;if(j.isArray(b))j.each(b,function(b,e){c||eb.test(a)?d(a,e):F(a+"["+("object"===typeof e?b:"")+"]",e,c,d)});else if(!c&&
"object"===j.type(b))for(e in b)F(a+"["+e+"]",b[e],c,d);else d(a,b)}function K(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,e,f=b.toLowerCase().split(mb),g=0,k=f.length;if(j.isFunction(c))for(;g<k;g++)d=f[g],(e=/^\+/.test(d))&&(d=d.substr(1)||"*"),d=a[d]=a[d]||[],d[e?"unshift":"push"](c)}}function C(a,c,d,e,f,g){f=f||c.dataTypes[0];g=g||{};g[f]=!0;var j;f=a[f];for(var k=0,h=f?f.length:0,l=a===Ib;k<h&&(l||!j);k++)j=f[k](c,d,e),"string"===typeof j&&(!l||g[j]?j=b:(c.dataTypes.unshift(j),
j=C(a,c,d,e,j,g)));if((l||!j)&&!g["*"])j=C(a,c,d,e,"*",g);return j}function z(a,c){var d,e,f=j.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&j.extend(!0,a,e)}function N(){try{return new a.XMLHttpRequest}catch(b){}}function O(){setTimeout(function(){Ec=b},0);return Ec=j.now()}function L(a,b,c){var d,e=0,f=Wc.length,g=j.Deferred().always(function(){delete k.elem}),k=function(){for(var b=Ec||O(),b=Math.max(0,h.startTime+h.duration-b),c=1-(b/h.duration||0),d=0,e=h.tweens.length;d<
e;d++)h.tweens[d].run(c);g.notifyWith(a,[h,c,b]);if(1>c&&e)return b;g.resolveWith(a,[h]);return!1},h=g.promise({elem:a,props:j.extend({},b),opts:j.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Ec||O(),duration:c.duration,tweens:[],createTween:function(b,c){var d=j.Tween(a,h.opts,b,c,h.opts.specialEasing[b]||h.opts.easing);h.tweens.push(d);return d},stop:function(b){for(var c=0,d=b?h.tweens.length:0;c<d;c++)h.tweens[c].run(1);b?g.resolveWith(a,[h,b]):g.rejectWith(a,
[h,b]);return this}});b=h.props;c=h.opts.specialEasing;var l,H,m,n;for(d in b)if(l=j.camelCase(d),H=c[l],m=b[d],j.isArray(m)&&(H=m[1],m=b[d]=m[0]),d!==l&&(b[l]=m,delete b[d]),(n=j.cssHooks[l])&&"expand"in n)for(d in m=n.expand(m),delete b[l],m)d in b||(b[d]=m[d],c[d]=H);else c[l]=H;for(;e<f;e++)if(d=Wc[e].call(h,a,b,h.opts))return d;var p=h;j.each(b,function(a,b){for(var c=(Xb[a]||[]).concat(Xb["*"]),d=0,aa=c.length;d<aa&&!c[d].call(p,a,b);d++);});j.isFunction(h.opts.start)&&h.opts.start.call(a,h);
j.fx.timer(j.extend(k,{anim:h,queue:h.opts.queue,elem:a}));return h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function U(a,b,c,d,e){return new U.prototype.init(a,b,c,d,e)}function D(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=Qa[e],d["margin"+c]=d["padding"+c]=a;b&&(d.opacity=d.width=a);return d}function M(a){return j.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var I,J,E=a.document,Y=a.location,ia=a.navigator,Ra=
a.jQuery,Sa=a.$,Q=Array.prototype.push,ba=Array.prototype.slice,ua=Array.prototype.indexOf,fa=Object.prototype.toString,qa=Object.prototype.hasOwnProperty,P=String.prototype.trim,j=function(a,b){return new j.fn.init(a,b,I)},ya=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,Jb=/\S/,mb=/\s+/,za=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Aa=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,ga=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,wa=/^[\],:{}\s]*$/,ca=/(?:^|:|,)(?:\s*\[)+/g,da=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ta=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,
na=/^-ms-/,Ba=/-([\da-z])/gi,wb=function(a,b){return(b+"").toUpperCase()},xb=function(){E.addEventListener?(E.removeEventListener("DOMContentLoaded",xb,!1),j.ready()):"complete"===E.readyState&&(E.detachEvent("onreadystatechange",xb),j.ready())},la={};j.fn=j.prototype={constructor:j,init:function(a,c,d){var e;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if("string"===typeof a){if((e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:Aa.exec(a))&&
(e[1]||!c)){if(e[1])return a=(c=c instanceof j?c[0]:c)&&c.nodeType?c.ownerDocument||c:E,a=j.parseHTML(e[1],a,!0),ga.test(e[1])&&j.isPlainObject(c)&&this.attr.call(a,c,!0),j.merge(this,a);if((c=E.getElementById(e[2]))&&c.parentNode){if(c.id!==e[2])return d.find(a);this.length=1;this[0]=c}this.context=E;this.selector=a;return this}return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}if(j.isFunction(a))return d.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return j.makeArray(a,
this)},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return ba.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){a=j.merge(this.constructor(),a);a.prevObject=this;a.context=this.context;"find"===b?a.selector=this.selector+(this.selector?" ":"")+c:b&&(a.selector=this.selector+"."+b+"("+c+")");return a},each:function(a,b){return j.each(this,a,b)},ready:function(a){j.ready.promise().done(a);
return this},eq:function(a){a=+a;return-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(ba.apply(this,arguments),"slice",ba.call(arguments).join(","))},map:function(a){return this.pushStack(j.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:Q,sort:[].sort,splice:[].splice};j.fn.init.prototype=j.fn;j.extend=j.fn.extend=function(){var a,
c,d,e,f,g=arguments[0]||{},k=1,h=arguments.length,l=!1;"boolean"===typeof g&&(l=g,g=arguments[1]||{},k=2);"object"!==typeof g&&!j.isFunction(g)&&(g={});h===k&&(g=this,--k);for(;k<h;k++)if(null!=(a=arguments[k]))for(c in a)d=g[c],e=a[c],g!==e&&(l&&e&&(j.isPlainObject(e)||(f=j.isArray(e)))?(f?(f=!1,d=d&&j.isArray(d)?d:[]):d=d&&j.isPlainObject(d)?d:{},g[c]=j.extend(l,d,e)):e!==b&&(g[c]=e));return g};j.extend({noConflict:function(b){a.$===j&&(a.$=Sa);b&&a.jQuery===j&&(a.jQuery=Ra);return j},isReady:!1,
readyWait:1,holdReady:function(a){a?j.readyWait++:j.ready(!0)},ready:function(a){if(!(!0===a?--j.readyWait:j.isReady)){if(!E.body)return setTimeout(j.ready,1);j.isReady=!0;!0!==a&&0<--j.readyWait||(J.resolveWith(E,[j]),j.fn.trigger&&j(E).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===j.type(a)},isArray:Array.isArray||function(a){return"array"===j.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==
a?String(a):la[fa.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==j.type(a)||a.nodeType||j.isWindow(a))return!1;try{if(a.constructor&&!qa.call(a,"constructor")&&!qa.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var d in a);return d===b||qa.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a);},parseHTML:function(a,b,c){var d;if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=0);b=b||
E;if(d=ga.exec(a))return[b.createElement(d[1])];d=j.buildFragment([a],b,c?null:[]);return j.merge([],(d.cacheable?j.clone(d.fragment):d.fragment).childNodes)},parseJSON:function(b){if(!b||"string"!==typeof b)return null;b=j.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(wa.test(b.replace(da,"@").replace(ta,"]").replace(ca,"")))return(new Function("return "+b))();j.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||"string"!==typeof c)return null;try{a.DOMParser?(e=new DOMParser,
d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&j.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&Jb.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(na,"ms-").replace(Ba,wb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,
c,d){var e,f=0,g=a.length,k=g===b||j.isFunction(a);if(d)if(k)for(e in a){if(!1===c.apply(a[e],d))break}else for(;f<g&&!1!==c.apply(a[f++],d););else if(k)for(e in a){if(!1===c.call(a[e],e,a[e]))break}else for(;f<g&&!1!==c.call(a[f],f,a[f++]););return a},trim:P&&!P.call("\ufeff\u00a0")?function(a){return null==a?"":P.call(a)}:function(a){return null==a?"":(a+"").replace(za,"")},makeArray:function(a,b){var c,d=b||[];null!=a&&(c=j.type(a),null==a.length||"string"===c||"function"===c||"regexp"===c||j.isWindow(a)?
Q.call(d,a):j.merge(d,a));return d},inArray:function(a,b,c){var d;if(b){if(ua)return ua.call(b,a,c);d=b.length;for(c=c?0>c?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"===typeof d)for(;f<d;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];a.length=e;return a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;f<g;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,c,d){var e,f,g=[],k=0,h=a.length;if(a instanceof
j||h!==b&&"number"===typeof h&&(0<h&&a[0]&&a[h-1]||0===h||j.isArray(a)))for(;k<h;k++)e=c(a[k],k,d),null!=e&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),null!=e&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e;"string"===typeof c&&(d=a[c],c=a,a=d);if(!j.isFunction(a))return b;e=ba.call(arguments,2);d=function(){return a.apply(c,e.concat(ba.call(arguments)))};d.guid=a.guid=a.guid||j.guid++;return d},access:function(a,c,d,e,f,g,k){var h,l=null==d,H=0,m=a.length;if(d&&
"object"===typeof d){for(H in d)j.access(a,c,H,d[H],1,g,e);f=1}else if(e!==b){h=k===b&&j.isFunction(e);l&&(h?(h=c,c=function(a,b,c){return h.call(j(a),c)}):(c.call(a,e),c=null));if(c)for(;H<m;H++)c(a[H],d,h?e.call(a[H],H,c(a[H],d)):e,k);f=1}return f?a:l?c.call(a):m?c(a[0],d):g},now:function(){return(new Date).getTime()}});j.ready.promise=function(b){if(!J)if(J=j.Deferred(),"complete"===E.readyState)setTimeout(j.ready,1);else if(E.addEventListener)E.addEventListener("DOMContentLoaded",xb,!1),a.addEventListener("load",
j.ready,!1);else{E.attachEvent("onreadystatechange",xb);a.attachEvent("onload",j.ready);var c=!1;try{c=null==a.frameElement&&E.documentElement}catch(d){}c&&c.doScroll&&function xc(){if(!j.isReady){try{c.doScroll("left")}catch(a){return setTimeout(xc,50)}j.ready()}}()}return J.promise(b)};j.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){la["[object "+b+"]"]=b.toLowerCase()});I=j(E);var fb={};j.Callbacks=function(a){var c;if("string"===typeof a){if(!(c=fb[a])){c=
a;var d=fb[c]={};j.each(c.split(mb),function(a,b){d[b]=!0});c=d}}else c=j.extend({},a);a=c;var e,f,g,k,h,l,H=[],m=!a.once&&[],n=function(b){e=a.memory&&b;f=!0;l=k||0;k=0;h=H.length;for(g=!0;H&&l<h;l++)if(!1===H[l].apply(b[0],b[1])&&a.stopOnFalse){e=!1;break}g=!1;H&&(m?m.length&&n(m.shift()):e?H=[]:p.disable())},p={add:function(){if(H){var b=H.length;(function Ia(b){j.each(b,function(b,c){var d=j.type(c);"function"===d?(!a.unique||!p.has(c))&&H.push(c):c&&(c.length&&"string"!==d)&&Ia(c)})})(arguments);
g?h=H.length:e&&(k=b,n(e))}return this},remove:function(){H&&j.each(arguments,function(a,b){for(var c;-1<(c=j.inArray(b,H,c));)H.splice(c,1),g&&(c<=h&&h--,c<=l&&l--)});return this},has:function(a){return-1<j.inArray(a,H)},empty:function(){H=[];return this},disable:function(){H=m=e=b;return this},disabled:function(){return!H},lock:function(){m=b;e||p.disable();return this},locked:function(){return!m},fireWith:function(a,b){b=b||[];b=[a,b.slice?b.slice():b];if(H&&(!f||m))g?m.push(b):n(b);return this},
fire:function(){p.fireWith(this,arguments);return this},fired:function(){return!!f}};return p};j.extend({Deferred:function(a){var b=[["resolve","done",j.Callbacks("once memory"),"resolved"],["reject","fail",j.Callbacks("once memory"),"rejected"],["notify","progress",j.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var a=arguments;return j.Deferred(function(c){j.each(b,function(b,d){var aa=d[0],f=a[b];
e[d[1]](j.isFunction(f)?function(){var a=f.apply(this,arguments);if(a&&j.isFunction(a.promise))a.promise().done(c.resolve).fail(c.reject).progress(c.notify);else c[aa+"With"](this===e?c:this,[a])}:c[aa])});a=null}).promise()},promise:function(a){return null!=a?j.extend(a,d):d}},e={};d.pipe=d.then;j.each(b,function(a,aa){var f=aa[2],g=aa[3];d[aa[1]]=f.add;g&&f.add(function(){c=g},b[a^1][2].disable,b[2][2].lock);e[aa[0]]=f.fire;e[aa[0]+"With"]=f.fireWith});d.promise(e);a&&a.call(e,e);return e},when:function(a){var b=
0,c=ba.call(arguments),d=c.length,e=1!==d||a&&j.isFunction(a.promise)?d:0,f=1===e?a:j.Deferred(),g=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?ba.call(arguments):d;c===k?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},k,h,l;if(1<d){k=Array(d);h=Array(d);for(l=Array(d);b<d;b++)c[b]&&j.isFunction(c[b].promise)?c[b].promise().done(g(b,l,c)).fail(f.reject).progress(g(b,h,k)):--e}e||f.resolveWith(l,c);return f.promise()}});var gb=j,Ya;var Ea,Eb,kb,Kb,Lb,bb,rb,nb,ra,Fa,cc,xa=E.createElement("div");
xa.setAttribute("className","t");xa.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";Eb=xa.getElementsByTagName("*");kb=xa.getElementsByTagName("a")[0];if(!Eb||!kb||!Eb.length)Ya={};else{Kb=E.createElement("select");Lb=Kb.appendChild(E.createElement("option"));bb=xa.getElementsByTagName("input")[0];kb.style.cssText="top:1px;float:left;opacity:.5";Ea={leadingWhitespace:3===xa.firstChild.nodeType,tbody:!xa.getElementsByTagName("tbody").length,htmlSerialize:!!xa.getElementsByTagName("link").length,
style:/top/.test(kb.getAttribute("style")),hrefNormalized:"/a"===kb.getAttribute("href"),opacity:/^0.5/.test(kb.style.opacity),cssFloat:!!kb.style.cssFloat,checkOn:"on"===bb.value,optSelected:Lb.selected,getSetAttribute:"t"!==xa.className,enctype:!!E.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==E.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===E.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,
shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1};bb.checked=!0;Ea.noCloneChecked=bb.cloneNode(!0).checked;Kb.disabled=!0;Ea.optDisabled=!Lb.disabled;try{delete xa.test}catch(hb){Ea.deleteExpando=!1}!xa.addEventListener&&(xa.attachEvent&&xa.fireEvent)&&(xa.attachEvent("onclick",cc=function(){Ea.noCloneEvent=!1}),xa.cloneNode(!0).fireEvent("onclick"),xa.detachEvent("onclick",cc));bb=E.createElement("input");bb.value="t";bb.setAttribute("type","radio");Ea.radioValue=
"t"===bb.value;bb.setAttribute("checked","checked");bb.setAttribute("name","t");xa.appendChild(bb);rb=E.createDocumentFragment();rb.appendChild(xa.lastChild);Ea.checkClone=rb.cloneNode(!0).cloneNode(!0).lastChild.checked;Ea.appendChecked=bb.checked;rb.removeChild(bb);rb.appendChild(xa);if(xa.attachEvent)for(ra in{submit:!0,change:!0,focusin:!0})nb="on"+ra,Fa=nb in xa,Fa||(xa.setAttribute(nb,"return;"),Fa="function"===typeof xa[nb]),Ea[ra+"Bubbles"]=Fa;j(function(){var b,c,d,e=E.getElementsByTagName("body")[0];
e&&(b=E.createElement("div"),b.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",e.insertBefore(b,e.firstChild),c=E.createElement("div"),b.appendChild(c),c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",d=c.getElementsByTagName("td"),d[0].style.cssText="padding:0;margin:0;border:0;display:none",Fa=0===d[0].offsetHeight,d[0].style.display="",d[1].style.display="none",Ea.reliableHiddenOffsets=Fa&&0===d[0].offsetHeight,c.innerHTML="",c.style.cssText=
"box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",Ea.boxSizing=4===c.offsetWidth,Ea.doesNotIncludeMarginInBodyOffset=1!==e.offsetTop,a.getComputedStyle&&(Ea.pixelPosition="1%"!==(a.getComputedStyle(c,null)||{}).top,Ea.boxSizingReliable="4px"===(a.getComputedStyle(c,null)||{width:"4px"}).width,d=E.createElement("div"),d.style.cssText=c.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;",
d.style.marginRight=d.style.width="0",c.style.width="1px",c.appendChild(d),Ea.reliableMarginRight=!parseFloat((a.getComputedStyle(d,null)||{}).marginRight)),"undefined"!==typeof c.style.zoom&&(c.innerHTML="",c.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;width:1px;padding:1px;display:inline;zoom:1",Ea.inlineBlockNeedsLayout=3===c.offsetWidth,c.style.display="block",c.style.overflow="visible",c.innerHTML="<div></div>",c.firstChild.style.width="5px",Ea.shrinkWrapBlocks=3!==
c.offsetWidth,b.style.zoom=1),e.removeChild(b))});rb.removeChild(xa);Eb=kb=Kb=Lb=bb=rb=xa=null;Ya=Ea}gb.support=Ya;var Pa=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ta=/([A-Z])/g;j.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(j.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?j.cache[a[j.expando]]:a[j.expando];return!!a&&!d(a)},data:function(a,c,d,e){if(j.acceptData(a)){var f=j.expando,g="string"===
typeof c,k=a.nodeType,h=k?j.cache:a,l=k?a[f]:a[f]&&f;if(l&&h[l]&&(e||h[l].data)||!(g&&d===b)){l||(k?a[f]=l=j.deletedIds.pop()||j.guid++:l=f);h[l]||(h[l]={},k||(h[l].toJSON=j.noop));if("object"===typeof c||"function"===typeof c)e?h[l]=j.extend(h[l],c):h[l].data=j.extend(h[l].data,c);a=h[l];e||(a.data||(a.data={}),a=a.data);d!==b&&(a[j.camelCase(c)]=d);g?(d=a[c],null==d&&(d=a[j.camelCase(c)])):d=a;return d}}},removeData:function(a,b,c){if(j.acceptData(a)){var e,f,g,k=a.nodeType,h=k?j.cache:a,l=k?a[j.expando]:
j.expando;if(h[l]){if(b&&(e=c?h[l]:h[l].data)){j.isArray(b)||(b in e?b=[b]:(b=j.camelCase(b),b=b in e?[b]:b.split(" ")));f=0;for(g=b.length;f<g;f++)delete e[b[f]];if(!(c?d:j.isEmptyObject)(e))return}if(!c&&(delete h[l].data,!d(h[l])))return;k?j.cleanData([a],!0):j.support.deleteExpando||h!=h.window?delete h[l]:h[l]=null}}},_data:function(a,b,c){return j.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&j.noData[a.nodeName.toLowerCase()];return!b||!0!==b&&a.getAttribute("classid")===b}});j.fn.extend({data:function(a,
d){var e,f,g,k,h,l=this[0],H=0,m=null;if(a===b){if(this.length&&(m=j.data(l),1===l.nodeType&&!j._data(l,"parsedAttrs"))){g=l.attributes;for(h=g.length;H<h;H++)k=g[H].name,k.indexOf("data-")||(k=j.camelCase(k.substring(5)),c(l,k,m[k]));j._data(l,"parsedAttrs",!0)}return m}if("object"===typeof a)return this.each(function(){j.data(this,a)});e=a.split(".",2);e[1]=e[1]?"."+e[1]:"";f=e[1]+"!";return j.access(this,function(d){if(d===b)return m=this.triggerHandler("getData"+f,[e[0]]),m===b&&l&&(m=j.data(l,
a),m=c(l,a,m)),m===b&&e[1]?this.data(e[0]):m;e[1]=d;this.each(function(){var b=j(this);b.triggerHandler("setData"+f,e);j.data(this,a,d);b.triggerHandler("changeData"+f,e)})},null,d,1<arguments.length,null,!1)},removeData:function(a){return this.each(function(){j.removeData(this,a)})}});j.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=j._data(a,b),c&&(!d||j.isArray(c)?d=j._data(a,b,j.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=j.queue(a,b),d=c.length,
e=c.shift(),f=j._queueHooks(a,b),g=function(){j.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--);e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f));!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return j._data(a,c)||j._data(a,c,{empty:j.Callbacks("once memory").add(function(){j.removeData(a,b+"queue",!0);j.removeData(a,c,!0)})})}});j.fn.extend({queue:function(a,c){var d=2;"string"!==typeof a&&(c=a,a="fx",d--);return arguments.length<d?j.queue(this[0],a):c===
b?this:this.each(function(){var b=j.queue(this,a,c);j._queueHooks(this,a);"fx"===a&&"inprogress"!==b[0]&&j.dequeue(this,a)})},dequeue:function(a){return this.each(function(){j.dequeue(this,a)})},delay:function(a,b){a=j.fx?j.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=j.Deferred(),g=this,k=this.length,h=function(){--e||f.resolveWith(g,[g])};
"string"!==typeof a&&(c=a,a=b);for(a=a||"fx";k--;)if((d=j._data(g[k],a+"queueHooks"))&&d.empty)e++,d.empty.add(h);h();return f.promise(c)}});var sb,k,Mb,Za=/[\t\r\n]/g,ob=/\r/g,yb=/^(?:button|input)$/i,Yb=/^(?:button|input|object|select|textarea)$/i,Xc=/^a(?:rea|)$/i,Fc=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Gc=j.support.getSetAttribute;j.fn.extend({attr:function(a,b){return j.access(this,j.attr,a,b,1<arguments.length)},
removeAttr:function(a){return this.each(function(){j.removeAttr(this,a)})},prop:function(a,b){return j.access(this,j.prop,a,b,1<arguments.length)},removeProp:function(a){a=j.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,k;if(j.isFunction(a))return this.each(function(b){j(this).addClass(a.call(this,b,this.className))});if(a&&"string"===typeof a){b=a.split(mb);c=0;for(d=this.length;c<d;c++)if(e=this[c],1===e.nodeType)if(!e.className&&
1===b.length)e.className=a;else{f=" "+e.className+" ";g=0;for(k=b.length;g<k;g++)0>f.indexOf(" "+b[g]+" ")&&(f+=b[g]+" ");e.className=j.trim(f)}}return this},removeClass:function(a){var c,d,e,f,g,k,h;if(j.isFunction(a))return this.each(function(b){j(this).removeClass(a.call(this,b,this.className))});if(a&&"string"===typeof a||a===b){c=(a||"").split(mb);k=0;for(h=this.length;k<h;k++)if(e=this[k],1===e.nodeType&&e.className){d=(" "+e.className+" ").replace(Za," ");f=0;for(g=c.length;f<g;f++)for(;0<=
d.indexOf(" "+c[f]+" ");)d=d.replace(" "+c[f]+" "," ");e.className=a?j.trim(d):""}}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"===typeof b;return j.isFunction(a)?this.each(function(c){j(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,f=0,g=j(this),k=b,h=a.split(mb);e=h[f++];)k=d?k:!g.hasClass(e),g[k?"addClass":"removeClass"](e);else if("undefined"===c||"boolean"===c)this.className&&j._data(this,"__className__",this.className),
this.className=this.className||!1===a?"":j._data(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(Za," ").indexOf(a))return!0;return!1},val:function(a){var c,d,e,f=this[0];if(arguments.length)return e=j.isFunction(a),this.each(function(d){var f=j(this);if(1===this.nodeType&&(d=e?a.call(this,d,f.val()):a,null==d?d="":"number"===typeof d?d+="":j.isArray(d)&&(d=j.map(d,function(a){return null==
a?"":a+""})),c=j.valHooks[this.type]||j.valHooks[this.nodeName.toLowerCase()],!c||!("set"in c)||c.set(this,d,"value")===b))this.value=d});if(f){if((c=j.valHooks[f.type]||j.valHooks[f.nodeName.toLowerCase()])&&"get"in c&&(d=c.get(f,"value"))!==b)return d;d=f.value;return"string"===typeof d?d.replace(ob,""):null==d?"":d}}});j.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e=(a=
"select-one"===a.type||0>d)?null:[],f=a?d+1:c.length,g=0>d?f:a?d:0;g<f;g++)if(b=c[g],(b.selected||g===d)&&(j.support.optDisabled?!b.disabled:null===b.getAttribute("disabled"))&&(!b.parentNode.disabled||!j.nodeName(b.parentNode,"optgroup"))){b=j(b).val();if(a)return b;e.push(b)}return e},set:function(a,b){var c=j.makeArray(b);j(a).find("option").each(function(){this.selected=0<=j.inArray(j(this).val(),c)});c.length||(a.selectedIndex=-1);return c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h=a.nodeType;
if(a&&!(3===h||8===h||2===h)){if(e&&j.isFunction(j.fn[c]))return j(a)[c](d);if("undefined"===typeof a.getAttribute)return j.prop(a,c,d);if(e=1!==h||!j.isXMLDoc(a))c=c.toLowerCase(),g=j.attrHooks[c]||(Fc.test(c)?k:sb);if(d!==b)if(null===d)j.removeAttr(a,c);else{if(g&&"set"in g&&e&&(f=g.set(a,d,c))!==b)return f;a.setAttribute(c,d+"");return d}else{if(g&&"get"in g&&e&&null!==(f=g.get(a,c)))return f;f=a.getAttribute(c);return null===f?b:f}}},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&1===a.nodeType)for(d=
b.split(mb);g<d.length;g++)if(e=d[g])c=j.propFix[e]||e,(f=Fc.test(e))||j.attr(a,e,""),a.removeAttribute(Gc?e:c),f&&c in a&&(a[c]=!1)},attrHooks:{type:{set:function(a,b){if(yb.test(a.nodeName)&&a.parentNode)j.error("type property can't be changed");else if(!j.support.radioValue&&"radio"===b&&j.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);return b}}},value:{get:function(a,b){return sb&&j.nodeName(a,"button")?sb.get(a,b):b in a?a.value:null},set:function(a,b,c){if(sb&&j.nodeName(a,
"button"))return sb.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g;g=a.nodeType;if(a&&!(3===g||8===g||2===g)){if(g=1!==g||!j.isXMLDoc(a))c=j.propFix[c]||c,f=j.propHooks[c];return d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:
a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):Yb.test(a.nodeName)||Xc.test(a.nodeName)&&a.href?0:b}}}});k={get:function(a,c){var d,e=j.prop(a,c);return!0===e||"boolean"!==typeof e&&(d=a.getAttributeNode(c))&&!1!==d.nodeValue?c.toLowerCase():b},set:function(a,b,c){!1===b?j.removeAttr(a,c):(b=j.propFix[c]||c,b in a&&(a[b]=!0),a.setAttribute(c,c.toLowerCase()));return c}};Gc||(Mb=
{name:!0,id:!0,coords:!0},sb=j.valHooks.button={get:function(a,c){var d;return(d=a.getAttributeNode(c))&&(Mb[c]?""!==d.value:d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);d||(d=E.createAttribute(c),a.setAttributeNode(d));return d.value=b+""}},j.each(["width","height"],function(a,b){j.attrHooks[b]=j.extend(j.attrHooks[b],{set:function(a,c){if(""===c)return a.setAttribute(b,"auto"),c}})}),j.attrHooks.contenteditable={get:sb.get,set:function(a,b,c){""===b&&(b="false");sb.set(a,
b,c)}});j.support.hrefNormalized||j.each(["href","src","width","height"],function(a,c){j.attrHooks[c]=j.extend(j.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return null===a?b:a}})});j.support.style||(j.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=b+""}});j.support.optSelected||(j.propHooks.selected=j.extend(j.propHooks.selected,{get:function(a){if(a=a.parentNode)a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex;return null}}));
j.support.enctype||(j.propFix.enctype="encoding");j.support.checkOn||j.each(["radio","checkbox"],function(){j.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}});j.each(["radio","checkbox"],function(){j.valHooks[this]=j.extend(j.valHooks[this],{set:function(a,b){if(j.isArray(b))return a.checked=0<=j.inArray(j(a).val(),b)}})});var pc=/^(?:textarea|input|select)$/i,qc=/^([^\.]*|)(?:\.(.+)|)$/,Oc=/(?:^|\s)hover(\.\S+|)\b/,Yc=/^key/,Zc=/^(?:mouse|contextmenu)|click/,
yc=/^(?:focusinfocus|focusoutblur)$/,zc=function(a){return j.event.special.hover?a:a.replace(Oc,"mouseenter$1 mouseleave$1")};j.event={add:function(a,c,d,e,f){var g,k,h,l,H,m,n,p,q;if(!(3===a.nodeType||8===a.nodeType||!c||!d||!(g=j._data(a)))){d.handler&&(n=d,d=n.handler,f=n.selector);d.guid||(d.guid=j.guid++);h=g.events;h||(g.events=h={});k=g.handle;k||(g.handle=k=function(a){return"undefined"!==typeof j&&(!a||j.event.triggered!==a.type)?j.event.dispatch.apply(k.elem,arguments):b},k.elem=a);c=j.trim(zc(c)).split(" ");
for(g=0;g<c.length;g++){l=qc.exec(c[g])||[];H=l[1];m=(l[2]||"").split(".").sort();q=j.event.special[H]||{};H=(f?q.delegateType:q.bindType)||H;q=j.event.special[H]||{};l=j.extend({type:H,origType:l[1],data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&j.expr.match.needsContext.test(f),namespace:m.join(".")},n);p=h[H];if(!p&&(p=h[H]=[],p.delegateCount=0,!q.setup||!1===q.setup.call(a,e,m,k)))a.addEventListener?a.addEventListener(H,k,!1):a.attachEvent&&a.attachEvent("on"+H,k);q.add&&(q.add.call(a,
l),l.handler.guid||(l.handler.guid=d.guid));f?p.splice(p.delegateCount++,0,l):p.push(l);j.event.global[H]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var f,g,k,h,l,H,m,n,p,q,r=j.hasData(a)&&j._data(a);if(r&&(m=r.events)){b=j.trim(zc(b||"")).split(" ");for(f=0;f<b.length;f++)if(g=qc.exec(b[f])||[],k=h=g[1],g=g[2],k){n=j.event.special[k]||{};k=(d?n.delegateType:n.bindType)||k;p=m[k]||[];l=p.length;g=g?RegExp("(^|\\.)"+g.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(H=0;H<p.length;H++)if(q=
p[H],(e||h===q.origType)&&(!c||c.guid===q.guid)&&(!g||g.test(q.namespace))&&(!d||d===q.selector||"**"===d&&q.selector))p.splice(H--,1),q.selector&&p.delegateCount--,n.remove&&n.remove.call(a,q);0===p.length&&l!==p.length&&((!n.teardown||!1===n.teardown.call(a,g,r.handle))&&j.removeEvent(a,k,r.handle),delete m[k])}else for(k in m)j.event.remove(a,k+b[f],c,d,!0);j.isEmptyObject(m)&&(delete r.handle,j.removeData(a,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,
e,f){if(!e||!(3===e.nodeType||8===e.nodeType)){var g,k,h,l,H,m,n=c.type||c;h=[];if(!yc.test(n+j.event.triggered)&&(0<=n.indexOf("!")&&(n=n.slice(0,-1),g=!0),0<=n.indexOf(".")&&(h=n.split("."),n=h.shift(),h.sort()),e&&!j.event.customEvent[n]||j.event.global[n]))if(c="object"===typeof c?c[j.expando]?c:new j.Event(n,c):new j.Event(n),c.type=n,c.isTrigger=!0,c.exclusive=g,c.namespace=h.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=0>n.indexOf(":")?"on"+
n:"",e){if(c.result=b,c.target||(c.target=e),d=null!=d?j.makeArray(d):[],d.unshift(c),l=j.event.special[n]||{},!(l.trigger&&!1===l.trigger.apply(e,d))){m=[[e,l.bindType||n]];if(!f&&!l.noBubble&&!j.isWindow(e)){H=l.delegateType||n;g=yc.test(H+n)?e:e.parentNode;for(k=e;g;g=g.parentNode)m.push([g,H]),k=g;if(k===(e.ownerDocument||E))m.push([k.defaultView||k.parentWindow||a,H])}for(k=0;k<m.length&&!c.isPropagationStopped();k++)g=m[k][0],c.type=m[k][1],(H=(j._data(g,"events")||{})[c.type]&&j._data(g,"handle"))&&
H.apply(g,d),(H=h&&g[h])&&(j.acceptData(g)&&H.apply&&!1===H.apply(g,d))&&c.preventDefault();c.type=n;if(!f&&!c.isDefaultPrevented()&&(!l._default||!1===l._default.apply(e.ownerDocument,d))&&!("click"===n&&j.nodeName(e,"a"))&&j.acceptData(e))if(h&&e[n]&&("focus"!==n&&"blur"!==n||0!==c.target.offsetWidth)&&!j.isWindow(e))(k=e[h])&&(e[h]=null),j.event.triggered=n,e[n](),j.event.triggered=b,k&&(e[h]=k);return c.result}}else for(k in e=j.cache,e)e[k].events&&e[k].events[n]&&j.event.trigger(c,d,e[k].handle.elem,
!0)}},dispatch:function(c){c=j.event.fix(c||a.event);var d,e,f,g,k,h,l=(j._data(this,"events")||{})[c.type]||[],H=l.delegateCount,m=ba.call(arguments),n=!c.exclusive&&!c.namespace,p=j.event.special[c.type]||{},q=[];m[0]=c;c.delegateTarget=this;if(!(p.preDispatch&&!1===p.preDispatch.call(this,c))){if(H&&!(c.button&&"click"===c.type))for(e=c.target;e!=this;e=e.parentNode||this)if(!0!==e.disabled||"click"!==c.type){g={};k=[];for(d=0;d<H;d++)f=l[d],h=f.selector,g[h]===b&&(g[h]=f.needsContext?0<=j(h,this).index(e):
j.find(h,this,null,[e]).length),g[h]&&k.push(f);k.length&&q.push({elem:e,matches:k})}l.length>H&&q.push({elem:this,matches:l.slice(H)});for(d=0;d<q.length&&!c.isPropagationStopped();d++){g=q[d];c.currentTarget=g.elem;for(e=0;e<g.matches.length&&!c.isImmediatePropagationStopped();e++)if(f=g.matches[e],n||!c.namespace&&!f.namespace||c.namespace_re&&c.namespace_re.test(f.namespace))c.data=f.data,c.handleObj=f,f=((j.event.special[f.origType]||{}).handle||f.handler).apply(g.elem,m),f!==b&&(c.result=f,
!1===f&&(c.preventDefault(),c.stopPropagation()))}p.postDispatch&&p.postDispatch.call(this,c);return c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(a,c){var d,e,f=c.button,g=c.fromElement;null==a.pageX&&null!=c.clientX&&(d=a.target.ownerDocument||E,e=d.documentElement,d=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0));!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?c.toElement:g);!a.which&&f!==b&&(a.which=f&1?1:f&2?3:f&4?2:0);return a}},fix:function(a){if(a[j.expando])return a;var b,
c,d=a,e=j.event.fixHooks[a.type]||{},f=e.props?this.props.concat(e.props):this.props;a=j.Event(d);for(b=f.length;b;)c=f[--b],a[c]=d[c];a.target||(a.target=d.srcElement||E);3===a.target.nodeType&&(a.target=a.target.parentNode);a.metaKey=!!a.metaKey;return e.filter?e.filter(a,d):a},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){j.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=
null)}}},simulate:function(a,b,c,d){a=j.extend(new j.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?j.event.trigger(a,null,b):j.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};j.event.handle=j.event.dispatch;j.removeEvent=E.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){b="on"+b;a.detachEvent&&("undefined"===typeof a[b]&&(a[b]=null),a.detachEvent(b,c))};j.Event=function(a,b){if(!(this instanceof j.Event))return new j.Event(a,
b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?f:e):this.type=a;b&&j.extend(this,b);this.timeStamp=a&&a.timeStamp||j.now();this[j.expando]=!0};j.Event.prototype={preventDefault:function(){this.isDefaultPrevented=f;var a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=f;var a=this.originalEvent;a&&(a.stopPropagation&&
a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=f;this.stopPropagation()},isDefaultPrevented:e,isPropagationStopped:e,isImmediatePropagationStopped:e};j.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){j.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!j.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});j.support.submitBubbles||
(j.event.special.submit={setup:function(){if(j.nodeName(this,"form"))return!1;j.event.add(this,"click._submit keypress._submit",function(a){a=a.target;if((a=j.nodeName(a,"input")||j.nodeName(a,"button")?a.form:b)&&!j._data(a,"_submit_attached"))j.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),j._data(a,"_submit_attached",!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&j.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(j.nodeName(this,
"form"))return!1;j.event.remove(this,"._submit")}});j.support.changeBubbles||(j.event.special.change={setup:function(){if(pc.test(this.nodeName)){if("checkbox"===this.type||"radio"===this.type)j.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),j.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1);j.event.simulate("change",this,a,!0)});return!1}j.event.add(this,"beforeactivate._change",
function(a){a=a.target;pc.test(a.nodeName)&&!j._data(a,"_change_attached")&&(j.event.add(a,"change._change",function(a){this.parentNode&&(!a.isSimulated&&!a.isTrigger)&&j.event.simulate("change",this.parentNode,a,!0)}),j._data(a,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type)return a.handleObj.handler.apply(this,arguments)},teardown:function(){j.event.remove(this,"._change");return!pc.test(this.nodeName)}});
j.support.focusinBubbles||j.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){j.event.simulate(b,a.target,j.event.fix(a),!0)};j.event.special[b]={setup:function(){0===c++&&E.addEventListener(a,d,!0)},teardown:function(){0===--c&&E.removeEventListener(a,d,!0)}}});j.fn.extend({on:function(a,c,d,f,g){var k,h;if("object"===typeof a){"string"!==typeof c&&(d=d||c,c=b);for(h in a)this.on(h,c,d,a[h],g);return this}null==d&&null==f?(f=c,d=c=b):null==f&&("string"===typeof c?(f=d,d=
b):(f=d,d=c,c=b));if(!1===f)f=e;else if(!f)return this;1===g&&(k=f,f=function(a){j().off(a);return k.apply(this,arguments)},f.guid=k.guid||(k.guid=j.guid++));return this.each(function(){j.event.add(this,a,f,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var f;if(a&&a.preventDefault&&a.handleObj)return f=a.handleObj,j(a.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler),this;if("object"===typeof a){for(f in a)this.off(f,c,a[f]);
return this}if(!1===c||"function"===typeof c)d=c,c=b;!1===d&&(d=e);return this.each(function(){j.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){j(this.context).on(a,this.selector,b,c);return this},die:function(a,b){j(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,
a||"**",c)},trigger:function(a,b){return this.each(function(){j.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return j.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||j.guid++,d=0,e=function(c){var e=(j._data(this,"lastToggle"+a.guid)||0)%d;j._data(this,"lastToggle"+a.guid,e+1);c.preventDefault();return b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||
a)}});j.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){j.fn[b]=function(a,c){null==c&&(c=a,a=null);return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)};Yc.test(b)&&(j.event.fixHooks[b]=j.event.keyHooks);Zc.test(b)&&(j.event.fixHooks[b]=j.event.mouseHooks)});var $c=a,Ka=function(a,b,c,d){c=c||[];b=b||rc;var e,
f,g,j,k=b.nodeType;if(!a||"string"!==typeof a)return c;if(1!==k&&9!==k)return[];g=td(b);if(!g&&!d&&(e=T.exec(a)))if(j=e[1])if(9===k)if((f=b.getElementById(j))&&f.parentNode){if(f.id===j)return c.push(f),c}else return c;else{if(b.ownerDocument&&(f=b.ownerDocument.getElementById(j))&&Yd(b,f)&&f.id===j)return c.push(f),c}else{if(e[2])return ad.apply(c,bd.call(b.getElementsByTagName(a),0)),c;if((j=e[3])&&Zd&&b.getElementsByClassName)return ad.apply(c,bd.call(b.getElementsByClassName(j),0)),c}return Pc(a.replace(ud,
"$1"),b,c,d,g)},Hc=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}},Qc=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},R=function(a){return lc(function(b){b=+b;return lc(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)if(c[e=f[g]])c[e]=!(d[e]=c[e])})})},sc=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1},ma=function(a,b){var c,d,e,f,g,j,
k;if(g=$d[Fb][a+" "])return b?0:g.slice(0);g=a;j=[];for(k=Ga.preFilter;g;){if(!c||(d=se.exec(g)))d&&(g=g.slice(d[0].length)||g),j.push(e=[]);c=!1;if(d=te.exec(g))e.push(c=new ae(d.shift())),g=g.slice(c.length),c.type=d[0].replace(ud," ");for(f in Ga.filter)if((d=vd[f].exec(g))&&(!k[f]||(d=k[f](d))))e.push(c=new ae(d.shift())),g=g.slice(c.length),c.type=f,c.matches=d;if(!c)break}return b?g.length:g?Ka.error(a):$d(a,j).slice(0)},H=function(a,b,c){var d=b.dir,e=c&&"parentNode"===b.dir,f=ue++;return b.first?
function(b,c,f){for(;b=b[d];)if(e||1===b.nodeType)return a(b,c,f)}:function(b,c,g){if(g)for(;b=b[d];){if((e||1===b.nodeType)&&a(b,c,g))return b}else for(var j,k=jd+" "+f+" ",h=k+Jd;b=b[d];)if(e||1===b.nodeType){if((j=b[Fb])===h)return b.sizset;if("string"===typeof j&&0===j.indexOf(k)){if(b.sizset)return b}else{b[Fb]=h;if(a(b,c,g))return b.sizset=!0,b;b.sizset=!1}}}},Ua=function(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]},pb=function(a,b,c,
d,e){for(var f,g=[],j=0,k=a.length,h=null!=b;j<k;j++)if(f=a[j])if(!c||c(f,d,e))g.push(f),h&&b.push(j);return g},La=function(a,b,c,d,e,f){d&&!d[Fb]&&(d=La(d));e&&!e[Fb]&&(e=La(e,f));return lc(function(f,g,j,k){var h,l,H=[],m=[],n=g.length,p;if(!(p=f)){p=b||"*";for(var q=j.nodeType?[j]:j,r=[],t=0,u=q.length;t<u;t++)Ka(p,q[t],r);p=r}p=a&&(f||!b)?pb(p,H,a,j,k):p;q=c?e||(f?a:n||d)?[]:g:p;c&&c(p,q,j,k);if(d){h=pb(q,m);d(h,[],j,k);for(j=h.length;j--;)if(l=h[j])q[m[j]]=!(p[m[j]]=l)}if(f){if(e||a){if(e){h=
[];for(j=q.length;j--;)if(l=q[j])h.push(p[j]=l);e(null,q=[],h,k)}for(j=q.length;j--;)if((l=q[j])&&-1<(h=e?Kd.call(f,l):H[j]))f[h]=!(g[h]=l)}}else q=pb(q===g?q.splice(n,q.length):q),e?e(null,g,q,k):ad.apply(g,q)})},zb=function(a){var b,c,d,e=a.length,f=Ga.relative[a[0].type];c=f||Ga.relative[" "];for(var g=f?1:0,j=H(function(a){return a===b},c,!0),k=H(function(a){return-1<Kd.call(b,a)},c,!0),h=[function(a,c,d){return!f&&(d||c!==wd)||((b=c).nodeType?j(a,c,d):k(a,c,d))}];g<e;g++)if(c=Ga.relative[a[g].type])h=
[H(Ua(h),c)];else{c=Ga.filter[a[g].type].apply(null,a[g].matches);if(c[Fb]){for(d=++g;d<e&&!Ga.relative[a[d].type];d++);return La(1<g&&Ua(h),1<g&&a.slice(0,g-1).join("").replace(ud,"$1"),c,g<d&&zb(a.slice(g,d)),d<e&&zb(a=a.slice(d)),d<e&&a.join(""))}h.push(c)}return Ua(h)},Pc=function(a,b,c,d,e){var f,g,j,k,h=ma(a);if(!d&&1===h.length){g=h[0]=h[0].slice(0);if(2<g.length&&"ID"===(j=g[0]).type&&9===b.nodeType&&!e&&Ga.relative[g[1].type]){b=Ga.find.ID(j.matches[0].replace(Rc,""),b,e)[0];if(!b)return c;
a=a.slice(g.shift().length)}for(f=vd.POS.test(a)?-1:g.length-1;0<=f;f--){j=g[f];if(Ga.relative[k=j.type])break;if(k=Ga.find[k])if(d=k(j.matches[0].replace(Rc,""),Ld.test(g[0].type)&&b.parentNode||b,e)){g.splice(f,1);a=d.length&&g.join("");if(!a)return ad.apply(c,bd.call(d,0)),c;break}}}Md(a,h)(d,b,e,c,Ld.test(a));return c},cd=function(){},Jd,Sc,Ga,xd,td,Yd,Md,Nd,kd,wd,be=!0,Fb=("sizcache"+Math.random()).replace(".",""),ae=String,rc=$c.document,dc=rc.documentElement,jd=0,ue=0,ve=[].pop,ad=[].push,
bd=[].slice,Kd=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},lc=function(a,b){a[Fb]=null==b||b;return a},Od=function(){var a={},b=[];return lc(function(c,d){b.push(c)>Ga.cacheLength&&delete a[b.shift()];return a[c+" "]=d},a)},ce=Od(),$d=Od(),de=Od(),ee="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w#")+
")|)|)[\\x20\\t\\r\\n\\f]*\\]",Pd=":((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+ee+")|[^:]|\\\\.)*|.*))\\)|)",ud=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),se=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,te=/^[\x20\t\r\n\f]*([\x20\t\r\n\f>+~])[\x20\t\r\n\f]*/,we=RegExp(Pd),T=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,Ld=/[\x20\t\r\n\f]*[+~]/,xe=/h\d/i,ye=/input|select|textarea|button/i,Rc=/\\(?!\\)/g,vd={ID:/^#((?:\\.|[-\w]|[^\x00-\xa0])+)/,
CLASS:/^\.((?:\\.|[-\w]|[^\x00-\xa0])+)/,NAME:/^\[name=['"]?((?:\\.|[-\w]|[^\x00-\xa0])+)['"]?\]/,TAG:RegExp("^("+"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+ee),PSEUDO:RegExp("^"+Pd),POS:/:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i,CHILD:RegExp("^:(only|nth|first|last)-child(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},pa=function(a){var b=rc.createElement("div");try{return a(b)}catch(c){return!1}finally{}},ze=pa(function(a){a.appendChild(rc.createComment(""));return!a.getElementsByTagName("*").length}),Ae=pa(function(a){a.innerHTML="<a href='#'></a>";return a.firstChild&&"undefined"!==typeof a.firstChild.getAttribute&&"#"===a.firstChild.getAttribute("href")}),
Be=pa(function(a){a.innerHTML="<select></select>";a=typeof a.lastChild.getAttribute("multiple");return"boolean"!==a&&"string"!==a}),Zd=pa(function(a){a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!a.getElementsByClassName||!a.getElementsByClassName("e").length)return!1;a.lastChild.className="e";return 2===a.getElementsByClassName("e").length}),Ce=pa(function(a){a.id=Fb+0;a.innerHTML="<a name='"+Fb+"'></a><div name='"+Fb+"'></div>";dc.insertBefore(a,dc.firstChild);var b=rc.getElementsByName&&
rc.getElementsByName(Fb).length===2+rc.getElementsByName(Fb+0).length;Sc=!rc.getElementById(Fb);dc.removeChild(a);return b});try{bd.call(dc.childNodes,0)[0].nodeType}catch(cf){bd=function(a){for(var b,c=[];b=this[a];a++)c.push(b);return c}}Ka.matches=function(a,b){return Ka(a,null,null,b)};Ka.matchesSelector=function(a,b){return 0<Ka(b,null,null,[a]).length};xd=Ka.getText=function(a){var b,c="",d=0;if(b=a.nodeType)if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=
a.firstChild;a;a=a.nextSibling)c+=xd(a)}else{if(3===b||4===b)return a.nodeValue}else for(;b=a[d];d++)c+=xd(b);return c};td=Ka.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};Yd=Ka.contains=dc.contains?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||!(1===d.nodeType&&c.contains&&c.contains(d)))}:dc.compareDocumentPosition?function(a,b){return b&&!!(a.compareDocumentPosition(b)&16)}:function(a,b){for(;b=b.parentNode;)if(b===
a)return!0;return!1};Ka.attr=function(a,b){var c,d=td(a);d||(b=b.toLowerCase());return(c=Ga.attrHandle[b])?c(a):d||Be?a.getAttribute(b):(c=a.getAttributeNode(b))?"boolean"===typeof a[b]?a[b]?b:null:c.specified?c.value:null:null};Ga=Ka.selectors={cacheLength:50,createPseudo:lc,match:vd,attrHandle:Ae?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},find:{ID:Sc?function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(a=b.getElementById(a))&&
a.parentNode?[a]:[]}:function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(b=b.getElementById(a))?b.id===a||"undefined"!==typeof b.getAttributeNode&&b.getAttributeNode("id").value===a?[b]:void 0:[]},TAG:ze?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a)}:function(a,b){var c=b.getElementsByTagName(a);if("*"===a){for(var d,e=[],f=0;d=c[f];f++)1===d.nodeType&&e.push(d);return e}return c},NAME:Ce&&function(a,b){if("undefined"!==typeof b.getElementsByName)return b.getElementsByName(name)},
CLASS:Zd&&function(a,b,c){if("undefined"!==typeof b.getElementsByClassName&&!c)return b.getElementsByClassName(a)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=a[1].replace(Rc,"");a[3]=(a[4]||a[5]||"").replace(Rc,"");"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1]?(a[2]||Ka.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*("even"===
a[2]||"odd"===a[2])),a[4]=+(a[6]+a[7]||"odd"===a[2])):a[2]&&Ka.error(a[0]);return a},PSEUDO:function(a){var b,c;if(vd.CHILD.test(a[0]))return null;if(a[3])a[2]=a[3];else if(b=a[4]){if(we.test(b)&&(c=ma(b,!0))&&(c=b.indexOf(")",b.length-c)-b.length))b=b.slice(0,c),a[0]=a[0].slice(0,c);a[2]=b}return a.slice(0,3)}},filter:{ID:Sc?function(a){a=a.replace(Rc,"");return function(b){return b.getAttribute("id")===a}}:function(a){a=a.replace(Rc,"");return function(b){return(b="undefined"!==typeof b.getAttributeNode&&
b.getAttributeNode("id"))&&b.value===a}},TAG:function(a){if("*"===a)return function(){return!0};a=a.replace(Rc,"").toLowerCase();return function(b){return b.nodeName&&b.nodeName.toLowerCase()===a}},CLASS:function(a){var b=ce[Fb][a+" "];return b||(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&ce(a,function(a){return b.test(a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){d=Ka.attr(d,a);if(null==d)return"!="===
b;if(!b)return!0;d+="";return"="===b?d===c:"!="===b?d!==c:"^="===b?c&&0===d.indexOf(c):"*="===b?c&&-1<d.indexOf(c):"$="===b?c&&d.substr(d.length-c.length)===c:"~="===b?-1<(" "+d+" ").indexOf(c):"|="===b?d===c||d.substr(0,c.length+1)===c+"-":!1}},CHILD:function(a,b,c,d){return"nth"===a?function(a){var b,e;b=a.parentNode;if(1===c&&0===d)return!0;if(b){e=0;for(b=b.firstChild;b&&!(1===b.nodeType&&(e++,a===b));b=b.nextSibling);}e-=d;return e===c||0===e%c&&0<=e/c}:function(b){var c=b;switch(a){case "only":case "first":for(;c=
c.previousSibling;)if(1===c.nodeType)return!1;if("first"===a)return!0;c=b;case "last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0}}},PSEUDO:function(a,b){var c,d=Ga.pseudos[a]||Ga.setFilters[a.toLowerCase()]||Ka.error("unsupported pseudo: "+a);return d[Fb]?d(b):1<d.length?(c=[a,a,"",b],Ga.setFilters.hasOwnProperty(a.toLowerCase())?lc(function(a,c){for(var e,f=d(a,b),g=f.length;g--;)e=Kd.call(a,f[g]),a[e]=!(c[e]=f[g])}):function(a){return d(a,0,c)}):d}},pseudos:{not:lc(function(a){var b=
[],c=[],d=Md(a.replace(ud,"$1"));return d[Fb]?lc(function(a,b,c,e){e=d(a,null,e,[]);for(var f=a.length;f--;)if(c=e[f])a[f]=!(b[f]=c)}):function(a,e,f){b[0]=a;d(b,null,f,c);return!c.pop()}}),has:lc(function(a){return function(b){return 0<Ka(a,b).length}}),contains:lc(function(a){return function(b){return-1<(b.textContent||b.innerText||xd(b)).indexOf(a)}}),enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===
b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},parent:function(a){return!Ga.pseudos.empty(a)},empty:function(a){var b;for(a=a.firstChild;a;){if("@"<a.nodeName||3===(b=a.nodeType)||4===b)return!1;a=a.nextSibling}return!0},header:function(a){return xe.test(a.nodeName)},text:function(a){var b,c;return"input"===a.nodeName.toLowerCase()&&"text"===(b=a.type)&&(null==(c=a.getAttribute("type"))||c.toLowerCase()===b)},radio:Hc("radio"),
checkbox:Hc("checkbox"),file:Hc("file"),password:Hc("password"),image:Hc("image"),submit:Qc("submit"),reset:Qc("reset"),button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return ye.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&!(!a.type&&!a.href&&!~a.tabIndex)},active:function(a){return a===a.ownerDocument.activeElement},first:R(function(){return[0]}),last:R(function(a,
b){return[b-1]}),eq:R(function(a,b,c){return[0>c?c+b:c]}),even:R(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:R(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:R(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:R(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};Nd=dc.compareDocumentPosition?function(a,b){return a===b?(kd=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:
function(a,b){if(a===b)return kd=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[];c=a.parentNode;d=b.parentNode;var g=c;if(c===d)return sc(a,b);if(c){if(!d)return 1}else return-1;for(;g;)e.unshift(g),g=g.parentNode;for(g=d;g;)f.unshift(g),g=g.parentNode;c=e.length;d=f.length;for(g=0;g<c&&g<d;g++)if(e[g]!==f[g])return sc(e[g],f[g]);return g===c?sc(a,f[g],-1):sc(e[g],b,1)};[0,0].sort(Nd);be=!kd;Ka.uniqueSort=function(a){var b,c=[],d=1,e=0;kd=be;a.sort(Nd);if(kd){for(;b=
a[d];d++)b===a[d-1]&&(e=c.push(d));for(;e--;)a.splice(c[e],1)}return a};Ka.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};Md=Ka.compile=function(a,b){var c,d=[],e=[],f=de[Fb][a+" "];if(!f){b||(b=ma(a));for(c=b.length;c--;)f=zb(b[c]),f[Fb]?d.push(f):e.push(f);var g=0<d.length,j=0<e.length,k=function(a,b,c,f,h){var l,H,m=[],aa=0,n="0",p=a&&[],q=null!=h,r=wd,t=a||j&&Ga.find.TAG("*",h&&b.parentNode||b),vb=jd+=null==r?1:Math.E;q&&(wd=b!==rc&&b,Jd=k.el);for(;null!=(h=t[n]);n++){if(j&&
h){for(l=0;H=e[l];l++)if(H(h,b,c)){f.push(h);break}q&&(jd=vb,Jd=++k.el)}g&&((h=!H&&h)&&aa--,a&&p.push(h))}aa+=n;if(g&&n!==aa){for(l=0;H=d[l];l++)H(p,m,b,c);if(a){if(0<aa)for(;n--;)!p[n]&&!m[n]&&(m[n]=ve.call(f));m=pb(m)}ad.apply(f,m);q&&(!a&&0<m.length&&1<aa+d.length)&&Ka.uniqueSort(f)}q&&(jd=vb,wd=r);return p};k.el=0;c=g?lc(k):k;f=de(a,c)}return f};if(rc.querySelectorAll){var fe,De=Pc,G=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,Ic=[":focus"],S=[":active"],yd=dc.matchesSelector||dc.mozMatchesSelector||
dc.webkitMatchesSelector||dc.oMatchesSelector||dc.msMatchesSelector;pa(function(a){a.innerHTML="<select><option selected=''></option></select>";a.querySelectorAll("[selected]").length||Ic.push("\\[[\\x20\\t\\r\\n\\f]*(?:checked|disabled|ismap|multiple|readonly|selected|value)");a.querySelectorAll(":checked").length||Ic.push(":checked")});pa(function(a){a.innerHTML="<p test=''></p>";a.querySelectorAll("[test^='']").length&&Ic.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:\"\"|'')");a.innerHTML="<input type='hidden'/>";
a.querySelectorAll(":enabled").length||Ic.push(":enabled",":disabled")});Ic=RegExp(Ic.join("|"));Pc=function(a,b,c,d,e){if(!d&&!e&&!Ic.test(a)){var f,g,j=!0,k=Fb;g=b;f=9===b.nodeType&&a;if(1===b.nodeType&&"object"!==b.nodeName.toLowerCase()){f=ma(a);(j=b.getAttribute("id"))?k=j.replace(G,"\\$&"):b.setAttribute("id",k);k="[id='"+k+"'] ";for(g=f.length;g--;)f[g]=k+f[g].join("");g=Ld.test(a)&&b.parentNode||b;f=f.join(",")}if(f)try{return ad.apply(c,bd.call(g.querySelectorAll(f),0)),c}catch(h){}finally{j||
b.removeAttribute("id")}}return De(a,b,c,d,e)};yd&&(pa(function(a){fe=yd.call(a,"div");try{yd.call(a,"[test!='']:sizzle"),S.push("!=",Pd)}catch(b){}}),S=RegExp(S.join("|")),Ka.matchesSelector=function(a,b){b=b.replace(Z,"='$1']");if(!td(a)&&!S.test(b)&&!Ic.test(b))try{var c=yd.call(a,b);if(c||fe||a.document&&11!==a.document.nodeType)return c}catch(d){}return 0<Ka(b,null,null,[a]).length})}Ga.pseudos.nth=Ga.pseudos.eq;Ga.filters=cd.prototype=Ga.pseudos;Ga.setFilters=new cd;Ka.attr=j.attr;j.find=Ka;
j.expr=Ka.selectors;j.expr[":"]=j.expr.pseudos;j.unique=Ka.uniqueSort;j.text=Ka.getText;j.isXMLDoc=Ka.isXML;j.contains=Ka.contains;var Ee=/Until$/,Fe=/^(?:parents|prev(?:Until|All))/,re=/^.[^:#\[\.,]*$/,ge=j.expr.match.needsContext,Ge={children:!0,contents:!0,next:!0,prev:!0};j.fn.extend({find:function(a){var b,c,d,e,f,g,k=this;if("string"!==typeof a)return j(a).filter(function(){b=0;for(c=k.length;b<c;b++)if(j.contains(k[b],this))return!0});g=this.pushStack("","find",a);b=0;for(c=this.length;b<c;b++)if(d=
g.length,j.find(a,this[b],g),0<b)for(e=d;e<g.length;e++)for(f=0;f<d;f++)if(g[f]===g[e]){g.splice(e--,1);break}return g},has:function(a){var b,c=j(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(j.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(l(this,a,!1),"not",a)},filter:function(a){return this.pushStack(l(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"===typeof a?ge.test(a)?0<=j(a,this.context).index(this[0]):0<j.filter(a,this).length:0<this.filter(a).length)},
closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=ge.test(a)||"string"!==typeof a?j(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c.ownerDocument&&c!==b&&11!==c.nodeType;){if(g?-1<g.index(c):j.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}f=1<f.length?j.unique(f):f;return this.pushStack(f,"closest",a)},index:function(a){return!a?this[0]&&this[0].parentNode?this.prevAll().length:-1:"string"===typeof a?j.inArray(this[0],j(a)):j.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=
"string"===typeof a?j(a,b):j.makeArray(a&&a.nodeType?[a]:a),d=j.merge(this.get(),c);return this.pushStack(g(c[0])||g(d[0])?d:j.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});j.fn.andSelf=j.fn.addBack;j.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return j.dir(a,"parentNode")},parentsUntil:function(a,b,c){return j.dir(a,"parentNode",c)},next:function(a){return h(a,"nextSibling")},prev:function(a){return h(a,
"previousSibling")},nextAll:function(a){return j.dir(a,"nextSibling")},prevAll:function(a){return j.dir(a,"previousSibling")},nextUntil:function(a,b,c){return j.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return j.dir(a,"previousSibling",c)},siblings:function(a){return j.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return j.sibling(a.firstChild)},contents:function(a){return j.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:j.merge([],a.childNodes)}},function(a,
b){j.fn[a]=function(c,d){var e=j.map(this,b,c);Ee.test(a)||(d=c);d&&"string"===typeof d&&(e=j.filter(d,e));e=1<this.length&&!Ge[a]?j.unique(e):e;1<this.length&&Fe.test(a)&&(e=e.reverse());return this.pushStack(e,a,ba.call(arguments).join(","))}});j.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return 1===b.length?j.find.matchesSelector(b[0],a)?[b[0]]:[]:j.find.matches(a,b)},dir:function(a,c,d){var e=[];for(a=a[c];a&&9!==a.nodeType&&(d===b||1!==a.nodeType||!j(a).is(d));)1===a.nodeType&&e.push(a),
a=a[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Wd="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",X=/ jQuery\d+="(?:null|\d+)"/g,V=/^\s+/,W=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,sa=/<([\w:]+)/,He=/<tbody/i,Ie=/<|&#?\w+;/,Je=/<(?:script|style|link)/i,Ke=/<(?:script|object|embed|option|style)/i,
Tb=RegExp("<(?:"+Wd+")[\\s/>]","i"),Xd=/^(?:checkbox|radio)$/,Zb=/checked\s*(?:[^=]|=\s*.checked.)/i,Le=/\/(java|ecma)script/i,ec=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,tb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",
""]},$b=m(E),Qd=$b.appendChild(E.createElement("div"));tb.optgroup=tb.option;tb.tbody=tb.tfoot=tb.colgroup=tb.caption=tb.thead;tb.th=tb.td;j.support.htmlSerialize||(tb._default=[1,"X<div>","</div>"]);j.fn.extend({text:function(a){return j.access(this,function(a){return a===b?j.text(this):this.empty().append((this[0]&&this[0].ownerDocument||E).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(j.isFunction(a))return this.each(function(b){j(this).wrapAll(a.call(this,b))});if(this[0]){var b=
j(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return j.isFunction(a)?this.each(function(b){j(this).wrapInner(a.call(this,b))}):this.each(function(){var b=j(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=j.isFunction(a);return this.each(function(c){j(this).wrapAll(b?a.call(this,c):
a)})},unwrap:function(){return this.parent().each(function(){j.nodeName(this,"body")||j(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!g(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,
this)});if(arguments.length){var a=j.clean(arguments);return this.pushStack(j.merge(a,this),"before",this.selector)}},after:function(){if(!g(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=j.clean(arguments);return this.pushStack(j.merge(this,a),"after",this.selector)}},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)if(!a||j.filter(a,[c]).length)!b&&1===c.nodeType&&(j.cleanData(c.getElementsByTagName("*")),
j.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c);return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)for(1===a.nodeType&&j.cleanData(a.getElementsByTagName("*"));a.firstChild;)a.removeChild(a.firstChild);return this},clone:function(a,b){a=null==a?!1:a;b=null==b?a:b;return this.map(function(){return j.clone(this,a,b)})},html:function(a){return j.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(X,""):b;if("string"===
typeof a&&!Je.test(a)&&(j.support.htmlSerialize||!Tb.test(a))&&(j.support.leadingWhitespace||!V.test(a))&&!tb[(sa.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(W,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},1===c.nodeType&&(j.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){if(!g(this[0])){if(j.isFunction(a))return this.each(function(b){var c=j(this),d=c.html();c.replaceWith(a.call(this,b,d))});"string"!==
typeof a&&(a=j(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;j(this).remove();b?j(b).before(a):j(c).append(a)})}return this.length?this.pushStack(j(j.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=[].concat.apply([],a);var e,f,g,k=0,h=a[0],l=[],H=this.length;if(!j.support.checkClone&&1<H&&"string"===typeof h&&Zb.test(h))return this.each(function(){j(this).domManip(a,c,d)});if(j.isFunction(h))return this.each(function(e){var f=
j(this);a[0]=h.call(this,e,c?f.html():b);f.domManip(a,c,d)});if(this[0]){e=j.buildFragment(a,this,l);g=e.fragment;f=g.firstChild;1===g.childNodes.length&&(g=f);if(f){c=c&&j.nodeName(f,"tr");for(e=e.cacheable||H-1;k<H;k++)d.call(c&&j.nodeName(this[k],"table")?this[k].getElementsByTagName("tbody")[0]||this[k].appendChild(this[k].ownerDocument.createElement("tbody")):this[k],k===e?g:j.clone(g,!0,!0))}g=f=null;l.length&&j.each(l,function(a,b){b.src?j.ajax?j.ajax({url:b.src,type:"GET",dataType:"script",
async:!1,global:!1,"throws":!0}):j.error("no ajax"):j.globalEval((b.text||b.textContent||b.innerHTML||"").replace(ec,""));b.parentNode&&b.parentNode.removeChild(b)})}return this}});j.buildFragment=function(a,c,d){var e,f,g,k=a[0];c=c||E;c=!c.nodeType&&c[0]||c;c=c.ownerDocument||c;if(1===a.length&&"string"===typeof k&&512>k.length&&c===E&&"<"===k.charAt(0)&&!Ke.test(k)&&(j.support.checkClone||!Zb.test(k))&&(j.support.html5Clone||!Tb.test(k)))f=!0,e=j.fragments[k],g=e!==b;e||(e=c.createDocumentFragment(),
j.clean(a,c,e,d),f&&(j.fragments[k]=g&&e));return{fragment:e,cacheable:f}};j.fragments={};j.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){j.fn[a]=function(c){var d,e=0,f=[];c=j(c);var g=c.length;d=1===this.length&&this[0].parentNode;if((null==d||d&&11===d.nodeType&&1===d.childNodes.length)&&1===g)return c[b](this[0]),this;for(;e<g;e++)d=(0<e?this.clone(!0):this).get(),j(c[e])[b](d),f=f.concat(d);return this.pushStack(f,
a,c.selector)}});j.extend({clone:function(a,b,c){var d,e,f,g;j.support.html5Clone||j.isXMLDoc(a)||!Tb.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(Qd.innerHTML=a.outerHTML,Qd.removeChild(g=Qd.firstChild));if((!j.support.noCloneEvent||!j.support.noCloneChecked)&&(1===a.nodeType||11===a.nodeType)&&!j.isXMLDoc(a)){q(a,g);d=p(a);e=p(g);for(f=0;d[f];++f)e[f]&&q(d[f],e[f])}if(b&&(n(a,g),c)){d=p(a);e=p(g);for(f=0;d[f];++f)n(d[f],e[f])}return g},clean:function(a,b,c,d){var e,f,g,k,h,l,H=b===E&&$b,n=[];if(!b||
"undefined"===typeof b.createDocumentFragment)b=E;for(e=0;null!=(g=a[e]);e++)if("number"===typeof g&&(g+=""),g){if("string"===typeof g)if(Ie.test(g)){H=H||m(b);l=b.createElement("div");H.appendChild(l);g=g.replace(W,"<$1></$2>");f=(sa.exec(g)||["",""])[1].toLowerCase();k=tb[f]||tb._default;h=k[0];for(l.innerHTML=k[1]+g+k[2];h--;)l=l.lastChild;if(!j.support.tbody){h=He.test(g);k="table"===f&&!h?l.firstChild&&l.firstChild.childNodes:"<table>"===k[1]&&!h?l.childNodes:[];for(f=k.length-1;0<=f;--f)j.nodeName(k[f],
"tbody")&&!k[f].childNodes.length&&k[f].parentNode.removeChild(k[f])}!j.support.leadingWhitespace&&V.test(g)&&l.insertBefore(b.createTextNode(V.exec(g)[0]),l.firstChild);g=l.childNodes;l.parentNode.removeChild(l)}else g=b.createTextNode(g);g.nodeType?n.push(g):j.merge(n,g)}l&&(g=l=H=null);if(!j.support.appendChecked)for(e=0;null!=(g=n[e]);e++)j.nodeName(g,"input")?t(g):"undefined"!==typeof g.getElementsByTagName&&j.grep(g.getElementsByTagName("input"),t);if(c){a=function(a){if(!a.type||Le.test(a.type))return d?
d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)};for(e=0;null!=(g=n[e]);e++)if(!j.nodeName(g,"script")||!a(g))c.appendChild(g),"undefined"!==typeof g.getElementsByTagName&&(g=j.grep(j.merge([],g.getElementsByTagName("script")),a),n.splice.apply(n,[e+1,0].concat(g)),e+=g.length)}return n},cleanData:function(a,b){for(var c,d,e,f,g=0,k=j.expando,h=j.cache,l=j.support.deleteExpando,H=j.event.special;null!=(e=a[g]);g++)if(b||j.acceptData(e))if(c=(d=e[k])&&h[d]){if(c.events)for(f in c.events)H[f]?
j.event.remove(e,f):j.removeEvent(e,f,c.handle);h[d]&&(delete h[d],l?delete e[k]:e.removeAttribute?e.removeAttribute(k):e[k]=null,j.deletedIds.push(d))}}});var Rb,Gb;j.uaMatch=function(a){a=a.toLowerCase();a=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||0>a.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}};Rb=j.uaMatch(ia.userAgent);Gb={};Rb.browser&&
(Gb[Rb.browser]=!0,Gb.version=Rb.version);Gb.chrome?Gb.webkit=!0:Gb.webkit&&(Gb.safari=!0);j.browser=Gb;j.sub=function(){function a(b,c){return new a.fn.init(b,c)}j.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,d){d&&(d instanceof j&&!(d instanceof a))&&(d=a(d));return j.fn.init.call(this,c,d,b)};a.fn.init.prototype=a.fn;var b=a(E);return a};var ib,bc,Hb,Ub=/alpha\([^)]*\)/i,fc=/opacity=([^)]*)/,Me=/^(top|right|bottom|left)$/,Ha=
/^(none|table(?!-c[ea]).+)/,he=/^margin/,oc=RegExp("^("+ya+")(.*)$","i"),kc=RegExp("^("+ya+")(?!px)[a-z%]+$","i"),Jc=RegExp("^([-+])=("+ya+")","i"),jb={BODY:"block"},Ne={position:"absolute",visibility:"hidden",display:"block"},lb={letterSpacing:0,fontWeight:400},Qa=["Top","Right","Bottom","Left"],jc=["Webkit","O","Moz","ms"],mc=j.fn.toggle;j.fn.extend({css:function(a,c){return j.access(this,function(a,c,d){return d!==b?j.style(a,c,d):j.css(a,c)},a,c,1<arguments.length)},show:function(){return s(this,
!0)},hide:function(){return s(this)},toggle:function(a,b){var c="boolean"===typeof a;return j.isFunction(a)&&j.isFunction(b)?mc.apply(this,arguments):this.each(function(){(c?a:r(this))?j(this).show():j(this).hide()})}});j.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=ib(a,"opacity");return""===c?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":j.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,
c,d,e){if(a&&!(3===a.nodeType||8===a.nodeType||!a.style)){var f,g,k,h=j.camelCase(c),l=a.style;c=j.cssProps[h]||(j.cssProps[h]=u(l,h));k=j.cssHooks[c]||j.cssHooks[h];if(d!==b){g=typeof d;if("string"===g&&(f=Jc.exec(d)))d=(f[1]+1)*f[2]+parseFloat(j.css(a,c)),g="number";if(!(null==d||"number"===g&&isNaN(d)))if("number"===g&&!j.cssNumber[h]&&(d+="px"),!k||!("set"in k)||(d=k.set(a,d,e))!==b)try{l[c]=d}catch(H){}}else return k&&"get"in k&&(f=k.get(a,!1,e))!==b?f:l[c]}},css:function(a,c,d,e){var f,g;g=
j.camelCase(c);c=j.cssProps[g]||(j.cssProps[g]=u(a.style,g));(g=j.cssHooks[c]||j.cssHooks[g])&&"get"in g&&(f=g.get(a,!0,e));f===b&&(f=ib(a,c));"normal"===f&&c in lb&&(f=lb[c]);return d||e!==b?(a=parseFloat(f),d||j.isNumeric(a)?a||0:f):f},swap:function(a,b,c){var d,e={};for(d in b)e[d]=a.style[d],a.style[d]=b[d];c=c.call(a);for(d in b)a.style[d]=e[d];return c}});a.getComputedStyle?ib=function(b,c){var d,e,f,g,k=a.getComputedStyle(b,null),h=b.style;k&&(d=k.getPropertyValue(c)||k[c],""===d&&!j.contains(b.ownerDocument,
b)&&(d=j.style(b,c)),kc.test(d)&&he.test(c)&&(e=h.width,f=h.minWidth,g=h.maxWidth,h.minWidth=h.maxWidth=h.width=d,d=k.width,h.width=e,h.minWidth=f,h.maxWidth=g));return d}:E.documentElement.currentStyle&&(ib=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;null==e&&(f&&f[b])&&(e=f[b]);if(kc.test(e)&&!Me.test(b)){c=f.left;if(d=a.runtimeStyle&&a.runtimeStyle.left)a.runtimeStyle.left=a.currentStyle.left;f.left="fontSize"===b?"1em":e;e=f.pixelLeft+"px";f.left=c;d&&(a.runtimeStyle.left=
d)}return""===e?"auto":e});j.each(["height","width"],function(a,b){j.cssHooks[b]={get:function(a,c,d){if(c)return 0===a.offsetWidth&&Ha.test(ib(a,"display"))?j.swap(a,Ne,function(){return B(a,b,d)}):B(a,b,d)},set:function(a,c,d){return A(a,c,d?v(a,b,d,j.support.boxSizing&&"border-box"===j.css(a,"boxSizing")):0)}}});j.support.opacity||(j.cssHooks.opacity={get:function(a,b){return fc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,
b){var c=a.style,d=a.currentStyle,e=j.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(1<=b&&(""===j.trim(f.replace(Ub,""))&&c.removeAttribute)&&(c.removeAttribute("filter"),d&&!d.filter))return;c.filter=Ub.test(f)?f.replace(Ub,e):f+" "+e}});j(function(){j.support.reliableMarginRight||(j.cssHooks.marginRight={get:function(a,b){return j.swap(a,{display:"inline-block"},function(){if(b)return ib(a,"marginRight")})}});!j.support.pixelPosition&&j.fn.position&&j.each(["top",
"left"],function(a,b){j.cssHooks[b]={get:function(a,c){if(c){var d=ib(a,b);return kc.test(d)?j(a).position()[b]+"px":d}}}})});j.expr&&j.expr.filters&&(j.expr.filters.hidden=function(a){return 0===a.offsetWidth&&0===a.offsetHeight||!j.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||ib(a,"display"))},j.expr.filters.visible=function(a){return!j.expr.filters.hidden(a)});j.each({margin:"",padding:"",border:"Width"},function(a,b){j.cssHooks[a+b]={expand:function(c){var d="string"===typeof c?
c.split(" "):[c],e={};for(c=0;4>c;c++)e[a+Qa[c]+b]=d[c]||d[c-2]||d[0];return e}};he.test(a)||(j.cssHooks[a+b].set=A)});var $a=/%20/g,eb=/\[\]$/,gc=/\r?\n/g,nc=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Sb=/^(?:select|textarea)/i;j.fn.extend({serialize:function(){return j.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?j.makeArray(this.elements):this}).filter(function(){return this.name&&
!this.disabled&&(this.checked||Sb.test(this.nodeName)||nc.test(this.type))}).map(function(a,b){var c=j(this).val();return null==c?null:j.isArray(c)?j.map(c,function(a){return{name:b.name,value:a.replace(gc,"\r\n")}}):{name:b.name,value:c.replace(gc,"\r\n")}}).get()}});j.param=function(a,c){var d,e=[],f=function(a,b){b=j.isFunction(b)?b():null==b?"":b;e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=j.ajaxSettings&&j.ajaxSettings.traditional);if(j.isArray(a)||a.jquery&&!j.isPlainObject(a))j.each(a,
function(){f(this.name,this.value)});else for(d in a)F(d,a[d],c,f);return e.join("&").replace($a,"+")};var cb,Ca,Cb=/#.*$/,db=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,ha=/^(?:GET|HEAD)$/,oa=/^\/\//,y=/\?/,Ja=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,ub=/([?&])_=[^&]*/,Kc=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Lc=j.fn.load,Ib={},Ma={},qb=["*/"]+["*"];try{Ca=Y.href}catch(Wa){Ca=E.createElement("a"),Ca.href="",Ca=Ca.href}cb=Kc.exec(Ca.toLowerCase())||[];j.fn.load=function(a,c,d){if("string"!==
typeof a&&Lc)return Lc.apply(this,arguments);if(!this.length)return this;var e,f,g,k=this,h=a.indexOf(" ");0<=h&&(e=a.slice(h,a.length),a=a.slice(0,h));j.isFunction(c)?(d=c,c=b):c&&"object"===typeof c&&(f="POST");j.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&k.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments;k.html(e?j("<div>").append(a.replace(Ja,"")).find(e):a)});return this};j.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
function(a,b){j.fn[b]=function(a){return this.on(b,a)}});j.each(["get","post"],function(a,c){j[c]=function(a,d,e,f){j.isFunction(d)&&(f=f||e,e=d,d=b);return j.ajax({type:c,url:a,data:d,success:e,dataType:f})}});j.extend({getScript:function(a,c){return j.get(a,b,c,"script")},getJSON:function(a,b,c){return j.get(a,b,c,"json")},ajaxSetup:function(a,b){b?z(a,j.ajaxSettings):(b=a,a=j.ajaxSettings);z(a,b);return a},ajaxSettings:{url:Ca,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(cb[1]),
global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":qb},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":j.parseJSON,"text xml":j.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:K(Ib),ajaxTransport:K(Ma),ajax:function(a,
c){function d(a,c,g,l){var m,u,La,Ua,aa=c;if(2!==s){s=2;h&&clearTimeout(h);k=b;f=l||"";v.readyState=0<a?4:0;if(g){Ua=n;l=v;var x,w,Ga,Sc,y=Ua.contents,P=Ua.dataTypes,A=Ua.responseFields;for(w in A)w in g&&(l[A[w]]=g[w]);for(;"*"===P[0];)P.shift(),x===b&&(x=Ua.mimeType||l.getResponseHeader("content-type"));if(x)for(w in y)if(y[w]&&y[w].test(x)){P.unshift(w);break}if(P[0]in g)Ga=P[0];else{for(w in g){if(!P[0]||Ua.converters[w+" "+P[0]]){Ga=w;break}Sc||(Sc=w)}Ga=Ga||Sc}Ga?(Ga!==P[0]&&P.unshift(Ga),Ua=
g[Ga]):Ua=void 0}if(200<=a&&300>a||304===a)if(n.ifModified&&((g=v.getResponseHeader("Last-Modified"))&&(j.lastModified[e]=g),(g=v.getResponseHeader("Etag"))&&(j.etag[e]=g)),304===a)aa="notmodified",m=!0;else{a:{u=n;La=Ua;var B,zb,aa=u.dataTypes.slice();x=aa[0];w={};Ga=0;u.dataFilter&&(La=u.dataFilter(La,u.dataType));if(aa[1])for(B in u.converters)w[B.toLowerCase()]=u.converters[B];for(;g=aa[++Ga];)if("*"!==g){if("*"!==x&&x!==g){B=w[x+" "+g]||w["* "+g];if(!B)for(zb in w)if(m=zb.split(" "),m[1]===g&&
(B=w[x+" "+m[0]]||w["* "+m[0]])){!0===B?B=w[zb]:!0!==w[zb]&&(g=m[0],aa.splice(Ga--,0,g));break}if(!0!==B)if(B&&u["throws"])La=B(La);else try{La=B(La)}catch(z){m={state:"parsererror",error:B?z:"No conversion from "+x+" to "+g};break a}}x=g}m={state:"success",data:La}}aa=m.state;u=m.data;La=m.error;m=!La}else if(La=aa,!aa||a)aa="error",0>a&&(a=0);v.status=a;v.statusText=(c||aa)+"";m?r.resolveWith(p,[u,aa,v]):r.rejectWith(p,[v,aa,La]);v.statusCode(t);t=b;H&&q.trigger("ajax"+(m?"Success":"Error"),[v,
n,m?u:La]);pb.fireWith(p,[v,aa]);H&&(q.trigger("ajaxComplete",[v,n]),--j.active||j.event.trigger("ajaxStop"))}}"object"===typeof a&&(c=a,a=b);c=c||{};var e,f,g,k,h,l,H,m,n=j.ajaxSetup({},c),p=n.context||n,q=p!==n&&(p.nodeType||p instanceof j)?j(p):j.event,r=j.Deferred(),pb=j.Callbacks("once memory"),t=n.statusCode||{},u={},La={},s=0,Ua="canceled",v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=La[c]=La[c]||a;u[a]=b}return this},getAllResponseHeaders:function(){return 2===
s?f:null},getResponseHeader:function(a){var c;if(2===s){if(!g)for(g={};c=db.exec(f);)g[c[1].toLowerCase()]=c[2];c=g[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(n.mimeType=a);return this},abort:function(a){a=a||Ua;k&&k.abort(a);d(0,a);return this}};r.promise(v);v.success=v.done;v.error=v.fail;v.complete=pb.add;v.statusCode=function(a){if(a){var b;if(2>s)for(b in a)t[b]=[t[b],a[b]];else b=a[v.status],v.always(b)}return this};n.url=((a||n.url)+"").replace(Cb,"").replace(oa,
cb[1]+"//");n.dataTypes=j.trim(n.dataType||"*").toLowerCase().split(mb);null==n.crossDomain&&(l=Kc.exec(n.url.toLowerCase()),n.crossDomain=!(!l||!(l[1]!==cb[1]||l[2]!==cb[2]||(l[3]||("http:"===l[1]?80:443))!=(cb[3]||("http:"===cb[1]?80:443)))));n.data&&(n.processData&&"string"!==typeof n.data)&&(n.data=j.param(n.data,n.traditional));C(Ib,n,c,v);if(2===s)return v;H=n.global;n.type=n.type.toUpperCase();n.hasContent=!ha.test(n.type);H&&0===j.active++&&j.event.trigger("ajaxStart");if(!n.hasContent&&(n.data&&
(n.url+=(y.test(n.url)?"&":"?")+n.data,delete n.data),e=n.url,!1===n.cache)){l=j.now();var x=n.url.replace(ub,"$1_="+l);n.url=x+(x===n.url?(y.test(n.url)?"&":"?")+"_="+l:"")}(n.data&&n.hasContent&&!1!==n.contentType||c.contentType)&&v.setRequestHeader("Content-Type",n.contentType);n.ifModified&&(e=e||n.url,j.lastModified[e]&&v.setRequestHeader("If-Modified-Since",j.lastModified[e]),j.etag[e]&&v.setRequestHeader("If-None-Match",j.etag[e]));v.setRequestHeader("Accept",n.dataTypes[0]&&n.accepts[n.dataTypes[0]]?
n.accepts[n.dataTypes[0]]+("*"!==n.dataTypes[0]?", "+qb+"; q=0.01":""):n.accepts["*"]);for(m in n.headers)v.setRequestHeader(m,n.headers[m]);if(n.beforeSend&&(!1===n.beforeSend.call(p,v,n)||2===s))return v.abort();Ua="abort";for(m in{success:1,error:1,complete:1})v[m](n[m]);if(k=C(Ma,n,c,v)){v.readyState=1;H&&q.trigger("ajaxSend",[v,n]);n.async&&0<n.timeout&&(h=setTimeout(function(){v.abort("timeout")},n.timeout));try{s=1,k.send(u,d)}catch(w){if(2>s)d(-1,w);else throw w;}}else d(-1,"No Transport");
return v},active:0,lastModified:{},etag:{}});var Na=[],Te=/\?/,Mc=/(=)\?(?=&|$)|\?\?/,Ue=j.now();j.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Na.pop()||j.expando+"_"+Ue++;this[a]=!0;return a}});j.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,k,h=c.data,l=c.url,H=!1!==c.jsonp,m=H&&Mc.test(l),n=H&&!m&&"string"===typeof h&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Mc.test(h);if("jsonp"===c.dataTypes[0]||m||n)return f=c.jsonpCallback=j.isFunction(c.jsonpCallback)?
c.jsonpCallback():c.jsonpCallback,g=a[f],m?c.url=l.replace(Mc,"$1"+f):n?c.data=h.replace(Mc,"$1"+f):H&&(c.url+=(Te.test(l)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){k||j.error(f+" was not called");return k[0]},c.dataTypes[0]="json",a[f]=function(){k=arguments},e.always(function(){a[f]=g;c[f]&&(c.jsonpCallback=d.jsonpCallback,Na.push(f));k&&j.isFunction(g)&&g(k[0]);k=g=b}),"script"});j.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){j.globalEval(a);return a}}});j.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});j.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=E.head||E.getElementsByTagName("head")[0]||E.documentElement;return{send:function(e,f){c=E.createElement("script");c.async="async";a.scriptCharset&&(c.charset=a.scriptCharset);c.src=a.url;c.onload=c.onreadystatechange=function(a,
e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){if(c)c.onload(0,1)}}}});var x,Vb=a.ActiveXObject?function(){for(var a in x)x[a](0,1)}:!1,Nb=0;j.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&N()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:N;var Db=j.ajaxSettings.xhr();j.extend(j.support,
{ajax:!!Db,cors:!!Db&&"withCredentials"in Db});j.support.ajax&&j.ajaxTransport(function(c){if(!c.crossDomain||j.support.cors){var d;return{send:function(e,f){var g,k,h=c.xhr();c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(k in c.xhrFields)h[k]=c.xhrFields[k];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType);!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(k in e)h.setRequestHeader(k,
e[k])}catch(l){}h.send(c.hasContent&&c.data||null);d=function(a,e){var k,l,H,m,n;try{if(d&&(e||4===h.readyState))if(d=b,g&&(h.onreadystatechange=j.noop,Vb&&delete x[g]),e)4!==h.readyState&&h.abort();else{k=h.status;H=h.getAllResponseHeaders();m={};if((n=h.responseXML)&&n.documentElement)m.xml=n;try{m.text=h.responseText}catch(p){}try{l=h.statusText}catch(q){l=""}!k&&c.isLocal&&!c.crossDomain?k=m.text?200:404:1223===k&&(k=204)}}catch(r){e||f(-1,r)}m&&f(k,l,m,H)};c.async?4===h.readyState?setTimeout(d,
0):(g=++Nb,Vb&&(x||(x={},j(a).unload(Vb)),x[g]=d),h.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var Ec,Tc,Ve=/^(?:toggle|show|hide)$/,We=RegExp("^(?:([-+])=|)("+ya+")([a-z%]*)$","i"),Xe=/queueHooks$/,Wc=[function(a,b,c){var d,e,f,g,k,h,l=this,H=a.style,m={},n=[],p=a.nodeType&&r(a);c.queue||(k=j._queueHooks(a,"fx"),null==k.unqueued&&(k.unqueued=0,h=k.empty.fire,k.empty.fire=function(){k.unqueued||h()}),k.unqueued++,l.always(function(){l.always(function(){k.unqueued--;j.queue(a,"fx").length||
k.empty.fire()})}));if(1===a.nodeType&&("height"in b||"width"in b))c.overflow=[H.overflow,H.overflowX,H.overflowY],"inline"===j.css(a,"display")&&"none"===j.css(a,"float")&&(!j.support.inlineBlockNeedsLayout||"inline"===w(a.nodeName)?H.display="inline-block":H.zoom=1);c.overflow&&(H.overflow="hidden",j.support.shrinkWrapBlocks||l.done(function(){H.overflow=c.overflow[0];H.overflowX=c.overflow[1];H.overflowY=c.overflow[2]}));for(d in b)f=b[d],Ve.exec(f)&&(delete b[d],e=e||"toggle"===f,f!==(p?"hide":
"show")&&n.push(d));if(b=n.length){f=j._data(a,"fxshow")||j._data(a,"fxshow",{});"hidden"in f&&(p=f.hidden);e&&(f.hidden=!p);p?j(a).show():l.done(function(){j(a).hide()});l.done(function(){var b;j.removeData(a,"fxshow",!0);for(b in m)j.style(a,b,m[b])});for(d=0;d<b;d++)e=n[d],g=l.createTween(e,p?f[e]:0),m[e]=f[e]||j.style(a,e),e in f||(f[e]=g.start,p&&(g.end=g.start,g.start="width"===e||"height"===e?1:0))}}],Xb={"*":[function(a,b){var c,d,e=this.createTween(a,b),f=We.exec(b),g=e.cur(),k=+g||0,h=1,
l=20;if(f){c=+f[2];d=f[3]||(j.cssNumber[a]?"":"px");if("px"!==d&&k){k=j.css(e.elem,a,!0)||c||1;do h=h||".5",k/=h,j.style(e.elem,a,k+d);while(h!==(h=e.cur()/g)&&1!==h&&--l)}e.unit=d;e.start=k;e.end=f[1]?k+(f[1]+1)*c:c}return e}]};j.Animation=j.extend(L,{tweener:function(a,b){j.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],Xb[c]=Xb[c]||[],Xb[c].unshift(b)},prefilter:function(a,b){b?Wc.unshift(a):Wc.push(a)}});j.Tween=U;U.prototype={constructor:U,init:function(a,
b,c,d,e,f){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=f||(j.cssNumber[c]?"":"px")},cur:function(){var a=U.propHooks[this.prop];return a&&a.get?a.get(this):U.propHooks._default.get(this)},run:function(a){var b,c=U.propHooks[this.prop];this.pos=this.options.duration?b=j.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):b=a;this.now=(this.end-this.start)*b+this.start;this.options.step&&this.options.step.call(this.elem,
this.now,this);c&&c.set?c.set(this):U.propHooks._default.set(this);return this}};U.prototype.init.prototype=U.prototype;U.propHooks={_default:{get:function(a){if(null!=a.elem[a.prop]&&(!a.elem.style||null==a.elem.style[a.prop]))return a.elem[a.prop];a=j.css(a.elem,a.prop,!1,"");return!a||"auto"===a?0:a},set:function(a){if(j.fx.step[a.prop])j.fx.step[a.prop](a);else a.elem.style&&(null!=a.elem.style[j.cssProps[a.prop]]||j.cssHooks[a.prop])?j.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};
U.propHooks.scrollTop=U.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};j.each(["toggle","show","hide"],function(a,b){var c=j.fn[b];j.fn[b]=function(d,e,f){return null==d||"boolean"===typeof d||!a&&j.isFunction(d)&&j.isFunction(e)?c.apply(this,arguments):this.animate(D(b,!0),d,e,f)}});j.fn.extend({fadeTo:function(a,b,c,d){return this.filter(r).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=j.isEmptyObject(a),
f=j.speed(b,c,d);b=function(){var b=L(this,j.extend({},a),f);e&&b.stop(!0)};return e||!1===f.queue?this.each(b):this.queue(f.queue,b)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop;b(d)};"string"!==typeof a&&(d=c,c=a,a=b);c&&!1!==a&&this.queue(a||"fx",[]);return this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=j.timers,g=j._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&(g[c].stop&&Xe.test(c))&&e(g[c]);for(c=f.length;c--;)if(f[c].elem===this&&(null==a||
f[c].queue===a))f[c].anim.stop(d),b=!1,f.splice(c,1);(b||!d)&&j.dequeue(this,a)})}});j.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){j.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});j.speed=function(a,b,c){var d=a&&"object"===typeof a?j.extend({},a):{complete:c||!c&&b||j.isFunction(a)&&a,duration:a,easing:c&&b||b&&!j.isFunction(b)&&b};d.duration=j.fx.off?0:"number"===typeof d.duration?
d.duration:d.duration in j.fx.speeds?j.fx.speeds[d.duration]:j.fx.speeds._default;if(null==d.queue||!0===d.queue)d.queue="fx";d.old=d.complete;d.complete=function(){j.isFunction(d.old)&&d.old.call(this);d.queue&&j.dequeue(this,d.queue)};return d};j.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}};j.timers=[];j.fx=U.prototype.init;j.fx.tick=function(){var a,c=j.timers,d=0;for(Ec=j.now();d<c.length;d++)a=c[d],!a()&&c[d]===a&&c.splice(d--,1);c.length||j.fx.stop();
Ec=b};j.fx.timer=function(a){a()&&(j.timers.push(a)&&!Tc)&&(Tc=setInterval(j.fx.tick,j.fx.interval))};j.fx.interval=13;j.fx.stop=function(){clearInterval(Tc);Tc=null};j.fx.speeds={slow:600,fast:200,_default:400};j.fx.step={};j.expr&&j.expr.filters&&(j.expr.filters.animated=function(a){return j.grep(j.timers,function(b){return a===b.elem}).length});var Da=/^(?:body|html)$/i;j.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){j.offset.setOffset(this,a,b)});var c,d,e,
f,g,k={top:0,left:0};if(e=(f=this[0])&&f.ownerDocument){if((d=e.body)===f)return j.offset.bodyOffset(f);c=e.documentElement;if(!j.contains(c,f))return k;"undefined"!==typeof f.getBoundingClientRect&&(k=f.getBoundingClientRect());e=M(e);f=c.clientTop||d.clientTop||0;d=c.clientLeft||d.clientLeft||0;g=e.pageYOffset||c.scrollTop;c=e.pageXOffset||c.scrollLeft;return{top:k.top+g-f,left:k.left+c-d}}};j.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;j.support.doesNotIncludeMarginInBodyOffset&&
(b+=parseFloat(j.css(a,"marginTop"))||0,c+=parseFloat(j.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=j.css(a,"position");"static"===d&&(a.style.position="relative");var e=j(a),f=e.offset(),g=j.css(a,"top"),k=j.css(a,"left"),h={},l={};("absolute"===d||"fixed"===d)&&-1<j.inArray("auto",[g,k])?(l=e.position(),d=l.top,k=l.left):(d=parseFloat(g)||0,k=parseFloat(k)||0);j.isFunction(b)&&(b=b.call(a,c,f));null!=b.top&&(h.top=b.top-f.top+d);null!=b.left&&(h.left=b.left-f.left+
k);"using"in b?b.using.call(a,h):e.css(h)}};j.fn.extend({position:function(){if(this[0]){var a=this[0],b=this.offsetParent(),c=this.offset(),d=Da.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(j.css(a,"marginTop"))||0;c.left-=parseFloat(j.css(a,"marginLeft"))||0;d.top+=parseFloat(j.css(b[0],"borderTopWidth"))||0;d.left+=parseFloat(j.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||
E.body;a&&!Da.test(a.nodeName)&&"static"===j.css(a,"position");)a=a.offsetParent;return a||E.body})}});j.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);j.fn[a]=function(e){return j.access(this,function(a,e,f){var g=M(a);if(f===b)return g?c in g?g[c]:g.document.documentElement[e]:a[e];g?g.scrollTo(!d?f:j(g).scrollLeft(),d?f:j(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}});j.each({Height:"height",Width:"width"},function(a,c){j.each({padding:"inner"+a,
content:c,"":"outer"+a},function(d,e){j.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!==typeof e),k=d||(!0===e||!0===f?"margin":"border");return j.access(this,function(c,d,e){return j.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(d=c.documentElement,Math.max(c.body["scroll"+a],d["scroll"+a],c.body["offset"+a],d["offset"+a],d["client"+a])):e===b?j.css(c,d,e,k):j.style(c,d,e,k)},c,g?e:b,g,null)}})});a.jQuery=a.$=j;"function"===typeof define&&(define.amd&&define.amd.jQuery)&&
define("jquery",[],function(){return j})})(window);var Stats=function(){var a=Date.now(),b=a,c=0,d=Infinity,e=0,f=0,g=Infinity,h=0,l=0,m=0,n=document.createElement("div");n.id="stats";n.addEventListener("mousedown",function(a){a.preventDefault();v(++m%2)},!1);n.style.cssText="width:80px;opacity:0.9;cursor:pointer";var q=document.createElement("div");q.id="fps";q.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";n.appendChild(q);var p=document.createElement("div");p.id="fpsText";p.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";
p.innerHTML="FPS";q.appendChild(p);var t=document.createElement("div");t.id="fpsGraph";t.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(q.appendChild(t);74>t.children.length;){var u=document.createElement("span");u.style.cssText="width:1px;height:30px;float:left;background-color:#113";t.appendChild(u)}var r=document.createElement("div");r.id="ms";r.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";n.appendChild(r);var s=document.createElement("div");
s.id="msText";s.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";s.innerHTML="MS";r.appendChild(s);var A=document.createElement("div");A.id="msGraph";A.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(r.appendChild(A);74>A.children.length;)u=document.createElement("span"),u.style.cssText="width:1px;height:30px;float:left;background-color:#131",A.appendChild(u);var v=function(a){m=a;switch(m){case 0:q.style.display=
"block";r.style.display="none";break;case 1:q.style.display="none",r.style.display="block"}};return{REVISION:11,domElement:n,setMode:v,begin:function(){a=Date.now()},end:function(){var m=Date.now();c=m-a;d=Math.min(d,c);e=Math.max(e,c);s.textContent=c+" MS ("+d+"-"+e+")";var n=Math.min(30,30-30*(c/200));A.appendChild(A.firstChild).style.height=n+"px";l++;m>b+1E3&&(f=Math.round(1E3*l/(m-b)),g=Math.min(g,f),h=Math.max(h,f),p.textContent=f+" FPS ("+g+"-"+h+")",n=Math.min(30,30-30*(f/100)),t.appendChild(t.firstChild).style.height=
n+"px",b=m,l=0);return m},update:function(){a=this.end()}}};var THREE=THREE||{REVISION:"56"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};self.Int32Array=self.Int32Array||Array;self.Float32Array=self.Float32Array||Array;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};
THREE.extend=function(a,b){if(Object.keys)for(var c=Object.keys(b),d=0,e=c.length;d<e;d++){var f=c[d];Object.defineProperty(a,f,Object.getOwnPropertyDescriptor(b,f))}else for(f in c={}.hasOwnProperty,b)c.call(b,f)&&(a[f]=b[f]);return a};
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.cancelAnimationFrame=window.cancelAnimationFrame||
function(a){window.clearTimeout(a)}})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;
THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;
THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;
THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;
THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(a){void 0!==a&&this.set(a);return this};
THREE.extend(THREE.Color.prototype,{r:1,g:1,b:1,set:function(a){switch(typeof a){case "number":this.setHex(a);break;case "string":this.setStyle(a)}},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSV:function(a,b,c){console.log("DEPRECATED: Color's .setHSV() will be removed. Use .setHSL( h, s, l ) instead.");return this.setHSL(a,b*c/(1>(a=(2-b)*c)?a:2-a),a/2)},setHSL:function(a,
b,c){if(0===b)this.r=this.g=this.b=c;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a};b=0.5>=c?c*(1+b):c+b-c*b;c=2*c-b;this.r=d(c,b,a+1/3);this.g=d(c,b,a);this.b=d(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(a))return a=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(a))return a=
/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(a),this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),
this},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*
this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var a={h:0,s:0,l:0};return function(){var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var l=e-f,f=0.5>=h?l/(e+f):l/(2-e-f);switch(e){case b:g=(c-d)/l+(c<d?6:0);break;case c:g=(d-b)/l+2;break;case d:g=(b-c)/l+4}g/=6}a.h=g;a.s=f;a.l=h;return a}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+
","+(255*this.b|0)+")"},offsetHSL:function(a,b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=
(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}});
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.extend(THREE.Quaternion.prototype,{set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},setFromEuler:function(a,b){var c=Math.cos(a.x/2),d=Math.cos(a.y/2),e=Math.cos(a.z/2),f=Math.sin(a.x/2),g=Math.sin(a.y/2),h=Math.sin(a.z/2);void 0===b||"XYZ"===b?(this.x=f*d*e+c*g*h,this.y=c*g*e-f*d*h,this.z=c*d*h+f*g*e,this.w=c*d*e-f*g*h):"YXZ"===b?(this.x=f*d*e+c*g*h,this.y=c*g*e-f*d*h,this.z=c*d*h-f*g*e,this.w=c*
d*e+f*g*h):"ZXY"===b?(this.x=f*d*e-c*g*h,this.y=c*g*e+f*d*h,this.z=c*d*h+f*g*e,this.w=c*d*e-f*g*h):"ZYX"===b?(this.x=f*d*e-c*g*h,this.y=c*g*e+f*d*h,this.z=c*d*h-f*g*e,this.w=c*d*e+f*g*h):"YZX"===b?(this.x=f*d*e+c*g*h,this.y=c*g*e+f*d*h,this.z=c*d*h-f*g*e,this.w=c*d*e-f*g*h):"XZY"===b&&(this.x=f*d*e-c*g*h,this.y=c*g*e-f*d*h,this.z=c*d*h+f*g*e,this.w=c*d*e+f*g*h);return this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);this.x=a.x*d;this.y=a.y*d;this.z=a.z*d;this.w=Math.cos(c);return this},
setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],l=b[6],b=b[10],m=c+f+b;0<m?(c=0.5/Math.sqrt(m+1),this.w=0.25/c,this.x=(l-g)*c,this.y=(d-h)*c,this.z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this.w=(l-g)/c,this.x=0.25*c,this.y=(a+e)/c,this.z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this.w=(d-h)/c,this.x=(a+e)/c,this.y=0.25*c,this.z=(g+l)/c):(c=2*Math.sqrt(1+b-c-f),this.w=(e-a)/c,this.x=(d+h)/c,this.y=(g+l)/c,this.z=0.25*c);return this},inverse:function(){this.conjugate().normalize();
return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=this.length();0===a?(this.z=this.y=this.x=0,this.w=1):(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a.x,d=a.y,e=a.z,f=a.w,g=b.x,h=b.y,l=b.z,m=b.w;this.x=c*m+f*g+d*l-e*h;this.y=d*m+f*h+e*g-c*l;this.z=e*m+f*l+c*h-d*g;this.w=f*m-c*g-d*h-e*l;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(a,b){var c=this.x,d=this.y,e=this.z,
f=this.w,g=f*a.w+c*a.x+d*a.y+e*a.z;0>g?(this.w=-a.w,this.x=-a.x,this.y=-a.y,this.z=-a.z,g=-g):this.copy(a);if(1<=g)return this.w=f,this.x=c,this.y=d,this.z=e,this;var h=Math.acos(g),l=Math.sqrt(1-g*g);if(0.001>Math.abs(l))return this.w=0.5*(f+this.w),this.x=0.5*(c+this.x),this.y=0.5*(d+this.y),this.z=0.5*(e+this.z),this;g=Math.sin((1-b)*h)/l;h=Math.sin(b*h)/l;this.w=f*g+this.w*h;this.x=c*g+this.x*h;this.y=d*g+this.y*h;this.z=e*g+this.z*h;return this},equals:function(a){return a.x===this.x&&a.y===
this.y&&a.z===this.z&&a.w===this.w},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}});THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.extend(THREE.Vector2.prototype,{set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==
b)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},
subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a):this.set(0,0);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},negate:function(){return this.multiplyScalar(-1)},
dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*
b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}});THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.extend(THREE.Vector3.prototype,{set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+
a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,l=a*c+g*b-e*d,m=a*d+e*c-f*b,b=-e*b-f*c-g*d;this.x=h*a+b*-e+l*-g-m*-f;this.y=l*a+b*-f+m*-e-h*-g;this.z=m*a+b*-g+h*-f-l*-e;return this},applyEuler:function(){var a=new THREE.Quaternion;return function(b,c){var d=a.setFromEuler(b,c);this.applyQuaternion(d);return this}}(),
applyAxisAngle:function(){var a=new THREE.Quaternion;return function(b,c){var d=a.setFromAxisAngle(b,c);this.applyQuaternion(d);return this}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a):this.z=this.y=this.x=0;return this},
min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*
this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),
this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;this.x=d*a.z-e*a.y;this.y=e*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},projectOnVector:function(){var a=new THREE.Vector3;return function(b){a.copy(b).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a=new THREE.Vector3;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),
reflect:function(){var a=new THREE.Vector3;return function(b){a.copy(this).projectOnVector(b).multiplyScalar(2);return this.subVectors(a,this)}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},getPositionFromMatrix:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];
return this},setEulerFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,e=d[0],f=d[4],g=d[8],h=d[1],l=d[5],m=d[9],n=d[2],q=d[6],d=d[10];void 0===b||"XYZ"===b?(this.y=Math.asin(c(g)),0.99999>Math.abs(g)?(this.x=Math.atan2(-m,d),this.z=Math.atan2(-f,e)):(this.x=Math.atan2(q,l),this.z=0)):"YXZ"===b?(this.x=Math.asin(-c(m)),0.99999>Math.abs(m)?(this.y=Math.atan2(g,d),this.z=Math.atan2(h,l)):(this.y=Math.atan2(-n,e),this.z=0)):"ZXY"===b?(this.x=Math.asin(c(q)),
0.99999>Math.abs(q)?(this.y=Math.atan2(-n,d),this.z=Math.atan2(-f,l)):(this.y=0,this.z=Math.atan2(h,e))):"ZYX"===b?(this.y=Math.asin(-c(n)),0.99999>Math.abs(n)?(this.x=Math.atan2(q,d),this.z=Math.atan2(h,e)):(this.x=0,this.z=Math.atan2(-f,l))):"YZX"===b?(this.z=Math.asin(c(h)),0.99999>Math.abs(h)?(this.x=Math.atan2(-m,l),this.y=Math.atan2(-n,e)):(this.x=0,this.y=Math.atan2(g,d))):"XZY"===b&&(this.z=Math.asin(-c(f)),0.99999>Math.abs(f)?(this.x=Math.atan2(q,l),this.y=Math.atan2(g,e)):(this.x=Math.atan2(-m,
d),this.y=0));return this},setEulerFromQuaternion:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.x*a.x,e=a.y*a.y,f=a.z*a.z,g=a.w*a.w;void 0===b||"XYZ"===b?(this.x=Math.atan2(2*(a.x*a.w-a.y*a.z),g-d-e+f),this.y=Math.asin(c(2*(a.x*a.z+a.y*a.w))),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),g+d-e-f)):"YXZ"===b?(this.x=Math.asin(c(2*(a.x*a.w-a.y*a.z))),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),g-d-e+f),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),g-d+e-f)):"ZXY"===b?(this.x=Math.asin(c(2*(a.x*a.w+
a.y*a.z))),this.y=Math.atan2(2*(a.y*a.w-a.z*a.x),g-d-e+f),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),g-d+e-f)):"ZYX"===b?(this.x=Math.atan2(2*(a.x*a.w+a.z*a.y),g-d-e+f),this.y=Math.asin(c(2*(a.y*a.w-a.x*a.z))),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),g+d-e-f)):"YZX"===b?(this.x=Math.atan2(2*(a.x*a.w-a.z*a.y),g-d+e-f),this.y=Math.atan2(2*(a.y*a.w-a.x*a.z),g+d-e-f),this.z=Math.asin(c(2*(a.x*a.y+a.z*a.w)))):"XZY"===b&&(this.x=Math.atan2(2*(a.x*a.w+a.y*a.z),g-d+e-f),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),g+d-
e-f),this.z=Math.asin(c(2*(a.z*a.w-a.x*a.y))));return this},getScaleFromMatrix:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}});
THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.extend(THREE.Vector4.prototype,{set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;
case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,
b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=
this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},
setAxisAngleFromRotationMatrix:function(a){var b,c,d;a=a.elements;var e=a[0];d=a[4];var f=a[8],g=a[1],h=a[5],l=a[9];c=a[2];b=a[6];var m=a[10];if(0.01>Math.abs(d-g)&&0.01>Math.abs(f-c)&&0.01>Math.abs(l-b)){if(0.1>Math.abs(d+g)&&0.1>Math.abs(f+c)&&0.1>Math.abs(l+b)&&0.1>Math.abs(e+h+m-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;h=(h+1)/2;m=(m+1)/2;d=(d+g)/4;f=(f+c)/4;l=(l+b)/4;e>h&&e>m?0.01>e?(b=0,d=c=0.707106781):(b=Math.sqrt(e),c=d/b,d=f/b):h>m?0.01>h?(b=0.707106781,c=0,d=0.707106781):(c=
Math.sqrt(h),b=d/c,d=l/c):0.01>m?(c=b=0.707106781,d=0):(d=Math.sqrt(m),b=f/d,c=l/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-l)*(b-l)+(f-c)*(f-c)+(g-d)*(g-d));0.001>Math.abs(a)&&(a=1);this.x=(b-l)/a;this.y=(f-c)/a;this.z=(g-d)/a;this.w=Math.acos((e+h+m-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);this.w<
a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+
this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===
this.w},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}});THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.extend(THREE.Line3.prototype,{set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,
b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var e=b.dot(b),e=b.dot(a)/e;d&&(e=THREE.Math.clamp(e,0,1));return e}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}});THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.extend(THREE.Box2.prototype,{set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);
this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);
return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a){return new THREE.Vector2((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/
(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);
return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}});THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.extend(THREE.Box3.prototype,{set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y),b.z<this.min.z?this.min.z=b.z:b.z>this.max.z&&(this.max.z=b.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector3;
return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},
size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=
this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a){return new THREE.Vector3((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,
this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=0.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,
new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,
this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}});
THREE.Matrix3=function(a,b,c,d,e,f,g,h,l){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,d||0,void 0!==e?e:1,f||0,g||0,h||0,void 0!==l?l:1)};
THREE.extend(THREE.Matrix3.prototype,{set:function(a,b,c,d,e,f,g,h,l){var m=this.elements;m[0]=a;m[3]=b;m[6]=c;m[1]=d;m[4]=e;m[7]=f;m[2]=g;m[5]=h;m[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},multiplyVector3Array:function(){var a=
new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],l=a[7],a=a[8];return b*f*a-b*g*l-c*e*a+c*g*h+d*e*l-d*f*h},getInverse:function(a,b){var c=a.elements,d=this.elements;
d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},transpose:function(){var a,
b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},clone:function(){var a=this.elements;return new THREE.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}});
THREE.Matrix4=function(a,b,c,d,e,f,g,h,l,m,n,q,p,t,u,r){var s=this.elements=new Float32Array(16);s[0]=void 0!==a?a:1;s[4]=b||0;s[8]=c||0;s[12]=d||0;s[1]=e||0;s[5]=void 0!==f?f:1;s[9]=g||0;s[13]=h||0;s[2]=l||0;s[6]=m||0;s[10]=void 0!==n?n:1;s[14]=q||0;s[3]=p||0;s[7]=t||0;s[11]=u||0;s[15]=void 0!==r?r:1};
THREE.extend(THREE.Matrix4.prototype,{set:function(a,b,c,d,e,f,g,h,l,m,n,q,p,t,u,r){var s=this.elements;s[0]=a;s[4]=b;s[8]=c;s[12]=d;s[1]=e;s[5]=f;s[9]=g;s[13]=h;s[2]=l;s[6]=m;s[10]=n;s[14]=q;s[3]=p;s[7]=t;s[11]=u;s[15]=r;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this},setRotationFromEuler:function(a,b){var c=this.elements,
d=a.x,e=a.y,f=a.z,g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e),l=Math.cos(f),f=Math.sin(f);if(void 0===b||"XYZ"===b){var m=g*l,n=g*f,q=d*l,p=d*f;c[0]=h*l;c[4]=-h*f;c[8]=e;c[1]=n+q*e;c[5]=m-p*e;c[9]=-d*h;c[2]=p-m*e;c[6]=q+n*e;c[10]=g*h}else"YXZ"===b?(m=h*l,n=h*f,q=e*l,p=e*f,c[0]=m+p*d,c[4]=q*d-n,c[8]=g*e,c[1]=g*f,c[5]=g*l,c[9]=-d,c[2]=n*d-q,c[6]=p+m*d,c[10]=g*h):"ZXY"===b?(m=h*l,n=h*f,q=e*l,p=e*f,c[0]=m-p*d,c[4]=-g*f,c[8]=q+n*d,c[1]=n+q*d,c[5]=g*l,c[9]=p-m*d,c[2]=-g*e,c[6]=d,c[10]=g*h):
"ZYX"===b?(m=g*l,n=g*f,q=d*l,p=d*f,c[0]=h*l,c[4]=q*e-n,c[8]=m*e+p,c[1]=h*f,c[5]=p*e+m,c[9]=n*e-q,c[2]=-e,c[6]=d*h,c[10]=g*h):"YZX"===b?(m=g*h,n=g*e,q=d*h,p=d*e,c[0]=h*l,c[4]=p-m*f,c[8]=q*f+n,c[1]=f,c[5]=g*l,c[9]=-d*l,c[2]=-e*l,c[6]=n*f+q,c[10]=m-p*f):"XZY"===b&&(m=g*h,n=g*e,q=d*h,p=d*e,c[0]=h*l,c[4]=-f,c[8]=e*l,c[1]=m*f+p,c[5]=g*l,c[9]=n*f-q,c[2]=q*f-n,c[6]=d*l,c[10]=p*f+m);return this},setRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,l=e+e;a=c*g;var m=
c*h,c=c*l,n=d*h,d=d*l,e=e*l,g=f*g,h=f*h,f=f*l;b[0]=1-(n+e);b[4]=m-f;b[8]=c+h;b[1]=m+f;b[5]=1-(a+e);b[9]=d-g;b[2]=c-h;b[6]=d+g;b[10]=1-(a+n);return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f){var g=this.elements;c.subVectors(d,e).normalize();0===c.length()&&(c.z=1);a.crossVectors(f,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(f,c).normalize());b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=
a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],l=c[12],m=c[1],n=c[5],q=c[9],p=c[13],t=c[2],u=c[6],r=c[10],s=c[14],A=c[3],v=c[7],B=c[11],c=c[15],w=d[0],F=d[4],K=d[8],C=d[12],z=d[1],N=d[5],O=d[9],
L=d[13],U=d[2],D=d[6],M=d[10],I=d[14],J=d[3],E=d[7],Y=d[11],d=d[15];e[0]=f*w+g*z+h*U+l*J;e[4]=f*F+g*N+h*D+l*E;e[8]=f*K+g*O+h*M+l*Y;e[12]=f*C+g*L+h*I+l*d;e[1]=m*w+n*z+q*U+p*J;e[5]=m*F+n*N+q*D+p*E;e[9]=m*K+n*O+q*M+p*Y;e[13]=m*C+n*L+q*I+p*d;e[2]=t*w+u*z+r*U+s*J;e[6]=t*F+u*N+r*D+s*E;e[10]=t*K+u*O+r*M+s*Y;e[14]=t*C+u*L+r*I+s*d;e[3]=A*w+v*z+B*U+c*J;e[7]=A*F+v*N+B*D+c*E;e[11]=A*K+v*O+B*M+c*Y;e[15]=A*C+v*L+B*I+c*d;return this},multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);
c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return a.applyProjection(this)},multiplyVector4:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyProjection(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;a.x=c*b[0]+d*b[4]+e*b[8];a.y=
c*b[1]+d*b[5]+e*b[9];a.z=c*b[2]+d*b[6]+e*b[10];a.normalize();return a},crossVector:function(a){var b=this.elements,c=new THREE.Vector4;c.x=b[0]*a.x+b[4]*a.y+b[8]*a.z+b[12]*a.w;c.y=b[1]*a.x+b[5]*a.y+b[9]*a.z+b[13]*a.w;c.z=b[2]*a.x+b[6]*a.y+b[10]*a.z+b[14]*a.w;c.w=a.w?b[3]*a.x+b[7]*a.y+b[11]*a.z+b[15]*a.w:1;return c},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],l=a[13],m=a[2],n=a[6],q=a[10],p=a[14];return a[3]*(+e*h*n-d*l*n-e*g*q+c*l*q+d*g*p-c*h*p)+a[7]*
(+b*h*p-b*l*q+e*f*q-d*f*p+d*l*m-e*h*m)+a[11]*(+b*l*n-b*g*p-e*f*n+c*f*p+e*g*m-c*l*m)+a[15]*(-d*g*m-b*h*n+b*g*q+d*f*n-c*f*q+c*h*m)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=
b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");
var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],l=d[1],m=d[5],n=d[9],q=d[13],p=d[2],t=d[6],u=d[10],r=d[14],s=d[3],A=d[7],v=d[11],B=d[15];c[0]=n*r*A-q*u*A+q*t*v-m*r*v-n*t*B+m*u*B;c[4]=h*u*A-g*r*A-h*t*v+f*r*v+g*t*B-f*u*B;c[8]=g*q*A-h*n*A+h*m*v-f*q*v-g*m*B+f*n*B;c[12]=h*n*t-g*q*t-h*m*u+f*q*u+g*m*r-f*n*r;c[1]=q*u*s-n*r*s-
q*p*v+l*r*v+n*p*B-l*u*B;c[5]=g*r*s-h*u*s+h*p*v-e*r*v-g*p*B+e*u*B;c[9]=h*n*s-g*q*s-h*l*v+e*q*v+g*l*B-e*n*B;c[13]=g*q*p-h*n*p+h*l*u-e*q*u-g*l*r+e*n*r;c[2]=m*r*s-q*t*s+q*p*A-l*r*A-m*p*B+l*t*B;c[6]=h*t*s-f*r*s-h*p*A+e*r*A+f*p*B-e*t*B;c[10]=f*q*s-h*m*s+h*l*A-e*q*A-f*l*B+e*m*B;c[14]=h*m*p-f*q*p-h*l*t+e*q*t+f*l*r-e*m*r;c[3]=n*t*s-m*u*s-n*p*A+l*u*A+m*p*v-l*t*v;c[7]=f*u*s-g*t*s+g*p*A-e*u*A-f*p*v+e*t*v;c[11]=g*m*s-f*n*s-g*l*A+e*n*A+f*l*v-e*m*v;c[15]=f*n*p-g*m*p+g*l*t-e*n*t-f*l*u+e*m*u;c=d[0]*c[0]+d[1]*c[4]+
d[2]*c[8]+d[3]*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},compose:function(){var a=new THREE.Matrix4,b=new THREE.Matrix4;return function(c,d,e){var f=this.elements;a.identity();a.setRotationFromQuaternion(d);b.makeScale(e.x,e.y,e.z);this.multiplyMatrices(a,b);f[12]=c.x;f[13]=c.y;f[14]=c.z;return this}}(),decompose:function(){var a=
new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Matrix4;return function(e,f,g){var h=this.elements;a.set(h[0],h[1],h[2]);b.set(h[4],h[5],h[6]);c.set(h[8],h[9],h[10]);e=e instanceof THREE.Vector3?e:new THREE.Vector3;f=f instanceof THREE.Quaternion?f:new THREE.Quaternion;g=g instanceof THREE.Vector3?g:new THREE.Vector3;g.x=a.length();g.y=b.length();g.z=c.length();e.x=h[12];e.y=h[13];e.z=h[14];d.copy(this);d.elements[0]/=g.x;d.elements[1]/=g.x;d.elements[2]/=g.x;d.elements[4]/=
g.y;d.elements[5]/=g.y;d.elements[6]/=g.y;d.elements[8]/=g.z;d.elements[9]/=g.z;d.elements[10]/=g.z;f.setFromRotationMatrix(d);return[e,f,g]}}(),extractPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements;b=b.elements;var d=1/a.set(b[0],b[1],b[2]).length(),e=1/a.set(b[4],b[5],b[6]).length(),f=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*
d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[8]=b[8]*f;c[9]=b[9]*f;c[10]=b[10]*f;return this}}(),translate:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[12]=b[0]*c+b[4]*d+b[8]*a+b[12];b[13]=b[1]*c+b[5]*d+b[9]*a+b[13];b[14]=b[2]*c+b[6]*d+b[10]*a+b[14];b[15]=b[3]*c+b[7]*d+b[11]*a+b[15];return this},rotateX:function(a){var b=this.elements,c=b[4],d=b[5],e=b[6],f=b[7],g=b[8],h=b[9],l=b[10],m=b[11],n=Math.cos(a);a=Math.sin(a);b[4]=n*c+a*g;b[5]=n*d+a*h;b[6]=n*e+a*l;b[7]=n*f+a*m;b[8]=n*g-a*c;b[9]=n*h-a*
d;b[10]=n*l-a*e;b[11]=n*m-a*f;return this},rotateY:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[8],h=b[9],l=b[10],m=b[11],n=Math.cos(a);a=Math.sin(a);b[0]=n*c-a*g;b[1]=n*d-a*h;b[2]=n*e-a*l;b[3]=n*f-a*m;b[8]=n*g+a*c;b[9]=n*h+a*d;b[10]=n*l+a*e;b[11]=n*m+a*f;return this},rotateZ:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],l=b[6],m=b[7],n=Math.cos(a);a=Math.sin(a);b[0]=n*c+a*g;b[1]=n*d+a*h;b[2]=n*e+a*l;b[3]=n*f+a*m;b[4]=n*g-a*c;b[5]=n*h-a*d;b[6]=n*l-a*
e;b[7]=n*m-a*f;return this},rotateByAxis:function(a,b){var c=this.elements;if(1===a.x&&0===a.y&&0===a.z)return this.rotateX(b);if(0===a.x&&1===a.y&&0===a.z)return this.rotateY(b);if(0===a.x&&0===a.y&&1===a.z)return this.rotateZ(b);var d=a.x,e=a.y,f=a.z,g=Math.sqrt(d*d+e*e+f*f),d=d/g,e=e/g,f=f/g,g=d*d,h=e*e,l=f*f,m=Math.cos(b),n=Math.sin(b),q=1-m,p=d*e*q,t=d*f*q,q=e*f*q,d=d*n,u=e*n,n=f*n,f=g+(1-g)*m,g=p+n,e=t-u,p=p-n,h=h+(1-h)*m,n=q+d,t=t+u,q=q-d,l=l+(1-l)*m,m=c[0],d=c[1],u=c[2],r=c[3],s=c[4],A=c[5],
v=c[6],B=c[7],w=c[8],F=c[9],K=c[10],C=c[11];c[0]=f*m+g*s+e*w;c[1]=f*d+g*A+e*F;c[2]=f*u+g*v+e*K;c[3]=f*r+g*B+e*C;c[4]=p*m+h*s+n*w;c[5]=p*d+h*A+n*F;c[6]=p*u+h*v+n*K;c[7]=p*r+h*B+n*C;c[8]=t*m+q*s+l*w;c[9]=t*d+q*A+l*F;c[10]=t*u+q*v+l*K;c[11]=t*r+q*B+l*C;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*
a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,
0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,l=e*f,m=e*g;this.set(l*f+c,l*g-d*h,l*h+d*g,0,l*g+d*h,m*g+c,m*h-d*f,0,l*h-d*g,m*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeFrustum:function(a,b,c,d,e,f){var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(d-c);g[9]=(d+c)/(d-c);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*
f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makePerspective:function(a,b,c,d){a=c*Math.tan(THREE.Math.degToRad(0.5*a));var e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,l=c-d,m=f-e;g[0]=2/h;g[4]=0;g[8]=0;g[12]=-((b+a)/h);g[1]=0;g[5]=2/l;g[9]=0;g[13]=-((c+d)/l);g[2]=0;g[6]=0;g[10]=-2/m;g[14]=-((f+e)/m);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},clone:function(){var a=this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],
a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}});THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.extend(THREE.Ray.prototype,{set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);var d=
c.dot(this.direction);return c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){return 0!=a.normal.dot(this.direction)||0==a.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(a){var b=
a.normal.dot(this.direction);if(0==b){if(0==a.distanceToPoint(this.origin))return 0}else return-(this.origin.dot(a.normal)+a.constant)/b},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return void 0===c?void 0:this.at(c,b)},applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}});
THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.extend(THREE.Sphere.prototype,{set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromCenterAndPoints:function(a,b){for(var c=0,d=0,e=b.length;d<e;d++)var f=a.distanceToSquared(b[d]),c=Math.max(c,f);this.center=a;this.radius=Math.sqrt(c);return this},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-
this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);
this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}});THREE.Frustum=function(a,b,c,d,e,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane]};
THREE.extend(THREE.Frustum.prototype,{set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],l=c[6],m=c[7],n=c[8],q=c[9],p=c[10],t=c[11],u=c[12],r=c[13],s=c[14],c=c[15];b[0].setComponents(f-a,m-g,t-n,c-u).normalize();b[1].setComponents(f+
a,m+g,t+n,c+u).normalize();b[2].setComponents(f+d,m+h,t+q,c+r).normalize();b[3].setComponents(f-d,m-h,t-q,c-r).normalize();b[4].setComponents(f-e,m-l,t-p,c-s).normalize();b[5].setComponents(f+e,m+l,t+p,c+s).normalize();return this},intersectsObject:function(){var a=new THREE.Vector3;return function(b){var c=b.matrixWorld,d=this.planes;b=-b.geometry.boundingSphere.radius*c.getMaxScaleOnAxis();a.getPositionFromMatrix(c);for(c=0;6>c;c++)if(d[c].distanceToPoint(a)<b)return!1;return!0}}(),intersectsSphere:function(a){var b=
this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}});THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.extend(THREE.Plane.prototype,{set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,c);return this}}(),
copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),f=this.normal.dot(e);if(0==f){if(0==this.distanceToPoint(b.start))return d.copy(b.start)}else return f=-(b.start.dot(this.normal)+this.constant)/f,0>f||1<f?void 0:d.copy(e).multiplyScalar(f).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){d=d||(new THREE.Matrix3).getInverse(c).transpose();var e=a.copy(this.normal).applyMatrix3(d),f=this.coplanarPoint(b);f.applyMatrix4(c);this.setFromNormalAndCoplanarPoint(e,f);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}});
THREE.Math={clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,
b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return 0>a?-1:0<a?1:0},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}()};
THREE.Spline=function(a){function b(a,b,c,d,e,f,g){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*g+(-3*(b-c)-2*a-d)*f+a*e+b}this.points=a;var c=[],d={x:0,y:0,z:0},e,f,g,h,l,m,n,q,p;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){e=(this.points.length-1)*a;f=Math.floor(e);g=e-f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>this.points.length-2?this.points.length-1:f+1;c[3]=f>this.points.length-3?this.points.length-1:
f+2;m=this.points[c[0]];n=this.points[c[1]];q=this.points[c[2]];p=this.points[c[3]];h=g*g;l=g*h;d.x=b(m.x,n.x,q.x,p.x,g,h,l);d.y=b(m.y,n.y,q.y,p.y,g,h,l);d.z=b(m.z,n.z,q.z,p.z,g,h,l);return d};this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;a<c;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,c,d,e=0,f=new THREE.Vector3,g=new THREE.Vector3,h=[],l=0;h[0]=0;a||(a=100);c=this.points.length*a;f.copy(this.points[0]);for(a=1;a<c;a++)b=a/
c,d=this.getPoint(b),g.copy(d),l+=g.distanceTo(f),f.copy(d),b*=this.points.length-1,b=Math.floor(b),b!=e&&(h[b]=l,e=b);h[h.length]=l;return{chunks:h,total:l}};this.reparametrizeByArcLength=function(a){var b,c,d,e,f,g,h=[],l=new THREE.Vector3,m=this.getLength();h.push(l.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){c=m.chunks[b]-m.chunks[b-1];g=Math.ceil(a*c/m.total);e=(b-1)/(this.points.length-1);f=b/(this.points.length-1);for(c=1;c<g-1;c++)d=e+c*(1/g)*(f-e),d=this.getPoint(d),h.push(l.copy(d).clone());
h.push(l.copy(this.points[b]).clone())}this.points=h}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){e=e||new THREE.Vector3;e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var l=b.dot(b);g=b.dot(c);var m=d*l-e*e;h=h||new THREE.Vector3;if(0==m)return h.set(-2,-1,-1);m=1/m;l=(l*f-e*g)*m;d=(d*g-e*f)*m;return h.set(1-l-d,d,l)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.extend(THREE.Triangle.prototype,{constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),
midpoint:function(a){return(a||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&
a.b.equals(this.b)&&a.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}});THREE.Vertex=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};THREE.UV=function(a,b){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(a,b)};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.extend(THREE.Clock.prototype,{start:function(){this.oldTime=this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),
a=0.001*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}});THREE.EventDispatcher=function(){var a={};this.addEventListener=function(b,c){void 0===a[b]&&(a[b]=[]);-1===a[b].indexOf(c)&&a[b].push(c)};this.removeEventListener=function(b,c){var d=a[b].indexOf(c);-1!==d&&a[b].splice(d,1)};this.dispatchEvent=function(b){var c=a[b.type];if(void 0!==c){b.target=this;for(var d=0,e=c.length;d<e;d++)c[d].call(this,b)}}};
(function(a){a.Raycaster=function(b,c,d,e){this.ray=new a.Ray(b,c);0<this.ray.direction.lengthSq()&&this.ray.direction.normalize();this.near=d||0;this.far=e||Infinity};var b=new a.Sphere,c=new a.Ray,d=new a.Plane,e=new a.Vector3,f=new a.Vector3,g=new a.Matrix4,h=function(a,b){return a.distance-b.distance},l=function(h,l,m){if(h instanceof a.Particle){f.getPositionFromMatrix(h.matrixWorld);l=l.ray.distanceToPoint(f);if(l>h.scale.x)return m;m.push({distance:l,point:h.position,face:null,object:h})}else if(h instanceof
a.Mesh){f.getPositionFromMatrix(h.matrixWorld);b.set(f,h.geometry.boundingSphere.radius*h.matrixWorld.getMaxScaleOnAxis());if(!l.ray.isIntersectionSphere(b))return m;var t=h.geometry,u=t.vertices,r=h.material instanceof a.MeshFaceMaterial,s=!0===r?h.material.materials:null,A=h.material.side,v,B,w,F=l.precision;h.matrixRotationWorld.extractRotation(h.matrixWorld);g.getInverse(h.matrixWorld);c.copy(l.ray).applyMatrix4(g);for(var K=0,C=t.faces.length;K<C;K++){var z=t.faces[K],A=!0===r?s[z.materialIndex]:
h.material;if(void 0!==A){d.setFromNormalAndCoplanarPoint(z.normal,u[z.a]);var N=c.distanceToPlane(d);if(!(Math.abs(N)<F)&&!(0>N)&&(A=A.side,!(A!==a.DoubleSide&&(v=c.direction.dot(d.normal),!(A===a.FrontSide?0>v:0<v)))))if(!(N<l.near||N>l.far)){e=c.at(N,e);if(z instanceof a.Face3){if(A=u[z.a],v=u[z.b],B=u[z.c],!a.Triangle.containsPoint(e,A,v,B))continue}else if(z instanceof a.Face4){if(A=u[z.a],v=u[z.b],B=u[z.c],w=u[z.d],!a.Triangle.containsPoint(e,A,v,w)&&!a.Triangle.containsPoint(e,v,B,w))continue}else throw Error("face type not supported");
m.push({distance:N,point:l.ray.at(N),face:z,faceIndex:K,object:h})}}}}},m=function(a,b,c){a=a.getDescendants();for(var d=0,e=a.length;d<e;d++)l(a[d],b,c)};a.Raycaster.prototype.precision=1E-4;a.Raycaster.prototype.set=function(a,b){this.ray.set(a,b);0<this.ray.direction.length()&&this.ray.direction.normalize()};a.Raycaster.prototype.intersectObject=function(a,b){var c=[];!0===b&&m(a,this,c);l(a,this,c);c.sort(h);return c};a.Raycaster.prototype.intersectObjects=function(a,b){for(var c=[],d=0,e=a.length;d<
e;d++)l(a[d],this,c),!0===b&&m(a[d],this,c);c.sort(h);return c}})(THREE);
THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.name="";this.properties={};this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.eulerOrder=THREE.Object3D.defaultEulerOrder;this.scale=new THREE.Vector3(1,1,1);this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixRotationWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=
!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this._vector=new THREE.Vector3};
THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.scale.getScaleFromMatrix(this.matrix);a=(new THREE.Matrix4).extractRotation(this.matrix);this.rotation.setEulerFromRotationMatrix(a,this.eulerOrder);this.position.getPositionFromMatrix(this.matrix)},translate:function(a,b){this.matrix.rotateAxis(b);this.position.add(b.multiplyScalar(a))},translateX:function(a){this.translate(a,this._vector.set(1,0,0))},translateY:function(a){this.translate(a,
this._vector.set(0,1,0))},translateZ:function(a){this.translate(a,this._vector.set(0,0,1))},localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(a){return a.applyMatrix4(THREE.Object3D.__m1.getInverse(this.matrixWorld))},lookAt:function(a){this.matrix.lookAt(a,this.position,this.up);this.rotationAutoUpdate&&(!1===this.useQuaternion?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):this.quaternion.copy(this.matrix.decompose()[1]))},add:function(a){if(a===
this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a);a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__addObject(a)}},remove:function(a){var b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}},
traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},getChildByName:function(a,b){for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c];if(e.name===a||!0===b&&(e=e.getChildByName(a,b),void 0!==e))return e}},getDescendants:function(a){void 0===a&&(a=[]);Array.prototype.push.apply(a,this.children);for(var b=0,c=this.children.length;b<c;b++)this.children[b].getDescendants(a);return a},updateMatrix:function(){this.matrix.setPosition(this.position);
!1===this.useQuaternion?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion);(1!==this.scale.x||1!==this.scale.y||1!==this.scale.z)&&this.matrix.scale(this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),
this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},clone:function(a){void 0===a&&(a=new THREE.Object3D);a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.rotation instanceof THREE.Vector3&&a.rotation.copy(this.rotation);a.eulerOrder=this.eulerOrder;a.scale.copy(this.scale);a.renderDepth=this.renderDepth;a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);a.matrixWorld.copy(this.matrixWorld);a.matrixRotationWorld.copy(this.matrixRotationWorld);
a.matrixAutoUpdate=this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.quaternion.copy(this.quaternion);a.useQuaternion=this.useQuaternion;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;for(var b=0;b<this.children.length;b++)a.add(this.children[b].clone());return a}};THREE.Object3D.__m1=new THREE.Matrix4;THREE.Object3D.defaultEulerOrder="XYZ";THREE.Object3DIdCount=0;
THREE.Projector=function(){function a(){if(f===h){var a=new THREE.RenderableObject;g.push(a);h++;f++;return a}return g[f++]}function b(){if(m===q){var a=new THREE.RenderableVertex;n.push(a);q++;m++;return a}return n[m++]}function c(a,b){return b.z-a.z}function d(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,g=-a.z+a.w,h=-b.z+b.w;if(0<=e&&0<=f&&0<=g&&0<=h)return!0;if(0>e&&0>f||0>g&&0>h)return!1;0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>g?c=Math.max(c,g/(g-h)):0>h&&(d=Math.min(d,g/(g-h)));if(d<
c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var e,f,g=[],h=0,l,m,n=[],q=0,p,t,u=[],r=0,s,A=[],v=0,B,w,F=[],K=0,C,z,N=[],O=0,L={objects:[],sprites:[],lights:[],elements:[]},U=new THREE.Vector3,D=new THREE.Vector4,M=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),I=new THREE.Box3,J=Array(3),E=Array(4),Y=new THREE.Matrix4,ia=new THREE.Matrix4,Ra,Sa=new THREE.Matrix4,Q=new THREE.Matrix3,ba=new THREE.Matrix3,ua=new THREE.Vector3,fa=new THREE.Frustum,qa=new THREE.Vector4,P=new THREE.Vector4;
this.projectVector=function(a,b){b.matrixWorldInverse.getInverse(b.matrixWorld);ia.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);return a.applyProjection(ia)};this.unprojectVector=function(a,b){b.projectionMatrixInverse.getInverse(b.projectionMatrix);ia.multiplyMatrices(b.matrixWorld,b.projectionMatrixInverse);return a.applyProjection(ia)};this.pickingRay=function(a,b){a.z=-1;var c=new THREE.Vector3(a.x,a.y,1);this.unprojectVector(a,b);this.unprojectVector(c,b);c.sub(a).normalize();return new THREE.Raycaster(a,
c)};this.projectScene=function(g,h,q,mb){var za=!1,Aa,ga,wa,ca,da,ta,na,Ba,wb,xb,la,fb,gb;z=w=s=t=0;L.elements.length=0;g.updateMatrixWorld();void 0===h.parent&&h.updateMatrixWorld();Y.copy(h.matrixWorldInverse.getInverse(h.matrixWorld));ia.multiplyMatrices(h.projectionMatrix,Y);ba.getInverse(Y);ba.transpose();fa.setFromMatrix(ia);f=0;L.objects.length=0;L.sprites.length=0;L.lights.length=0;var Ya=function(b){for(var c=0,d=b.children.length;c<d;c++){var f=b.children[c];if(!1!==f.visible){if(f instanceof
THREE.Light)L.lights.push(f);else if(f instanceof THREE.Mesh||f instanceof THREE.Line){if(!1===f.frustumCulled||!0===fa.intersectsObject(f))e=a(),e.object=f,null!==f.renderDepth?e.z=f.renderDepth:(U.getPositionFromMatrix(f.matrixWorld),U.applyProjection(ia),e.z=U.z),L.objects.push(e)}else f instanceof THREE.Sprite||f instanceof THREE.Particle?(e=a(),e.object=f,null!==f.renderDepth?e.z=f.renderDepth:(U.getPositionFromMatrix(f.matrixWorld),U.applyProjection(ia),e.z=U.z),L.sprites.push(e)):(e=a(),e.object=
f,null!==f.renderDepth?e.z=f.renderDepth:(U.getPositionFromMatrix(f.matrixWorld),U.applyProjection(ia),e.z=U.z),L.objects.push(e));Ya(f)}}};Ya(g);!0===q&&L.objects.sort(c);g=0;for(q=L.objects.length;g<q;g++)if(Ba=L.objects[g].object,Ra=Ba.matrixWorld,m=0,Ba instanceof THREE.Mesh){wb=Ba.geometry;wa=wb.vertices;xb=wb.faces;wb=wb.faceVertexUvs;Q.getInverse(Ra);Q.transpose();fb=Ba.material instanceof THREE.MeshFaceMaterial;gb=!0===fb?Ba.material:null;Aa=0;for(ga=wa.length;Aa<ga;Aa++)l=b(),l.positionWorld.copy(wa[Aa]).applyMatrix4(Ra),
l.positionScreen.copy(l.positionWorld).applyMatrix4(ia),l.positionScreen.x/=l.positionScreen.w,l.positionScreen.y/=l.positionScreen.w,l.positionScreen.z/=l.positionScreen.w,l.visible=!(-1>l.positionScreen.x||1<l.positionScreen.x||-1>l.positionScreen.y||1<l.positionScreen.y||-1>l.positionScreen.z||1<l.positionScreen.z);wa=0;for(Aa=xb.length;wa<Aa;wa++){ga=xb[wa];var Ea=!0===fb?gb.materials[ga.materialIndex]:Ba.material;if(void 0!==Ea){ta=Ea.side;if(ga instanceof THREE.Face3)if(ca=n[ga.a],da=n[ga.b],
na=n[ga.c],J[0]=ca.positionScreen,J[1]=da.positionScreen,J[2]=na.positionScreen,!0===ca.visible||!0===da.visible||!0===na.visible||M.isIntersectionBox(I.setFromPoints(J)))if(za=0>(na.positionScreen.x-ca.positionScreen.x)*(da.positionScreen.y-ca.positionScreen.y)-(na.positionScreen.y-ca.positionScreen.y)*(da.positionScreen.x-ca.positionScreen.x),ta===THREE.DoubleSide||za===(ta===THREE.FrontSide))t===r?(la=new THREE.RenderableFace3,u.push(la),r++,t++,p=la):p=u[t++],p.v1.copy(ca),p.v2.copy(da),p.v3.copy(na);
else continue;else continue;else if(ga instanceof THREE.Face4)if(ca=n[ga.a],da=n[ga.b],na=n[ga.c],la=n[ga.d],E[0]=ca.positionScreen,E[1]=da.positionScreen,E[2]=na.positionScreen,E[3]=la.positionScreen,!0===ca.visible||!0===da.visible||!0===na.visible||!0===la.visible||M.isIntersectionBox(I.setFromPoints(E)))if(za=0>(la.positionScreen.x-ca.positionScreen.x)*(da.positionScreen.y-ca.positionScreen.y)-(la.positionScreen.y-ca.positionScreen.y)*(da.positionScreen.x-ca.positionScreen.x)||0>(da.positionScreen.x-
na.positionScreen.x)*(la.positionScreen.y-na.positionScreen.y)-(da.positionScreen.y-na.positionScreen.y)*(la.positionScreen.x-na.positionScreen.x),ta===THREE.DoubleSide||za===(ta===THREE.FrontSide)){if(s===v){var Eb=new THREE.RenderableFace4;A.push(Eb);v++;s++;p=Eb}else p=A[s++];p.v1.copy(ca);p.v2.copy(da);p.v3.copy(na);p.v4.copy(la)}else continue;else continue;p.normalModel.copy(ga.normal);!1===za&&(ta===THREE.BackSide||ta===THREE.DoubleSide)&&p.normalModel.negate();p.normalModel.applyMatrix3(Q).normalize();
p.normalModelView.copy(p.normalModel).applyMatrix3(ba);p.centroidModel.copy(ga.centroid).applyMatrix4(Ra);na=ga.vertexNormals;ca=0;for(da=na.length;ca<da;ca++)la=p.vertexNormalsModel[ca],la.copy(na[ca]),!1===za&&(ta===THREE.BackSide||ta===THREE.DoubleSide)&&la.negate(),la.applyMatrix3(Q).normalize(),p.vertexNormalsModelView[ca].copy(la).applyMatrix3(ba);p.vertexNormalsLength=na.length;ca=0;for(da=wb.length;ca<da;ca++)if(la=wb[ca][wa],void 0!==la){ta=0;for(na=la.length;ta<na;ta++)p.uvs[ca][ta]=la[ta]}p.color=
ga.color;p.material=Ea;ua.copy(p.centroidModel).applyProjection(ia);p.z=ua.z;L.elements.push(p)}}}else if(Ba instanceof THREE.Line){Sa.multiplyMatrices(ia,Ra);wa=Ba.geometry.vertices;ca=b();ca.positionScreen.copy(wa[0]).applyMatrix4(Sa);xb=Ba.type===THREE.LinePieces?2:1;Aa=1;for(ga=wa.length;Aa<ga;Aa++)ca=b(),ca.positionScreen.copy(wa[Aa]).applyMatrix4(Sa),0<(Aa+1)%xb||(da=n[m-2],qa.copy(ca.positionScreen),P.copy(da.positionScreen),!0===d(qa,P)&&(qa.multiplyScalar(1/qa.w),P.multiplyScalar(1/P.w),
w===K?(wb=new THREE.RenderableLine,F.push(wb),K++,w++,B=wb):B=F[w++],B.v1.positionScreen.copy(qa),B.v2.positionScreen.copy(P),B.z=Math.max(qa.z,P.z),B.material=Ba.material,L.elements.push(B)))}g=0;for(q=L.sprites.length;g<q;g++)Ba=L.sprites[g].object,Ra=Ba.matrixWorld,Ba instanceof THREE.Particle&&(D.set(Ra.elements[12],Ra.elements[13],Ra.elements[14],1),D.applyMatrix4(ia),D.z/=D.w,0<D.z&&1>D.z&&(z===O?(za=new THREE.RenderableParticle,N.push(za),O++,z++,C=za):C=N[z++],C.object=Ba,C.x=D.x/D.w,C.y=
D.y/D.w,C.z=D.z,C.rotation=Ba.rotation.z,C.scale.x=Ba.scale.x*Math.abs(C.x-(D.x+h.projectionMatrix.elements[0])/(D.w+h.projectionMatrix.elements[12])),C.scale.y=Ba.scale.y*Math.abs(C.y-(D.y+h.projectionMatrix.elements[5])/(D.w+h.projectionMatrix.elements[13])),C.material=Ba.material,L.elements.push(C)));!0===mb&&L.elements.sort(c);return L}};
THREE.Face3=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=e instanceof Array?e:[];this.vertexTangents=[];this.materialIndex=void 0!==f?f:0;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.Face4=function(a,b,c,d,e,f,g){this.a=a;this.b=b;this.c=c;this.d=d;this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3;this.vertexNormals=e instanceof Array?e:[];this.color=f instanceof THREE.Color?f:new THREE.Color;this.vertexColors=f instanceof Array?f:[];this.vertexTangents=[];this.materialIndex=void 0!==g?g:0;this.centroid=new THREE.Vector3};
THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var a=new THREE.Face4(this.a,this.b,this.c,this.d);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};
THREE.Geometry=function(){THREE.EventDispatcher.call(this);this.id=THREE.GeometryIdCount++;this.name="";this.vertices=[];this.colors=[];this.normals=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=
this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getInverse(a).transpose(),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){var e=this.faces[c];e.normal.applyMatrix3(b).normalize();for(var f=0,g=e.vertexNormals.length;f<g;f++)e.vertexNormals[f].applyMatrix3(b).normalize();e.centroid.applyMatrix4(a)}},computeCentroids:function(){var a,b,c;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],
c.centroid.set(0,0,0),c instanceof THREE.Face3?(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)):c instanceof THREE.Face4&&(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.add(this.vertices[c.d]),c.centroid.divideScalar(4))},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],
f=this.vertices[e.a],g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g);b.subVectors(f,g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d,e;if(void 0===this.__tmpVertices){e=this.__tmpVertices=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)e[b]=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:d instanceof THREE.Face4&&
(d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else{e=this.__tmpVertices;b=0;for(c=this.vertices.length;b<c;b++)e[b].set(0,0,0)}if(a){var f,g,h,l=new THREE.Vector3,m=new THREE.Vector3,n=new THREE.Vector3,q=new THREE.Vector3,p=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(a=this.vertices[d.a],f=this.vertices[d.b],g=this.vertices[d.c],l.subVectors(g,f),m.subVectors(a,f),l.cross(m),e[d.a].add(l),e[d.b].add(l),
e[d.c].add(l)):d instanceof THREE.Face4&&(a=this.vertices[d.a],f=this.vertices[d.b],g=this.vertices[d.c],h=this.vertices[d.d],n.subVectors(h,f),m.subVectors(a,f),n.cross(m),e[d.a].add(n),e[d.b].add(n),e[d.d].add(n),q.subVectors(h,g),p.subVectors(f,g),q.cross(p),e[d.b].add(q),e[d.c].add(q),e[d.d].add(q))}else{b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal)):d instanceof THREE.Face4&&(e[d.a].add(d.normal),e[d.b].add(d.normal),
e[d.c].add(d.normal),e[d.d].add(d.normal))}b=0;for(c=this.vertices.length;b<c;b++)e[b].normalize();b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(d.vertexNormals[0].copy(e[d.a]),d.vertexNormals[1].copy(e[d.b]),d.vertexNormals[2].copy(e[d.c])):d instanceof THREE.Face4&&(d.vertexNormals[0].copy(e[d.a]),d.vertexNormals[1].copy(e[d.b]),d.vertexNormals[2].copy(e[d.c]),d.vertexNormals[3].copy(e[d.d]))},computeMorphNormals:function(){var a,b,c,d,e;c=0;for(d=this.faces.length;c<
d;c++){e=this.faces[c];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone();e.__originalVertexNormals||(e.__originalVertexNormals=[]);a=0;for(b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=e.vertexNormals[a].clone()}var f=new THREE.Geometry;f.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=
[];this.morphNormals[a].vertexNormals=[];var g=this.morphNormals[a].faceNormals,h=this.morphNormals[a].vertexNormals,l,m;c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],l=new THREE.Vector3,m=e instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},g.push(l),h.push(m)}g=this.morphNormals[a];f.vertices=this.morphTargets[a].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(d=
this.faces.length;c<d;c++)e=this.faces[c],l=g.faceNormals[c],m=g.vertexNormals[c],l.copy(e.normal),e instanceof THREE.Face3?(m.a.copy(e.vertexNormals[0]),m.b.copy(e.vertexNormals[1]),m.c.copy(e.vertexNormals[2])):(m.a.copy(e.vertexNormals[0]),m.b.copy(e.vertexNormals[1]),m.c.copy(e.vertexNormals[2]),m.d.copy(e.vertexNormals[3]))}c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){function a(a,b,c,
d,e,f,z){h=a.vertices[b];l=a.vertices[c];m=a.vertices[d];n=g[e];q=g[f];p=g[z];t=l.x-h.x;u=m.x-h.x;r=l.y-h.y;s=m.y-h.y;A=l.z-h.z;v=m.z-h.z;B=q.x-n.x;w=p.x-n.x;F=q.y-n.y;K=p.y-n.y;C=1/(B*K-w*F);L.set((K*t-F*u)*C,(K*r-F*s)*C,(K*A-F*v)*C);U.set((B*u-w*t)*C,(B*s-w*r)*C,(B*v-w*A)*C);N[b].add(L);N[c].add(L);N[d].add(L);O[b].add(U);O[c].add(U);O[d].add(U)}var b,c,d,e,f,g,h,l,m,n,q,p,t,u,r,s,A,v,B,w,F,K,C,z,N=[],O=[],L=new THREE.Vector3,U=new THREE.Vector3,D=new THREE.Vector3,M=new THREE.Vector3,I=new THREE.Vector3;
b=0;for(c=this.vertices.length;b<c;b++)N[b]=new THREE.Vector3,O[b]=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)f=this.faces[b],g=this.faceVertexUvs[0][b],f instanceof THREE.Face3?a(this,f.a,f.b,f.c,0,1,2):f instanceof THREE.Face4&&(a(this,f.a,f.b,f.d,0,1,3),a(this,f.b,f.c,f.d,1,2,3));var J=["a","b","c","d"];b=0;for(c=this.faces.length;b<c;b++){f=this.faces[b];for(d=0;d<f.vertexNormals.length;d++)I.copy(f.vertexNormals[d]),e=f[J[d]],z=N[e],D.copy(z),D.sub(I.multiplyScalar(I.dot(z))).normalize(),
M.crossVectors(f.vertexNormals[d],z),e=M.dot(O[e]),e=0>e?-1:1,f.vertexTangents[d]=new THREE.Vector4(D.x,D.y,D.z,e)}this.hasTangents=!0},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);
this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),f,g,h,l,m;this.__tmpVertices=void 0;f=0;for(g=this.vertices.length;f<g;f++)d=this.vertices[f],d=[Math.round(d.x*e),Math.round(d.y*e),Math.round(d.z*e)].join("_"),void 0===a[d]?(a[d]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[d]];e=[];f=0;for(g=this.faces.length;f<g;f++)if(a=this.faces[f],a instanceof THREE.Face3){a.a=c[a.a];a.b=c[a.b];a.c=c[a.c];
h=[a.a,a.b,a.c];for(l=0;3>l;l++)if(h[l]==h[(l+1)%3]){e.push(f);break}}else if(a instanceof THREE.Face4){a.a=c[a.a];a.b=c[a.b];a.c=c[a.c];a.d=c[a.d];h=[a.a,a.b,a.c,a.d];d=-1;for(l=0;4>l;l++)h[l]==h[(l+1)%4]&&(0<=d&&e.push(f),d=l);if(0<=d){h.splice(d,1);var n=new THREE.Face3(h[0],h[1],h[2],a.normal,a.color,a.materialIndex);h=0;for(l=this.faceVertexUvs.length;h<l;h++)(m=this.faceVertexUvs[h][f])&&m.splice(d,1);a.vertexNormals&&0<a.vertexNormals.length&&(n.vertexNormals=a.vertexNormals,n.vertexNormals.splice(d,
1));a.vertexColors&&0<a.vertexColors.length&&(n.vertexColors=a.vertexColors,n.vertexColors.splice(d,1));this.faces[f]=n}}for(f=e.length-1;0<=f;f--){this.faces.splice(f,1);h=0;for(l=this.faceVertexUvs.length;h<l;h++)this.faceVertexUvs[h].splice(f,1)}c=this.vertices.length-b.length;this.vertices=b;return c},clone:function(){for(var a=new THREE.Geometry,b=this.vertices,c=0,d=b.length;c<d;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(d=b.length;c<d;c++)a.faces.push(b[c].clone());b=this.faceVertexUvs[0];
c=0;for(d=b.length;c<d;c++){for(var e=b[c],f=[],g=0,h=e.length;g<h;g++)f.push(new THREE.Vector2(e[g].x,e[g].y));a.faceVertexUvs[0].push(f)}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.GeometryIdCount=0;THREE.BufferGeometry=function(){THREE.EventDispatcher.call(this);this.id=THREE.GeometryIdCount++;this.attributes={};this.dynamic=!1;this.offsets=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.morphTargets=[]};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,applyMatrix:function(a){var b,c;this.attributes.position&&(b=this.attributes.position.array);this.attributes.normal&&(c=this.attributes.normal.array);void 0!==b&&(a.multiplyVector3Array(b),this.verticesNeedUpdate=!0);void 0!==c&&(b=new THREE.Matrix3,b.getInverse(a).transpose(),b.multiplyVector3Array(c),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);
var a=this.attributes.position.array;if(a){var b=this.boundingBox,c,d,e;3<=a.length&&(b.min.x=b.max.x=a[0],b.min.y=b.max.y=a[1],b.min.z=b.max.z=a[2]);for(var f=3,g=a.length;f<g;f+=3)c=a[f],d=a[f+1],e=a[f+2],c<b.min.x?b.min.x=c:c>b.max.x&&(b.max.x=c),d<b.min.y?b.min.y=d:d>b.max.y&&(b.max.y=d),e<b.min.z?b.min.z=e:e>b.max.z&&(b.max.z=e)}if(void 0===a||0===a.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=
new THREE.Sphere);var a=this.attributes.position.array;if(a){for(var b,c=0,d,e,f=0,g=a.length;f<g;f+=3)b=a[f],d=a[f+1],e=a[f+2],b=b*b+d*d+e*e,b>c&&(c=b);this.boundingSphere.radius=Math.sqrt(c)}},computeVertexNormals:function(){if(this.attributes.position){var a,b,c,d;a=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(a),numItems:a};else{a=0;for(b=this.attributes.normal.array.length;a<b;a++)this.attributes.normal.array[a]=
0}var e=this.attributes.position.array,f=this.attributes.normal.array,g,h,l,m,n,q,p=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Vector3;if(this.attributes.index){var A=this.attributes.index.array,v=this.offsets;c=0;for(d=v.length;c<d;++c){b=v[c].start;g=v[c].count;var B=v[c].index;a=b;for(b+=g;a<b;a+=3)g=B+A[a],h=B+A[a+1],l=B+A[a+2],m=e[3*g],n=e[3*g+1],q=e[3*g+2],p.set(m,n,q),m=e[3*h],n=e[3*h+1],q=e[3*h+2],t.set(m,n,q),m=e[3*l],n=e[3*l+1],q=e[3*l+2],u.set(m,
n,q),r.subVectors(u,t),s.subVectors(p,t),r.cross(s),f[3*g]+=r.x,f[3*g+1]+=r.y,f[3*g+2]+=r.z,f[3*h]+=r.x,f[3*h+1]+=r.y,f[3*h+2]+=r.z,f[3*l]+=r.x,f[3*l+1]+=r.y,f[3*l+2]+=r.z}}else{a=0;for(b=e.length;a<b;a+=9)m=e[a],n=e[a+1],q=e[a+2],p.set(m,n,q),m=e[a+3],n=e[a+4],q=e[a+5],t.set(m,n,q),m=e[a+6],n=e[a+7],q=e[a+8],u.set(m,n,q),r.subVectors(u,t),s.subVectors(p,t),r.cross(s),f[a]=r.x,f[a+1]=r.y,f[a+2]=r.z,f[a+3]=r.x,f[a+4]=r.y,f[a+5]=r.z,f[a+6]=r.x,f[a+7]=r.y,f[a+8]=r.z}this.normalizeNormals();this.normalsNeedUpdate=
!0}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,d,e=0,f=a.length;e<f;e+=3)b=a[e],c=a[e+1],d=a[e+2],b=1/Math.sqrt(b*b+c*c+d*d),a[e]*=b,a[e+1]*=b,a[e+2]*=b},computeTangents:function(){function a(a){Ra.x=d[3*a];Ra.y=d[3*a+1];Ra.z=d[3*a+2];Sa.copy(Ra);ba=l[a];Y.copy(ba);Y.sub(Ra.multiplyScalar(Ra.dot(ba))).normalize();ia.crossVectors(Sa,ba);ua=ia.dot(m[a]);Q=0>ua?-1:1;h[4*a]=Y.x;h[4*a+1]=Y.y;h[4*a+2]=Y.z;h[4*a+3]=Q}if(void 0===this.attributes.index||void 0===this.attributes.position||
void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var b=this.attributes.index.array,c=this.attributes.position.array,d=this.attributes.normal.array,e=this.attributes.uv.array,f=c.length/3;if(void 0===this.attributes.tangent){var g=4*f;this.attributes.tangent={itemSize:4,array:new Float32Array(g),numItems:g}}for(var h=this.attributes.tangent.array,l=[],m=[],g=0;g<f;g++)l[g]=
new THREE.Vector3,m[g]=new THREE.Vector3;var n,q,p,t,u,r,s,A,v,B,w,F,K,C,z,f=new THREE.Vector3,g=new THREE.Vector3,N,O,L,U,D,M,I,J=this.offsets;L=0;for(U=J.length;L<U;++L){O=J[L].start;D=J[L].count;var E=J[L].index;N=O;for(O+=D;N<O;N+=3)D=E+b[N],M=E+b[N+1],I=E+b[N+2],n=c[3*D],q=c[3*D+1],p=c[3*D+2],t=c[3*M],u=c[3*M+1],r=c[3*M+2],s=c[3*I],A=c[3*I+1],v=c[3*I+2],B=e[2*D],w=e[2*D+1],F=e[2*M],K=e[2*M+1],C=e[2*I],z=e[2*I+1],t-=n,n=s-n,u-=q,q=A-q,r-=p,p=v-p,F-=B,B=C-B,K-=w,w=z-w,z=1/(F*w-B*K),f.set((w*t-
K*n)*z,(w*u-K*q)*z,(w*r-K*p)*z),g.set((F*n-B*t)*z,(F*q-B*u)*z,(F*p-B*r)*z),l[D].add(f),l[M].add(f),l[I].add(f),m[D].add(g),m[M].add(g),m[I].add(g)}var Y=new THREE.Vector3,ia=new THREE.Vector3,Ra=new THREE.Vector3,Sa=new THREE.Vector3,Q,ba,ua;L=0;for(U=J.length;L<U;++L){O=J[L].start;D=J[L].count;E=J[L].index;N=O;for(O+=D;N<O;N+=3)D=E+b[N],M=E+b[N+1],I=E+b[N+2],a(D),a(M),a(I)}this.tangentsNeedUpdate=this.hasTangents=!0}},dispose:function(){this.dispatchEvent({type:"dispose"})}};
THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(a){this.matrix.lookAt(this.position,a,this.up);!0===this.rotationAutoUpdate&&(!1===this.useQuaternion?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):this.quaternion.copy(this.matrix.decompose()[1]))};
THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this);this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:0.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};
THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,c=-b,d=a*c,a=Math.abs(a*b-d),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(d+this.x*a/this.fullWidth,d+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.AmbientLight=function(a){THREE.Light.call(this,a)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);
THREE.AreaLight=function(a,b){THREE.Light.call(this,a);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==b?b:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.position=new THREE.Vector3(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=
new THREE.Vector3(0,0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a);this.groundColor=new THREE.Color(b);this.position=new THREE.Vector3(0,100,0);this.intensity=void 0!==c?c:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight=function(a,b,c){THREE.Light.call(this,a);this.position=new THREE.Vector3(0,0,0);this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);
THREE.SpotLight=function(a,b,c,d,e){THREE.Light.call(this,a);this.position=new THREE.Vector3(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/2;this.exponent=void 0!==e?e:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=
this.shadowMapSize=this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/
a.total).toFixed(0)+"%"):b+((a.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");a.pop();return(1>a.length?".":a.join("/"))+"/"},initMaterials:function(a,b){for(var c=[],d=0;d<a.length;++d)c[d]=THREE.Loader.prototype.createMaterial(a[d],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==
a}function d(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function e(a,e,f,h,l,m,s){var A=/\.dds$/i.test(f),v=b+"/"+f;if(A){var B=THREE.ImageUtils.loadCompressedTexture(v);a[e]=B}else B=document.createElement("canvas"),a[e]=new THREE.Texture(B);a[e].sourceFile=f;h&&(a[e].repeat.set(h[0],h[1]),1!==h[0]&&(a[e].wrapS=THREE.RepeatWrapping),1!==h[1]&&(a[e].wrapT=THREE.RepeatWrapping));l&&a[e].offset.set(l[0],l[1]);m&&(f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==
f[m[0]]&&(a[e].wrapS=f[m[0]]),void 0!==f[m[1]]&&(a[e].wrapT=f[m[1]]));s&&(a[e].anisotropy=s);if(!A){var w=a[e];a=new Image;a.onload=function(){if(!c(this.width)||!c(this.height)){var a=d(this.width),b=d(this.height);w.image.width=a;w.image.height=b;w.image.getContext("2d").drawImage(this,0,0,a,b)}else w.image=this;w.needsUpdate=!0};a.crossOrigin=g.crossOrigin;a.src=v}}function f(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var g=this,h="MeshLambertMaterial",l={color:15658734,opacity:1,map:null,
lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var m=a.shading.toLowerCase();"phong"===m?h="MeshPhongMaterial":"basic"===m&&(h="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(l.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)l.transparent=a.transparent;void 0!==a.depthTest&&(l.depthTest=a.depthTest);void 0!==a.depthWrite&&(l.depthWrite=a.depthWrite);void 0!==a.visible&&(l.visible=a.visible);void 0!==a.flipSided&&(l.side=THREE.BackSide);
void 0!==a.doubleSided&&(l.side=THREE.DoubleSide);void 0!==a.wireframe&&(l.wireframe=a.wireframe);void 0!==a.vertexColors&&("face"===a.vertexColors?l.vertexColors=THREE.FaceColors:a.vertexColors&&(l.vertexColors=THREE.VertexColors));a.colorDiffuse?l.color=f(a.colorDiffuse):a.DbgColor&&(l.color=a.DbgColor);a.colorSpecular&&(l.specular=f(a.colorSpecular));a.colorAmbient&&(l.ambient=f(a.colorAmbient));a.transparency&&(l.opacity=a.transparency);a.specularCoef&&(l.shininess=a.specularCoef);a.mapDiffuse&&
b&&e(l,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);a.mapLight&&b&&e(l,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&e(l,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&e(l,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&e(l,"specularMap",a.mapSpecular,a.mapSpecularRepeat,
a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapBumpScale&&(l.bumpScale=a.mapBumpScale);a.mapNormal?(h=THREE.ShaderLib.normalmap,m=THREE.UniformsUtils.clone(h.uniforms),m.tNormal.value=l.normalMap,a.mapNormalFactor&&m.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),l.map&&(m.tDiffuse.value=l.map,m.enableDiffuse.value=!0),l.specularMap&&(m.tSpecular.value=l.specularMap,m.enableSpecular.value=!0),l.lightMap&&(m.tAO.value=l.lightMap,m.enableAO.value=!0),m.uDiffuseColor.value.setHex(l.color),
m.uSpecularColor.value.setHex(l.specular),m.uAmbientColor.value.setHex(l.ambient),m.uShininess.value=l.shininess,void 0!==l.opacity&&(m.uOpacity.value=l.opacity),h=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:m,lights:!0,fog:!0}),l.transparent&&(h.transparent=!0)):h=new THREE[h](l);void 0!==a.DbgName&&(h.name=a.DbgName);return h}};THREE.ImageLoader=function(){THREE.EventDispatcher.call(this);this.crossOrigin=null};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b){var c=this;void 0===b&&(b=new Image);b.addEventListener("load",function(){c.dispatchEvent({type:"load",content:b})},!1);b.addEventListener("error",function(){c.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);c.crossOrigin&&(b.crossOrigin=c.crossOrigin);b.src=a}};THREE.JSONLoader=function(a){THREE.Loader.call(this,a);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);
THREE.JSONLoader.prototype.load=function(a,b,c){c=c&&"string"===typeof c?c:this.extractUrlBase(a);this.onLoadStart();this.loadAjaxJSON(this,a,b,c)};
THREE.JSONLoader.prototype.loadAjaxJSON=function(a,b,c,d,e){var f=new XMLHttpRequest,g=0;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status){if(f.responseText){var h=JSON.parse(f.responseText);a.createModel(h,c,d)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");a.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]");else f.readyState===f.LOADING?e&&(0===g&&(g=f.getResponseHeader("Content-Length")),
e({total:g,loaded:f.responseText.length})):f.readyState===f.HEADERS_RECEIVED&&(g=f.getResponseHeader("Content-Length"))};f.open("GET",b,!0);f.withCredentials=this.withCredentials;f.send(null)};
THREE.JSONLoader.prototype.createModel=function(a,b,c){var d=new THREE.Geometry,e=void 0!==a.scale?1/a.scale:1,f,g,h,l,m,n,q,p,t,u,r,s,A,v,B,w=a.faces;u=a.vertices;var F=a.normals,K=a.colors,C=0;for(f=0;f<a.uvs.length;f++)a.uvs[f].length&&C++;for(f=0;f<C;f++)d.faceUvs[f]=[],d.faceVertexUvs[f]=[];l=0;for(m=u.length;l<m;)n=new THREE.Vector3,n.x=u[l++]*e,n.y=u[l++]*e,n.z=u[l++]*e,d.vertices.push(n);l=0;for(m=w.length;l<m;){u=w[l++];n=u&1;h=u&2;f=u&4;g=u&8;p=u&16;q=u&32;r=u&64;u&=128;n?(s=new THREE.Face4,
s.a=w[l++],s.b=w[l++],s.c=w[l++],s.d=w[l++],n=4):(s=new THREE.Face3,s.a=w[l++],s.b=w[l++],s.c=w[l++],n=3);h&&(h=w[l++],s.materialIndex=h);h=d.faces.length;if(f)for(f=0;f<C;f++)A=a.uvs[f],t=w[l++],B=A[2*t],t=A[2*t+1],d.faceUvs[f][h]=new THREE.Vector2(B,t);if(g)for(f=0;f<C;f++){A=a.uvs[f];v=[];for(g=0;g<n;g++)t=w[l++],B=A[2*t],t=A[2*t+1],v[g]=new THREE.Vector2(B,t);d.faceVertexUvs[f][h]=v}p&&(p=3*w[l++],g=new THREE.Vector3,g.x=F[p++],g.y=F[p++],g.z=F[p],s.normal=g);if(q)for(f=0;f<n;f++)p=3*w[l++],g=
new THREE.Vector3,g.x=F[p++],g.y=F[p++],g.z=F[p],s.vertexNormals.push(g);r&&(q=w[l++],q=new THREE.Color(K[q]),s.color=q);if(u)for(f=0;f<n;f++)q=w[l++],q=new THREE.Color(K[q]),s.vertexColors.push(q);d.faces.push(s)}if(a.skinWeights){l=0;for(m=a.skinWeights.length;l<m;l+=2)w=a.skinWeights[l],F=a.skinWeights[l+1],d.skinWeights.push(new THREE.Vector4(w,F,0,0))}if(a.skinIndices){l=0;for(m=a.skinIndices.length;l<m;l+=2)w=a.skinIndices[l],F=a.skinIndices[l+1],d.skinIndices.push(new THREE.Vector4(w,F,0,0))}d.bones=
a.bones;d.animation=a.animation;if(void 0!==a.morphTargets){l=0;for(m=a.morphTargets.length;l<m;l++){d.morphTargets[l]={};d.morphTargets[l].name=a.morphTargets[l].name;d.morphTargets[l].vertices=[];K=d.morphTargets[l].vertices;C=a.morphTargets[l].vertices;w=0;for(F=C.length;w<F;w+=3)u=new THREE.Vector3,u.x=C[w]*e,u.y=C[w+1]*e,u.z=C[w+2]*e,K.push(u)}}if(void 0!==a.morphColors){l=0;for(m=a.morphColors.length;l<m;l++){d.morphColors[l]={};d.morphColors[l].name=a.morphColors[l].name;d.morphColors[l].colors=
[];F=d.morphColors[l].colors;K=a.morphColors[l].colors;e=0;for(w=K.length;e<w;e+=3)C=new THREE.Color(16755200),C.setRGB(K[e],K[e+1],K[e+2]),F.push(C)}}d.computeCentroids();d.computeFaceNormals();a=this.initMaterials(a.materials,c);this.needsTangents(a)&&d.computeTangents();b(d,a)};
THREE.LoadingMonitor=function(){THREE.EventDispatcher.call(this);var a=this,b=0,c=0,d=function(){b++;a.dispatchEvent({type:"progress",loaded:b,total:c});b===c&&a.dispatchEvent({type:"load"})};this.add=function(a){c++;a.addEventListener("load",d,!1)}};
THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlerMap={};this.hierarchyHandlerMap={};this.addGeometryHandler("ascii",THREE.JSONLoader)};THREE.SceneLoader.prototype.constructor=THREE.SceneLoader;
THREE.SceneLoader.prototype.load=function(a,b){var c=this,d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status||0===d.status){var e=JSON.parse(d.responseText);c.parse(e,b,a)}else console.error("THREE.SceneLoader: Couldn't load ["+a+"] ["+d.status+"]")};d.open("GET",a,!0);d.send(null)};THREE.SceneLoader.prototype.addGeometryHandler=function(a,b){this.geometryHandlerMap[a]={loaderClass:b}};
THREE.SceneLoader.prototype.addHierarchyHandler=function(a,b){this.hierarchyHandlerMap[a]={loaderClass:b}};
THREE.SceneLoader.prototype.parse=function(a,b,c){function d(a,b){return"relativeToHTML"==b?a:q+"/"+a}function e(){f(z.scene,O.objects)}function f(a,b){var c,e,g,l,m,q,r;for(r in b)if(void 0===z.objects[r]){var s=b[r],j=null;if(s.type&&s.type in n.hierarchyHandlerMap){if(void 0===s.loading){e={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,properties:1,skin:1,morph:1,mirroredLoop:1,duration:1};g={};for(var w in s)w in e||(g[w]=s[w]);t=z.materials[s.material];s.loading=
!0;e=n.hierarchyHandlerMap[s.type].loaderObject;e.options?e.load(d(s.url,O.urlBaseType),h(r,a,t,s)):e.load(d(s.url,O.urlBaseType),h(r,a,t,s),g)}}else if(void 0!==s.geometry){if(p=z.geometries[s.geometry]){t=z.materials[s.material];j=t instanceof THREE.ShaderMaterial;g=s.position;l=s.rotation;m=s.scale;c=s.matrix;q=s.quaternion;s.material||(t=new THREE.MeshFaceMaterial(z.face_materials[s.geometry]));t instanceof THREE.MeshFaceMaterial&&0===t.materials.length&&(t=new THREE.MeshFaceMaterial(z.face_materials[s.geometry]));
if(t instanceof THREE.MeshFaceMaterial)for(e=0;e<t.materials.length;e++)j=j||t.materials[e]instanceof THREE.ShaderMaterial;j&&p.computeTangents();s.skin?j=new THREE.SkinnedMesh(p,t):s.morph?(j=new THREE.MorphAnimMesh(p,t),void 0!==s.duration&&(j.duration=s.duration),void 0!==s.time&&(j.time=s.time),void 0!==s.mirroredLoop&&(j.mirroredLoop=s.mirroredLoop),t.morphNormals&&p.computeMorphNormals()):j=new THREE.Mesh(p,t);j.name=r;c?(j.matrixAutoUpdate=!1,j.matrix.set(c[0],c[1],c[2],c[3],c[4],c[5],c[6],
c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15])):(j.position.set(g[0],g[1],g[2]),q?(j.quaternion.set(q[0],q[1],q[2],q[3]),j.useQuaternion=!0):j.rotation.set(l[0],l[1],l[2]),j.scale.set(m[0],m[1],m[2]));j.visible=s.visible;j.castShadow=s.castShadow;j.receiveShadow=s.receiveShadow;a.add(j);z.objects[r]=j}}else"DirectionalLight"===s.type||"PointLight"===s.type||"AmbientLight"===s.type?(v=void 0!==s.color?s.color:16777215,B=void 0!==s.intensity?s.intensity:1,"DirectionalLight"===s.type?(g=s.direction,
A=new THREE.DirectionalLight(v,B),A.position.set(g[0],g[1],g[2]),s.target&&(N.push({object:A,targetName:s.target}),A.target=null)):"PointLight"===s.type?(g=s.position,e=s.distance,A=new THREE.PointLight(v,B,e),A.position.set(g[0],g[1],g[2])):"AmbientLight"===s.type&&(A=new THREE.AmbientLight(v)),a.add(A),A.name=r,z.lights[r]=A,z.objects[r]=A):"PerspectiveCamera"===s.type||"OrthographicCamera"===s.type?("PerspectiveCamera"===s.type?u=new THREE.PerspectiveCamera(s.fov,s.aspect,s.near,s.far):"OrthographicCamera"===
s.type&&(u=new THREE.OrthographicCamera(s.left,s.right,s.top,s.bottom,s.near,s.far)),g=s.position,u.position.set(g[0],g[1],g[2]),a.add(u),u.name=r,z.cameras[r]=u,z.objects[r]=u):(g=s.position,l=s.rotation,m=s.scale,q=s.quaternion,j=new THREE.Object3D,j.name=r,j.position.set(g[0],g[1],g[2]),q?(j.quaternion.set(q[0],q[1],q[2],q[3]),j.useQuaternion=!0):j.rotation.set(l[0],l[1],l[2]),j.scale.set(m[0],m[1],m[2]),j.visible=void 0!==s.visible?s.visible:!1,a.add(j),z.objects[r]=j,z.empties[r]=j);if(j){if(void 0!==
s.properties)for(var E in s.properties)j.properties[E]=s.properties[E];if(void 0!==s.groups)for(e=0;e<s.groups.length;e++)g=s.groups[e],void 0===z.groups[g]&&(z.groups[g]=[]),z.groups[g].push(r);void 0!==s.children&&f(j,s.children)}}}function g(a){return function(b,c){z.geometries[a]=b;z.face_materials[a]=c;e();w-=1;n.onLoadComplete();m()}}function h(a,b,c,d){return function(f){f=f.content?f.content:f.dae?f.scene:f;var g=d.position,h=d.rotation,l=d.quaternion,p=d.scale;f.position.set(g[0],g[1],g[2]);
l?(f.quaternion.set(l[0],l[1],l[2],l[3]),f.useQuaternion=!0):f.rotation.set(h[0],h[1],h[2]);f.scale.set(p[0],p[1],p[2]);c&&f.traverse(function(a){a.material=c});var q=void 0!==d.visible?d.visible:!0;f.traverse(function(a){a.visible=q});b.add(f);f.name=a;z.objects[a]=f;e();w-=1;n.onLoadComplete();m()}}function l(a){return function(b,c){z.geometries[a]=b;z.face_materials[a]=c}}function m(){n.callbackProgress({totalModels:K,totalTextures:C,loadedModels:K-w,loadedTextures:C-F},z);n.onLoadProgress();if(0===
w&&0===F){for(var a=0;a<N.length;a++){var c=N[a],d=z.objects[c.targetName];d?c.object.target=d:(c.object.target=new THREE.Object3D,z.scene.add(c.object.target));c.object.target.properties.targetInverse=c.object}b(z)}}var n=this,q=THREE.Loader.prototype.extractUrlBase(c),p,t,u,r,s,A,v,B,w,F,K,C,z,N=[],O=a,L;for(L in this.geometryHandlerMap)a=this.geometryHandlerMap[L].loaderClass,this.geometryHandlerMap[L].loaderObject=new a;for(L in this.hierarchyHandlerMap)a=this.hierarchyHandlerMap[L].loaderClass,
this.hierarchyHandlerMap[L].loaderObject=new a;F=w=0;z={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(O.transform&&(L=O.transform.position,a=O.transform.rotation,c=O.transform.scale,L&&z.scene.position.set(L[0],L[1],L[2]),a&&z.scene.rotation.set(a[0],a[1],a[2]),c&&z.scene.scale.set(c[0],c[1],c[2]),L||a||c))z.scene.updateMatrix(),z.scene.updateMatrixWorld();L=function(a){return function(){F-=a;m();n.onLoadComplete()}};
for(var U in O.fogs)a=O.fogs[U],"linear"===a.type?r=new THREE.Fog(0,a.near,a.far):"exp2"===a.type&&(r=new THREE.FogExp2(0,a.density)),a=a.color,r.color.setRGB(a[0],a[1],a[2]),z.fogs[U]=r;for(var D in O.geometries)r=O.geometries[D],r.type in this.geometryHandlerMap&&(w+=1,n.onLoadStart());for(var M in O.objects)r=O.objects[M],r.type&&r.type in this.hierarchyHandlerMap&&(w+=1,n.onLoadStart());K=w;for(D in O.geometries)if(r=O.geometries[D],"cube"===r.type)p=new THREE.CubeGeometry(r.width,r.height,r.depth,
r.widthSegments,r.heightSegments,r.depthSegments),z.geometries[D]=p;else if("plane"===r.type)p=new THREE.PlaneGeometry(r.width,r.height,r.widthSegments,r.heightSegments),z.geometries[D]=p;else if("sphere"===r.type)p=new THREE.SphereGeometry(r.radius,r.widthSegments,r.heightSegments),z.geometries[D]=p;else if("cylinder"===r.type)p=new THREE.CylinderGeometry(r.topRad,r.botRad,r.height,r.radSegs,r.heightSegs),z.geometries[D]=p;else if("torus"===r.type)p=new THREE.TorusGeometry(r.radius,r.tube,r.segmentsR,
r.segmentsT),z.geometries[D]=p;else if("icosahedron"===r.type)p=new THREE.IcosahedronGeometry(r.radius,r.subdivisions),z.geometries[D]=p;else if(r.type in this.geometryHandlerMap){M={};for(s in r)"type"!==s&&"url"!==s&&(M[s]=r[s]);this.geometryHandlerMap[r.type].loaderObject.load(d(r.url,O.urlBaseType),g(D),M)}else"embedded"===r.type&&(M=O.embeds[r.id],M.metadata=O.metadata,M&&this.geometryHandlerMap.ascii.loaderObject.createModel(M,l(D),""));for(var I in O.textures)if(D=O.textures[I],D.url instanceof
Array){F+=D.url.length;for(s=0;s<D.url.length;s++)n.onLoadStart()}else F+=1,n.onLoadStart();C=F;for(I in O.textures){D=O.textures[I];void 0!==D.mapping&&void 0!==THREE[D.mapping]&&(D.mapping=new THREE[D.mapping]);if(D.url instanceof Array){M=D.url.length;r=[];for(s=0;s<M;s++)r[s]=d(D.url[s],O.urlBaseType);s=(s=/\.dds$/i.test(r[0]))?THREE.ImageUtils.loadCompressedTextureCube(r,D.mapping,L(M)):THREE.ImageUtils.loadTextureCube(r,D.mapping,L(M))}else s=/\.dds$/i.test(D.url),M=d(D.url,O.urlBaseType),r=
L(1),s=s?THREE.ImageUtils.loadCompressedTexture(M,D.mapping,r):THREE.ImageUtils.loadTexture(M,D.mapping,r),void 0!==THREE[D.minFilter]&&(s.minFilter=THREE[D.minFilter]),void 0!==THREE[D.magFilter]&&(s.magFilter=THREE[D.magFilter]),D.anisotropy&&(s.anisotropy=D.anisotropy),D.repeat&&(s.repeat.set(D.repeat[0],D.repeat[1]),1!==D.repeat[0]&&(s.wrapS=THREE.RepeatWrapping),1!==D.repeat[1]&&(s.wrapT=THREE.RepeatWrapping)),D.offset&&s.offset.set(D.offset[0],D.offset[1]),D.wrap&&(M={repeat:THREE.RepeatWrapping,
mirror:THREE.MirroredRepeatWrapping},void 0!==M[D.wrap[0]]&&(s.wrapS=M[D.wrap[0]]),void 0!==M[D.wrap[1]]&&(s.wrapT=M[D.wrap[1]]));z.textures[I]=s}var J,E;for(J in O.materials){I=O.materials[J];for(E in I.parameters)"envMap"===E||"map"===E||"lightMap"===E||"bumpMap"===E?I.parameters[E]=z.textures[I.parameters[E]]:"shading"===E?I.parameters[E]="flat"===I.parameters[E]?THREE.FlatShading:THREE.SmoothShading:"side"===E?I.parameters[E]="double"==I.parameters[E]?THREE.DoubleSide:"back"==I.parameters[E]?
THREE.BackSide:THREE.FrontSide:"blending"===E?I.parameters[E]=I.parameters[E]in THREE?THREE[I.parameters[E]]:THREE.NormalBlending:"combine"===E?I.parameters[E]=I.parameters[E]in THREE?THREE[I.parameters[E]]:THREE.MultiplyOperation:"vertexColors"===E?"face"==I.parameters[E]?I.parameters[E]=THREE.FaceColors:I.parameters[E]&&(I.parameters[E]=THREE.VertexColors):"wrapRGB"===E&&(L=I.parameters[E],I.parameters[E]=new THREE.Vector3(L[0],L[1],L[2]));void 0!==I.parameters.opacity&&1>I.parameters.opacity&&
(I.parameters.transparent=!0);I.parameters.normalMap?(L=THREE.ShaderLib.normalmap,D=THREE.UniformsUtils.clone(L.uniforms),s=I.parameters.color,M=I.parameters.specular,r=I.parameters.ambient,U=I.parameters.shininess,D.tNormal.value=z.textures[I.parameters.normalMap],I.parameters.normalScale&&D.uNormalScale.value.set(I.parameters.normalScale[0],I.parameters.normalScale[1]),I.parameters.map&&(D.tDiffuse.value=I.parameters.map,D.enableDiffuse.value=!0),I.parameters.envMap&&(D.tCube.value=I.parameters.envMap,
D.enableReflection.value=!0,D.uReflectivity.value=I.parameters.reflectivity),I.parameters.lightMap&&(D.tAO.value=I.parameters.lightMap,D.enableAO.value=!0),I.parameters.specularMap&&(D.tSpecular.value=z.textures[I.parameters.specularMap],D.enableSpecular.value=!0),I.parameters.displacementMap&&(D.tDisplacement.value=z.textures[I.parameters.displacementMap],D.enableDisplacement.value=!0,D.uDisplacementBias.value=I.parameters.displacementBias,D.uDisplacementScale.value=I.parameters.displacementScale),
D.uDiffuseColor.value.setHex(s),D.uSpecularColor.value.setHex(M),D.uAmbientColor.value.setHex(r),D.uShininess.value=U,I.parameters.opacity&&(D.uOpacity.value=I.parameters.opacity),t=new THREE.ShaderMaterial({fragmentShader:L.fragmentShader,vertexShader:L.vertexShader,uniforms:D,lights:!0,fog:!0})):t=new THREE[I.type](I.parameters);z.materials[J]=t}for(J in O.materials)if(I=O.materials[J],I.parameters.materials){E=[];for(s=0;s<I.parameters.materials.length;s++)E.push(z.materials[I.parameters.materials[s]]);
z.materials[J].materials=E}e();z.cameras&&O.defaults.camera&&(z.currentCamera=z.cameras[O.defaults.camera]);z.fogs&&O.defaults.fog&&(z.scene.fog=z.fogs[O.defaults.fog]);n.callbackSync(z);m()};THREE.TextureLoader=function(){THREE.EventDispatcher.call(this);this.crossOrigin=null};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a){var b=this,c=new Image;c.addEventListener("load",function(){var a=new THREE.Texture(c);a.needsUpdate=!0;b.dispatchEvent({type:"load",content:a})},!1);c.addEventListener("error",function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);b.crossOrigin&&(c.crossOrigin=b.crossOrigin);c.src=a}};
THREE.Material=function(){THREE.EventDispatcher.call(this);this.id=THREE.MaterialIdCount++;this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.overdraw=!1;this.needsUpdate=this.visible=!0};
THREE.Material.prototype.setValues=function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var d=this[b];d instanceof THREE.Color&&c instanceof THREE.Color?d.copy(c):d instanceof THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):this[b]=c}}};
THREE.Material.prototype.clone=function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;
a.visible=this.visible;return a};THREE.Material.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(a)};
THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var a=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.scale=this.scale;a.dashSize=this.dashSize;a.gapSize=this.gapSize;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=
this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;
a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;
this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.perPixel=this.perPixel;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);
a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshFaceMaterial=function(a){this.materials=a instanceof Array?a:[]};THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))};THREE.ParticleBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ParticleBasicMaterial.prototype.clone=function(){var a=new THREE.ParticleBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.size=this.size;a.sizeAttenuation=this.sizeAttenuation;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.ParticleCanvasMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(){};this.setValues(a)};THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ParticleCanvasMaterial.prototype.clone=function(){var a=new THREE.ParticleCanvasMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.program=this.program;return a};
THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.vertexShader=this.fragmentShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ShaderMaterial.prototype.clone=function(){var a=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,a);a.fragmentShader=this.fragmentShader;a.vertexShader=this.vertexShader;a.uniforms=THREE.UniformsUtils.clone(this.uniforms);a.attributes=this.attributes;a.defines=this.defines;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.fog=this.fog;a.lights=this.lights;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=
this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.SpriteMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=new THREE.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewport=!this.sizeAttenuation;this.alignment=THREE.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1);this.setValues(a);a=a||{};void 0===a.depthTest&&(this.depthTest=!this.useScreenCoordinates);
void 0===a.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates);void 0===a.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.SpriteMaterial.prototype.clone=function(){var a=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.useScreenCoordinates=this.useScreenCoordinates;a.sizeAttenuation=this.sizeAttenuation;a.scaleByViewport=this.scaleByViewport;a.alignment.copy(this.alignment);a.uvOffset.copy(this.uvOffset);a.uvScale.copy(this.uvScale);a.fog=this.fog;return a};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);
THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);
THREE.Texture=function(a,b,c,d,e,f,g,h,l){THREE.EventDispatcher.call(this);this.id=THREE.TextureIdCount++;this.name="";this.image=a;this.mipmaps=[];this.mapping=void 0!==b?b:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==l?l:1;this.format=void 0!==g?g:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;
this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};
THREE.Texture.prototype={constructor:THREE.Texture,clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=
this.unpackAlignment;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.TextureIdCount=0;THREE.CompressedTexture=function(a,b,c,d,e,f,g,h,l,m,n){THREE.Texture.call(this,null,f,g,h,l,m,d,e,n);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var a=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,a);return a};
THREE.DataTexture=function(a,b,c,d,e,f,g,h,l,m,n){THREE.Texture.call(this,null,f,g,h,l,m,d,e,n);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.Particle=function(a){THREE.Object3D.call(this);this.material=a};THREE.Particle.prototype=Object.create(THREE.Object3D.prototype);
THREE.Particle.prototype.clone=function(a){void 0===a&&(a=new THREE.Particle(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.ParticleSystem=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.ParticleBasicMaterial({color:16777215*Math.random()});this.sortParticles=!1;this.geometry&&null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere();this.frustumCulled=!1};THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype);
THREE.ParticleSystem.prototype.clone=function(a){void 0===a&&(a=new THREE.ParticleSystem(this.geometry,this.material));a.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip;this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())};
THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,a);return a};
THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0});void 0!==this.geometry&&(null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4};
THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(a,b){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiplyMatrices(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var c,d=this.children.length;for(c=0;c<d;c++)this.children[c].update(this.skinMatrix,b)};
THREE.SkinnedMesh=function(a,b,c){THREE.Mesh.call(this,a,b);this.useVertexTexture=void 0!==c?c:!0;this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var d,e,f;if(this.geometry&&void 0!==this.geometry.bones){for(a=0;a<this.geometry.bones.length;a++)c=this.geometry.bones[a],d=c.pos,e=c.rotq,f=c.scl,b=this.addBone(),b.name=c.name,b.position.set(d[0],d[1],d[2]),b.quaternion.set(e[0],e[1],e[2],e[3]),b.useQuaternion=!0,void 0!==f?b.scale.set(f[0],f[1],f[2]):b.scale.set(1,1,1);for(a=
0;a<this.bones.length;a++)c=this.geometry.bones[a],b=this.bones[a],-1===c.parent?this.add(b):this.bones[c.parent].add(b);a=this.bones.length;this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=256<a?64:64<a?32:16<a?16:8,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,
this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*a);this.pose()}};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.addBone=function(a){void 0===a&&(a=new THREE.Bone(this));this.bones.push(a);return a};
THREE.SkinnedMesh.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1;a=0;for(var b=this.children.length;a<b;a++){var c=this.children[a];c instanceof THREE.Bone?c.update(this.identityMatrix,!1):c.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];a=0;for(b=this.bones.length;a<
b;a++)c=new THREE.Matrix4,c.getInverse(this.bones[a].skinMatrix),this.boneInverses.push(c)}a=0;for(b=this.bones.length;a<b;a++)THREE.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[a].skinMatrix,this.boneInverses[a]),THREE.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*a);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)};
THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var a=0;a<this.geometry.skinIndices.length;a++){var b=this.geometry.skinWeights[a],c=1/b.lengthManhattan();Infinity!==c?b.multiplyScalar(c):b.set(1)}};THREE.SkinnedMesh.prototype.clone=function(a){void 0===a&&(a=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture));THREE.Mesh.prototype.clone.call(this,a);return a};THREE.SkinnedMesh.offsetMatrix=new THREE.Matrix4;
THREE.MorphAnimMesh=function(a,b){THREE.Mesh.call(this,a,b);this.duration=1E3;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.setFrameRange=function(a,b){this.startKeyframe=a;this.endKeyframe=b;this.length=this.endKeyframe-this.startKeyframe+1};
THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};
THREE.MorphAnimMesh.prototype.parseAnimations=function(){var a=this.geometry;a.animations||(a.animations={});for(var b,c=a.animations,d=/([a-z]+)(\d+)/,e=0,f=a.morphTargets.length;e<f;e++){var g=a.morphTargets[e].name.match(d);if(g&&1<g.length){g=g[1];c[g]||(c[g]={start:Infinity,end:-Infinity});var h=c[g];e<h.start&&(h.start=e);e>h.end&&(h.end=e);b||(b=g)}}a.firstAnimation=b};
THREE.MorphAnimMesh.prototype.setAnimationLabel=function(a,b,c){this.geometry.animations||(this.geometry.animations={});this.geometry.animations[a]={start:b,end:c}};THREE.MorphAnimMesh.prototype.playAnimation=function(a,b){var c=this.geometry.animations[a];c?(this.setFrameRange(c.start,c.end),this.duration=1E3*((c.end-c.start)/b),this.time=0):console.warn("animation["+a+"] undefined")};
THREE.MorphAnimMesh.prototype.updateAnimation=function(a){var b=this.duration/this.length;this.time+=this.direction*a;if(this.mirroredLoop){if(this.time>this.duration||0>this.time)this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}else this.time%=this.duration,0>this.time&&(this.time+=this.duration);a=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/b),0,this.length-1);a!==this.currentKeyframe&&
(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[a]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=a);b=this.time%b/b;this.directionBackwards&&(b=1-b);this.morphTargetInfluences[this.currentKeyframe]=b;this.morphTargetInfluences[this.lastKeyframe]=1-b};
THREE.MorphAnimMesh.prototype.clone=function(a){void 0===a&&(a=new THREE.MorphAnimMesh(this.geometry,this.material));a.duration=this.duration;a.mirroredLoop=this.mirroredLoop;a.time=this.time;a.lastKeyframe=this.lastKeyframe;a.currentKeyframe=this.currentKeyframe;a.direction=this.direction;a.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,a);return a};THREE.Ribbon=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=b};THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype);
THREE.Ribbon.prototype.clone=function(a){void 0===a&&(a=new THREE.Ribbon(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.LOD=function(){THREE.Object3D.call(this);this.LODs=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=0;c<this.LODs.length&&!(b<this.LODs[c].visibleAtDistance);c++);this.LODs.splice(c,0,{visibleAtDistance:b,object3D:a});this.add(a)};
THREE.LOD.prototype.update=function(a){if(1<this.LODs.length){a.matrixWorldInverse.getInverse(a.matrixWorld);a=a.matrixWorldInverse;a=-(a.elements[2]*this.matrixWorld.elements[12]+a.elements[6]*this.matrixWorld.elements[13]+a.elements[10]*this.matrixWorld.elements[14]+a.elements[14]);this.LODs[0].object3D.visible=!0;for(var b=1;b<this.LODs.length;b++)if(a>=this.LODs[b].visibleAtDistance)this.LODs[b-1].object3D.visible=!1,this.LODs[b].object3D.visible=!0;else break;for(;b<this.LODs.length;b++)this.LODs[b].object3D.visible=
!1}};THREE.LOD.prototype.clone=function(){};THREE.Sprite=function(a){THREE.Object3D.call(this);this.material=void 0!==a?a:new THREE.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);
THREE.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position);this.rotation3d.set(0,0,this.rotation);this.matrix.setRotationFromEuler(this.rotation3d);(1!==this.scale.x||1!==this.scale.y)&&this.matrix.scale(this.scale);this.matrixWorldNeedsUpdate=!0};THREE.Sprite.prototype.clone=function(a){void 0===a&&(a=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};
THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)&&-1===this.__objects.indexOf(a)){this.__objects.push(a);this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1)}else a instanceof THREE.Camera||(b=this.__objects.indexOf(a),-1!==b&&(this.__objects.splice(b,1),this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1)));for(b=0;b<a.children.length;b++)this.__removeObject(a.children[b])};
THREE.Fog=function(a,b,c){this.name="";this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(a,b){this.name="";this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};
THREE.CanvasRenderer=function(a){function b(a){C!==a&&(C=w.globalAlpha=a)}function c(a){z!==a&&(a===THREE.NormalBlending?w.globalCompositeOperation="source-over":a===THREE.AdditiveBlending?w.globalCompositeOperation="lighter":a===THREE.SubtractiveBlending&&(w.globalCompositeOperation="darker"),z=a)}function d(a){L!==a&&(L=w.lineWidth=a)}function e(a){U!==a&&(U=w.lineCap=a)}function f(a){D!==a&&(D=w.lineJoin=a)}function g(a){N!==a&&(N=w.strokeStyle=a)}function h(a){O!==a&&(O=w.fillStyle=a)}function l(a,
b){if(M!==a||I!==b)w.setLineDash([a,b]),M=a,I=b}console.log("THREE.CanvasRenderer",THREE.REVISION);var m=THREE.Math.smoothstep;a=a||{};var n=this,q,p,t,u=new THREE.Projector,r=void 0!==a.canvas?a.canvas:document.createElement("canvas"),s,A,v,B,w=r.getContext("2d"),F=new THREE.Color(0),K=0,C=1,z=0,N=null,O=null,L=null,U=null,D=null,M=null,I=0,J,E,Y,ia,Ra=new THREE.RenderableVertex,Sa=new THREE.RenderableVertex,Q,ba,ua,fa,qa,P,j,ya,Jb,mb,za,Aa,ga=new THREE.Color,wa=new THREE.Color,ca=new THREE.Color,
da=new THREE.Color,ta=new THREE.Color,na=new THREE.Color,Ba=new THREE.Color,wb=new THREE.Color,xb={},la={},fb,gb,Ya,Ea,Eb,kb,Kb,Lb,bb,rb,nb=new THREE.Box2,ra=new THREE.Box2,Fa=new THREE.Box2,cc=!1,xa=new THREE.Color,hb=new THREE.Color,Pa=new THREE.Color,Ta=new THREE.Vector3,sb,k,Mb,Za,ob,yb,Yb=16;sb=document.createElement("canvas");sb.width=sb.height=2;k=sb.getContext("2d");k.fillStyle="rgba(0,0,0,1)";k.fillRect(0,0,2,2);Mb=k.getImageData(0,0,2,2);Za=Mb.data;ob=document.createElement("canvas");ob.width=
ob.height=Yb;yb=ob.getContext("2d");yb.translate(-Yb/2,-Yb/2);yb.scale(Yb,Yb);Yb--;void 0===w.setLineDash&&(w.setLineDash=void 0!==w.mozDash?function(a){w.mozDash=null!==a[0]?a:null}:function(){});this.domElement=r;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};
this.setSize=function(a,b){s=a*this.devicePixelRatio;A=b*this.devicePixelRatio;v=Math.floor(s/2);B=Math.floor(A/2);r.width=s;r.height=A;r.style.width=a+"px";r.style.height=b+"px";nb.set(new THREE.Vector2(-v,-B),new THREE.Vector2(v,B));ra.set(new THREE.Vector2(-v,-B),new THREE.Vector2(v,B));C=1;z=0;D=U=L=O=N=null};this.setClearColor=function(a,b){F.copy(a);K=void 0!==b?b:1;ra.set(new THREE.Vector2(-v,-B),new THREE.Vector2(v,B))};this.setClearColorHex=function(a,b){F.setHex(a);K=void 0!==b?b:1;ra.set(new THREE.Vector2(-v,
-B),new THREE.Vector2(v,B))};this.getMaxAnisotropy=function(){return 0};this.clear=function(){w.setTransform(1,0,0,-1,v,B);!1===ra.empty()&&(ra.intersect(nb),ra.expandByScalar(2),1>K&&w.clearRect(ra.min.x|0,ra.min.y|0,ra.max.x-ra.min.x|0,ra.max.y-ra.min.y|0),0<K&&(c(THREE.NormalBlending),b(1),h("rgba("+Math.floor(255*F.r)+","+Math.floor(255*F.g)+","+Math.floor(255*F.b)+","+K+")"),w.fillRect(ra.min.x|0,ra.min.y|0,ra.max.x-ra.min.x|0,ra.max.y-ra.min.y|0)),ra.makeEmpty())};this.render=function(a,r){function s(a,
b,c){for(var d=0,e=t.length;d<e;d++){var f=t[d];wb.copy(f.color);if(f instanceof THREE.DirectionalLight){var g=Ta.getPositionFromMatrix(f.matrixWorld).normalize(),k=b.dot(g);0>=k||(k*=f.intensity,c.add(wb.multiplyScalar(k)))}else f instanceof THREE.PointLight&&(g=Ta.getPositionFromMatrix(f.matrixWorld),k=b.dot(Ta.subVectors(g,a).normalize()),0>=k||(k*=0==f.distance?1:1-Math.min(a.distanceTo(g)/f.distance,1),0!=k&&(k*=f.intensity,c.add(wb.multiplyScalar(k)))))}}function A(a,d,e,f,g,k,h,j){n.info.render.vertices+=
3;n.info.render.faces++;b(j.opacity);c(j.blending);Q=a.positionScreen.x;ba=a.positionScreen.y;ua=d.positionScreen.x;fa=d.positionScreen.y;qa=e.positionScreen.x;P=e.positionScreen.y;z(Q,ba,ua,fa,qa,P);(j instanceof THREE.MeshLambertMaterial||j instanceof THREE.MeshPhongMaterial)&&null===j.map?(na.copy(j.color),Ba.copy(j.emissive),j.vertexColors===THREE.FaceColors&&na.multiply(h.color),!0===cc?!1===j.wireframe&&j.shading==THREE.SmoothShading&&3==h.vertexNormalsLength?(wa.copy(xa),ca.copy(xa),da.copy(xa),
s(h.v1.positionWorld,h.vertexNormalsModel[0],wa),s(h.v2.positionWorld,h.vertexNormalsModel[1],ca),s(h.v3.positionWorld,h.vertexNormalsModel[2],da),wa.multiply(na).add(Ba),ca.multiply(na).add(Ba),da.multiply(na).add(Ba),ta.addColors(ca,da).multiplyScalar(0.5),Ya=N(wa,ca,da,ta),K(Q,ba,ua,fa,qa,P,0,0,1,0,0,1,Ya)):(ga.copy(xa),s(h.centroidModel,h.normalModel,ga),ga.multiply(na).add(Ba),!0===j.wireframe?D(ga,j.wireframeLinewidth,j.wireframeLinecap,j.wireframeLinejoin):F(ga)):!0===j.wireframe?D(j.color,
j.wireframeLinewidth,j.wireframeLinecap,j.wireframeLinejoin):F(j.color)):j instanceof THREE.MeshBasicMaterial||j instanceof THREE.MeshLambertMaterial||j instanceof THREE.MeshPhongMaterial?null!==j.map?j.map.mapping instanceof THREE.UVMapping&&(Ea=h.uvs[0],I(Q,ba,ua,fa,qa,P,Ea[f].x,Ea[f].y,Ea[g].x,Ea[g].y,Ea[k].x,Ea[k].y,j.map)):null!==j.envMap?j.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(Ta.copy(h.vertexNormalsModelView[f]),Eb=0.5*Ta.x+0.5,kb=0.5*Ta.y+0.5,Ta.copy(h.vertexNormalsModelView[g]),
Kb=0.5*Ta.x+0.5,Lb=0.5*Ta.y+0.5,Ta.copy(h.vertexNormalsModelView[k]),bb=0.5*Ta.x+0.5,rb=0.5*Ta.y+0.5,I(Q,ba,ua,fa,qa,P,Eb,kb,Kb,Lb,bb,rb,j.envMap)):(ga.copy(j.color),j.vertexColors===THREE.FaceColors&&ga.multiply(h.color),!0===j.wireframe?D(ga,j.wireframeLinewidth,j.wireframeLinecap,j.wireframeLinejoin):F(ga)):j instanceof THREE.MeshDepthMaterial?(fb=r.near,gb=r.far,wa.r=wa.g=wa.b=1-m(a.positionScreen.z*a.positionScreen.w,fb,gb),ca.r=ca.g=ca.b=1-m(d.positionScreen.z*d.positionScreen.w,fb,gb),da.r=
da.g=da.b=1-m(e.positionScreen.z*e.positionScreen.w,fb,gb),ta.addColors(ca,da).multiplyScalar(0.5),Ya=N(wa,ca,da,ta),K(Q,ba,ua,fa,qa,P,0,0,1,0,0,1,Ya)):j instanceof THREE.MeshNormalMaterial&&(j.shading==THREE.FlatShading?(a=h.normalModelView,ga.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),!0===j.wireframe?D(ga,j.wireframeLinewidth,j.wireframeLinecap,j.wireframeLinejoin):F(ga)):j.shading==THREE.SmoothShading&&(a=h.vertexNormalsModelView[f],wa.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),
a=h.vertexNormalsModelView[g],ca.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),a=h.vertexNormalsModelView[k],da.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),ta.addColors(ca,da).multiplyScalar(0.5),Ya=N(wa,ca,da,ta),K(Q,ba,ua,fa,qa,P,0,0,1,0,0,1,Ya)))}function z(a,b,c,d,e,f){w.beginPath();w.moveTo(a,b);w.lineTo(c,d);w.lineTo(e,f);w.closePath()}function C(a,b,c,d,e,f,g,k){w.beginPath();w.moveTo(a,b);w.lineTo(c,d);w.lineTo(e,f);w.lineTo(g,k);w.closePath()}function D(a,b,c,k){d(b);
e(c);f(k);g(a.getStyle());w.stroke();Fa.expandByScalar(2*b)}function F(a){h(a.getStyle());w.fill()}function I(a,b,c,d,e,f,g,k,j,l,H,m,n){if(!(n instanceof THREE.DataTexture||void 0===n.image||0==n.image.width)){if(!0===n.needsUpdate){var p=n.wrapS==THREE.RepeatWrapping,q=n.wrapT==THREE.RepeatWrapping;xb[n.id]=w.createPattern(n.image,!0===p&&!0===q?"repeat":!0===p&&!1===q?"repeat-x":!1===p&&!0===q?"repeat-y":"no-repeat");n.needsUpdate=!1}void 0===xb[n.id]?h("rgba(0,0,0,1)"):h(xb[n.id]);var p=n.offset.x/
n.repeat.x,q=n.offset.y/n.repeat.y,r=n.image.width*n.repeat.x,pb=n.image.height*n.repeat.y;g=(g+p)*r;k=(1-k+q)*pb;c-=a;d-=b;e-=a;f-=b;j=(j+p)*r-g;l=(1-l+q)*pb-k;H=(H+p)*r-g;m=(1-m+q)*pb-k;p=j*m-H*l;0===p?(void 0===la[n.id]&&(b=document.createElement("canvas"),b.width=n.image.width,b.height=n.image.height,b=b.getContext("2d"),b.drawImage(n.image,0,0),la[n.id]=b.getImageData(0,0,n.image.width,n.image.height).data),b=la[n.id],g=4*(Math.floor(g)+Math.floor(k)*n.image.width),ga.setRGB(b[g]/255,b[g+1]/
255,b[g+2]/255),F(ga)):(p=1/p,n=(m*c-l*e)*p,l=(m*d-l*f)*p,c=(j*e-H*c)*p,d=(j*f-H*d)*p,a=a-n*g-c*k,g=b-l*g-d*k,w.save(),w.transform(n,l,c,d,a,g),w.fill(),w.restore())}}function K(a,b,c,d,e,f,g,k,h,j,l,H,m){var n,p;n=m.width-1;p=m.height-1;g*=n;k*=p;c-=a;d-=b;e-=a;f-=b;h=h*n-g;j=j*p-k;l=l*n-g;H=H*p-k;p=1/(h*H-l*j);n=(H*c-j*e)*p;j=(H*d-j*f)*p;c=(h*e-l*c)*p;d=(h*f-l*d)*p;a=a-n*g-c*k;b=b-j*g-d*k;w.save();w.transform(n,j,c,d,a,b);w.clip();w.drawImage(m,0,0);w.restore()}function N(a,b,c,d){Za[0]=255*a.r|
0;Za[1]=255*a.g|0;Za[2]=255*a.b|0;Za[4]=255*b.r|0;Za[5]=255*b.g|0;Za[6]=255*b.b|0;Za[8]=255*c.r|0;Za[9]=255*c.g|0;Za[10]=255*c.b|0;Za[12]=255*d.r|0;Za[13]=255*d.g|0;Za[14]=255*d.b|0;k.putImageData(Mb,0,0);yb.drawImage(sb,0,0);return ob}function L(a,b){var c=b.x-a.x,d=b.y-a.y,e=c*c+d*d;0!==e&&(e=1/Math.sqrt(e),c*=e,d*=e,b.x+=c,b.y+=d,a.x-=c,a.y-=d)}if(!1===r instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear();
w.setTransform(1,0,0,-1,v,B);n.info.render.vertices=0;n.info.render.faces=0;q=u.projectScene(a,r,this.sortObjects,this.sortElements);p=q.elements;t=q.lights;cc=0<t.length;if(!0===cc){xa.setRGB(0,0,0);hb.setRGB(0,0,0);Pa.setRGB(0,0,0);for(var O=0,U=t.length;O<U;O++){var R=t[O],M=R.color;R instanceof THREE.AmbientLight?xa.add(M):R instanceof THREE.DirectionalLight?hb.add(M):R instanceof THREE.PointLight&&Pa.add(M)}}O=0;for(U=p.length;O<U;O++){var ma=p[O],R=ma.material;if(!(void 0===R||!1===R.visible)){Fa.makeEmpty();
if(ma instanceof THREE.RenderableParticle){J=ma;J.x*=v;J.y*=B;var M=J,H=ma;b(R.opacity);c(R.blending);var Ua=void 0,pb=void 0,La=void 0,zb=void 0,Pc=ma=void 0,cd=void 0;R instanceof THREE.ParticleBasicMaterial?null===R.map?(La=H.object.scale.x,zb=H.object.scale.y,La*=H.scale.x*v,zb*=H.scale.y*B,Fa.min.set(M.x-La,M.y-zb),Fa.max.set(M.x+La,M.y+zb),!1!==nb.isIntersectionBox(Fa)&&(h(R.color.getStyle()),w.save(),w.translate(M.x,M.y),w.rotate(-H.rotation),w.scale(La,zb),w.fillRect(-1,-1,2,2),w.restore())):
(ma=R.map.image,Pc=ma.width>>1,cd=ma.height>>1,La=H.scale.x*v,zb=H.scale.y*B,Ua=La*Pc,pb=zb*cd,Fa.min.set(M.x-Ua,M.y-pb),Fa.max.set(M.x+Ua,M.y+pb),!1!==nb.isIntersectionBox(Fa)&&(w.save(),w.translate(M.x,M.y),w.rotate(-H.rotation),w.scale(La,-zb),w.translate(-Pc,-cd),w.drawImage(ma,0,0),w.restore())):R instanceof THREE.ParticleCanvasMaterial&&(Ua=H.scale.x*v,pb=H.scale.y*B,Fa.min.set(M.x-Ua,M.y-pb),Fa.max.set(M.x+Ua,M.y+pb),!1!==nb.isIntersectionBox(Fa)&&(g(R.color.getStyle()),h(R.color.getStyle()),
w.save(),w.translate(M.x,M.y),w.rotate(-H.rotation),w.scale(Ua,pb),R.program(w),w.restore()))}else if(ma instanceof THREE.RenderableLine)J=ma.v1,E=ma.v2,J.positionScreen.x*=v,J.positionScreen.y*=B,E.positionScreen.x*=v,E.positionScreen.y*=B,Fa.setFromPoints([J.positionScreen,E.positionScreen]),!0===nb.isIntersectionBox(Fa)&&(M=J,H=E,b(R.opacity),c(R.blending),w.beginPath(),w.moveTo(M.positionScreen.x,M.positionScreen.y),w.lineTo(H.positionScreen.x,H.positionScreen.y),R instanceof THREE.LineBasicMaterial?
(d(R.linewidth),e(R.linecap),f(R.linejoin),g(R.color.getStyle()),l(null,null),w.stroke(),Fa.expandByScalar(2*R.linewidth)):R instanceof THREE.LineDashedMaterial&&(d(R.linewidth),e(R.linecap),f(R.linejoin),g(R.color.getStyle()),l(R.dashSize,R.gapSize),w.stroke(),Fa.expandByScalar(2*R.linewidth)));else if(ma instanceof THREE.RenderableFace3){J=ma.v1;E=ma.v2;Y=ma.v3;if(-1>J.positionScreen.z||1<J.positionScreen.z)continue;if(-1>E.positionScreen.z||1<E.positionScreen.z)continue;if(-1>Y.positionScreen.z||
1<Y.positionScreen.z)continue;J.positionScreen.x*=v;J.positionScreen.y*=B;E.positionScreen.x*=v;E.positionScreen.y*=B;Y.positionScreen.x*=v;Y.positionScreen.y*=B;!0===R.overdraw&&(L(J.positionScreen,E.positionScreen),L(E.positionScreen,Y.positionScreen),L(Y.positionScreen,J.positionScreen));Fa.setFromPoints([J.positionScreen,E.positionScreen,Y.positionScreen]);A(J,E,Y,0,1,2,ma,R)}else if(ma instanceof THREE.RenderableFace4){J=ma.v1;E=ma.v2;Y=ma.v3;ia=ma.v4;if(-1>J.positionScreen.z||1<J.positionScreen.z)continue;
if(-1>E.positionScreen.z||1<E.positionScreen.z)continue;if(-1>Y.positionScreen.z||1<Y.positionScreen.z)continue;if(-1>ia.positionScreen.z||1<ia.positionScreen.z)continue;J.positionScreen.x*=v;J.positionScreen.y*=B;E.positionScreen.x*=v;E.positionScreen.y*=B;Y.positionScreen.x*=v;Y.positionScreen.y*=B;ia.positionScreen.x*=v;ia.positionScreen.y*=B;Ra.positionScreen.copy(E.positionScreen);Sa.positionScreen.copy(ia.positionScreen);!0===R.overdraw&&(L(J.positionScreen,E.positionScreen),L(E.positionScreen,
ia.positionScreen),L(ia.positionScreen,J.positionScreen),L(Y.positionScreen,Ra.positionScreen),L(Y.positionScreen,Sa.positionScreen));Fa.setFromPoints([J.positionScreen,E.positionScreen,Y.positionScreen,ia.positionScreen]);M=J;H=E;Ua=Y;pb=ia;La=Ra;zb=Sa;n.info.render.vertices+=4;n.info.render.faces++;b(R.opacity);c(R.blending);void 0!==R.map&&null!==R.map||void 0!==R.envMap&&null!==R.envMap?(A(M,H,pb,0,1,3,ma,R),A(La,Ua,zb,1,2,3,ma,R)):(Q=M.positionScreen.x,ba=M.positionScreen.y,ua=H.positionScreen.x,
fa=H.positionScreen.y,qa=Ua.positionScreen.x,P=Ua.positionScreen.y,j=pb.positionScreen.x,ya=pb.positionScreen.y,Jb=La.positionScreen.x,mb=La.positionScreen.y,za=zb.positionScreen.x,Aa=zb.positionScreen.y,R instanceof THREE.MeshLambertMaterial||R instanceof THREE.MeshPhongMaterial?(na.copy(R.color),Ba.copy(R.emissive),R.vertexColors===THREE.FaceColors&&na.multiply(ma.color),!0===cc?!1===R.wireframe&&R.shading==THREE.SmoothShading&&4==ma.vertexNormalsLength?(wa.copy(xa),ca.copy(xa),da.copy(xa),ta.copy(xa),
s(ma.v1.positionWorld,ma.vertexNormalsModel[0],wa),s(ma.v2.positionWorld,ma.vertexNormalsModel[1],ca),s(ma.v4.positionWorld,ma.vertexNormalsModel[3],da),s(ma.v3.positionWorld,ma.vertexNormalsModel[2],ta),wa.multiply(na).add(Ba),ca.multiply(na).add(Ba),da.multiply(na).add(Ba),ta.multiply(na).add(Ba),Ya=N(wa,ca,da,ta),z(Q,ba,ua,fa,j,ya),K(Q,ba,ua,fa,j,ya,0,0,1,0,0,1,Ya),z(Jb,mb,qa,P,za,Aa),K(Jb,mb,qa,P,za,Aa,1,0,1,1,0,1,Ya)):(ga.copy(xa),s(ma.centroidModel,ma.normalModel,ga),ga.multiply(na).add(Ba),
C(Q,ba,ua,fa,qa,P,j,ya),!0===R.wireframe?D(ga,R.wireframeLinewidth,R.wireframeLinecap,R.wireframeLinejoin):F(ga)):(ga.addColors(na,Ba),C(Q,ba,ua,fa,qa,P,j,ya),!0===R.wireframe?D(ga,R.wireframeLinewidth,R.wireframeLinecap,R.wireframeLinejoin):F(ga))):R instanceof THREE.MeshBasicMaterial?(ga.copy(R.color),R.vertexColors===THREE.FaceColors&&ga.multiply(ma.color),C(Q,ba,ua,fa,qa,P,j,ya),!0===R.wireframe?D(ga,R.wireframeLinewidth,R.wireframeLinecap,R.wireframeLinejoin):F(ga)):R instanceof THREE.MeshNormalMaterial?
(M=void 0,R.shading==THREE.FlatShading?(M=ma.normalModelView,ga.setRGB(M.x,M.y,M.z).multiplyScalar(0.5).addScalar(0.5),C(Q,ba,ua,fa,qa,P,j,ya),!0===R.wireframe?D(ga,R.wireframeLinewidth,R.wireframeLinecap,R.wireframeLinejoin):F(ga)):R.shading==THREE.SmoothShading&&(M=ma.vertexNormalsModelView[0],wa.setRGB(M.x,M.y,M.z).multiplyScalar(0.5).addScalar(0.5),M=ma.vertexNormalsModelView[1],ca.setRGB(M.x,M.y,M.z).multiplyScalar(0.5).addScalar(0.5),M=ma.vertexNormalsModelView[3],da.setRGB(M.x,M.y,M.z).multiplyScalar(0.5).addScalar(0.5),
M=ma.vertexNormalsModelView[2],ta.setRGB(M.x,M.y,M.z).multiplyScalar(0.5).addScalar(0.5),Ya=N(wa,ca,da,ta),z(Q,ba,ua,fa,j,ya),K(Q,ba,ua,fa,j,ya,0,0,1,0,0,1,Ya),z(Jb,mb,qa,P,za,Aa),K(Jb,mb,qa,P,za,Aa,1,0,1,1,0,1,Ya))):R instanceof THREE.MeshDepthMaterial&&(fb=r.near,gb=r.far,wa.r=wa.g=wa.b=1-m(M.positionScreen.z*M.positionScreen.w,fb,gb),ca.r=ca.g=ca.b=1-m(H.positionScreen.z*H.positionScreen.w,fb,gb),da.r=da.g=da.b=1-m(pb.positionScreen.z*pb.positionScreen.w,fb,gb),ta.r=ta.g=ta.b=1-m(Ua.positionScreen.z*
Ua.positionScreen.w,fb,gb),Ya=N(wa,ca,da,ta),z(Q,ba,ua,fa,j,ya),K(Q,ba,ua,fa,j,ya,0,0,1,0,0,1,Ya),z(Jb,mb,qa,P,za,Aa),K(Jb,mb,qa,P,za,Aa,1,0,1,1,0,1,Ya)))}ra.union(Fa)}}w.setTransform(1,0,0,1,0,0)}}};
THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",
envmap_fragment:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",
envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",
envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",
lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",
lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",
lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",
lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -viewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",
skinbase_vertex:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",
default_vertex:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",
skinnormal_vertex:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",defaultnormal_vertex:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( depthKernel[0][0] < shadowCoord.z ) shadowKernel[0][0] = 0.25;\nelse shadowKernel[0][0] = 0.0;\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( depthKernel[0][1] < shadowCoord.z ) shadowKernel[0][1] = 0.25;\nelse shadowKernel[0][1] = 0.0;\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( depthKernel[0][2] < shadowCoord.z ) shadowKernel[0][2] = 0.25;\nelse shadowKernel[0][2] = 0.0;\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( depthKernel[1][0] < shadowCoord.z ) shadowKernel[1][0] = 0.25;\nelse shadowKernel[1][0] = 0.0;\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( depthKernel[1][1] < shadowCoord.z ) shadowKernel[1][1] = 0.25;\nelse shadowKernel[1][1] = 0.0;\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( depthKernel[1][2] < shadowCoord.z ) shadowKernel[1][2] = 0.25;\nelse shadowKernel[1][2] = 0.0;\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( depthKernel[2][0] < shadowCoord.z ) shadowKernel[2][0] = 0.25;\nelse shadowKernel[2][0] = 0.0;\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( depthKernel[2][1] < shadowCoord.z ) shadowKernel[2][1] = 0.25;\nelse shadowKernel[2][1] = 0.0;\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( depthKernel[2][2] < shadowCoord.z ) shadowKernel[2][2] = 0.25;\nelse shadowKernel[2][2] = 0.0;\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};
THREE.UniformsUtils={merge:function(a){var b,c,d,e={};for(b=0;b<a.length;b++)for(c in d=this.clone(a[b]),d)e[c]=d[c];return e},clone:function(a){var b,c,d,e={};for(b in a)for(c in e[b]={},a[b])d=a[b][c],e[b][c]=d instanceof THREE.Color||d instanceof THREE.Vector2||d instanceof THREE.Vector3||d instanceof THREE.Vector4||d instanceof THREE.Matrix4||d instanceof THREE.Texture?d.clone():d instanceof Array?d.slice():d;return e}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",
value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",
value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",
value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,
THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,
THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",
THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,
THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,
THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,
THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",
value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,
"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,
THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,
THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,
THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",
THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",
value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:"varying vec3 vNormal;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalize( normalMatrix * normal );\ngl_Position = projectionMatrix * mvPosition;\n}",
fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},
tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},
uRefractionRatio:{type:"f",value:0.98},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",
THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},
cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},
depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};
THREE.WebGLRenderer=function(a){function b(a){if(a.__webglCustomAttributesList)for(var b in a.__webglCustomAttributesList)k.deleteBuffer(a.__webglCustomAttributesList[b].buffer)}function c(a,b){var c=a.vertices.length,d=b.material;if(d.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var e in d.attributes){var f=d.attributes[e];if(!f.__webglInitialized||f.createUniqueBuffers){f.__webglInitialized=!0;var g=1;"v2"===f.type?g=2:"v3"===f.type?g=3:"v4"===f.type?
g=4:"c"===f.type&&(g=3);f.size=g;f.array=new Float32Array(c*g);f.buffer=k.createBuffer();f.buffer.belongsToAttribute=e;f.needsUpdate=!0}a.__webglCustomAttributesList.push(f)}}}function d(a,b){var c=b.geometry,d=a.faces3,h=a.faces4,j=3*d.length+4*h.length,l=1*d.length+2*h.length,h=3*d.length+4*h.length,d=e(b,a),m=g(d),n=f(d),p=d.vertexColors?d.vertexColors:!1;a.__vertexArray=new Float32Array(3*j);n&&(a.__normalArray=new Float32Array(3*j));c.hasTangents&&(a.__tangentArray=new Float32Array(4*j));p&&
(a.__colorArray=new Float32Array(3*j));if(m){if(0<c.faceUvs.length||0<c.faceVertexUvs.length)a.__uvArray=new Float32Array(2*j);if(1<c.faceUvs.length||1<c.faceVertexUvs.length)a.__uv2Array=new Float32Array(2*j)}b.geometry.skinWeights.length&&b.geometry.skinIndices.length&&(a.__skinIndexArray=new Float32Array(4*j),a.__skinWeightArray=new Float32Array(4*j));a.__faceArray=new Uint16Array(3*l);a.__lineArray=new Uint16Array(2*h);if(a.numMorphTargets){a.__morphTargetsArrays=[];c=0;for(m=a.numMorphTargets;c<
m;c++)a.__morphTargetsArrays.push(new Float32Array(3*j))}if(a.numMorphNormals){a.__morphNormalsArrays=[];c=0;for(m=a.numMorphNormals;c<m;c++)a.__morphNormalsArrays.push(new Float32Array(3*j))}a.__webglFaceCount=3*l;a.__webglLineCount=2*h;if(d.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var q in d.attributes){var l=d.attributes[q],c={},r;for(r in l)c[r]=l[r];if(!c.__webglInitialized||c.createUniqueBuffers)c.__webglInitialized=!0,h=1,"v2"===c.type?h=2:
"v3"===c.type?h=3:"v4"===c.type?h=4:"c"===c.type&&(h=3),c.size=h,c.array=new Float32Array(j*h),c.buffer=k.createBuffer(),c.buffer.belongsToAttribute=q,l.needsUpdate=!0,c.__original=l;a.__webglCustomAttributesList.push(c)}}a.__inittedArrays=!0}function e(a,b){return a.material instanceof THREE.MeshFaceMaterial?a.material.materials[b.materialIndex]:a.material}function f(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==a.shading&&a.shading===
THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function g(a){return a.map||a.lightMap||a.bumpMap||a.normalMap||a.specularMap||a instanceof THREE.ShaderMaterial?!0:!1}function h(a){var b,c,d;for(b in a.attributes)d="index"===b?k.ELEMENT_ARRAY_BUFFER:k.ARRAY_BUFFER,c=a.attributes[b],c.buffer=k.createBuffer(),k.bindBuffer(d,c.buffer),k.bufferData(d,c.array,k.STATIC_DRAW)}function l(a,b,c){var d=a.attributes,e=d.index,f=d.position,g=d.normal,h=d.uv,j=d.color,d=d.tangent;a.elementsNeedUpdate&&
void 0!==e&&(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,e.buffer),k.bufferData(k.ELEMENT_ARRAY_BUFFER,e.array,b));a.verticesNeedUpdate&&void 0!==f&&(k.bindBuffer(k.ARRAY_BUFFER,f.buffer),k.bufferData(k.ARRAY_BUFFER,f.array,b));a.normalsNeedUpdate&&void 0!==g&&(k.bindBuffer(k.ARRAY_BUFFER,g.buffer),k.bufferData(k.ARRAY_BUFFER,g.array,b));a.uvsNeedUpdate&&void 0!==h&&(k.bindBuffer(k.ARRAY_BUFFER,h.buffer),k.bufferData(k.ARRAY_BUFFER,h.array,b));a.colorsNeedUpdate&&void 0!==j&&(k.bindBuffer(k.ARRAY_BUFFER,
j.buffer),k.bufferData(k.ARRAY_BUFFER,j.array,b));a.tangentsNeedUpdate&&void 0!==d&&(k.bindBuffer(k.ARRAY_BUFFER,d.buffer),k.bufferData(k.ARRAY_BUFFER,d.array,b));if(c)for(var l in a.attributes)delete a.attributes[l].array}function m(a){ra[a]||(k.enableVertexAttribArray(a),ra[a]=!0)}function n(){for(var a in ra)ra[a]&&(k.disableVertexAttribArray(a),ra[a]=!1)}function q(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}function p(a,b){return b[0]-a[0]}function t(a,b,c){if(a.length)for(var d=0,e=a.length;d<e;d++)ga=
Jb=null,za=Aa=ta=da=fb=la=na=-1,Ta=!0,a[d].render(b,c,rb,nb),ga=Jb=null,za=Aa=ta=da=fb=la=na=-1,Ta=!0}function u(a,b,c,d,e,f,g,k){var h,j,l,m;b?(j=a.length-1,m=b=-1):(j=0,b=a.length,m=1);for(var n=j;n!==b;n+=m)if(h=a[n],h.render){j=h.object;l=h.buffer;if(k)h=k;else{h=h[c];if(!h)continue;g&&P.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst);P.setDepthTest(h.depthTest);P.setDepthWrite(h.depthWrite);L(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}P.setMaterialFaces(h);l instanceof
THREE.BufferGeometry?P.renderBufferDirect(d,e,f,h,l,j):P.renderBuffer(d,e,f,h,l,j)}}function r(a,b,c,d,e,f,g){for(var h,k,j=0,l=a.length;j<l;j++)if(h=a[j],k=h.object,k.visible){if(g)h=g;else{h=h[b];if(!h)continue;f&&P.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst);P.setDepthTest(h.depthTest);P.setDepthWrite(h.depthWrite);L(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}P.renderImmediateObject(c,d,e,h,k)}}function s(a,b,c){a.push({buffer:b,object:c,opaque:null,transparent:null})}
function A(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function v(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function B(a,b){for(var c=a.length-1;0<=c;c--)a[c].object===b&&a.splice(c,1)}function w(a,b){for(var c=a.length-1;0<=c;c--)a[c]===b&&a.splice(c,1)}function F(a,b,c,d,e){ca=0;d.needsUpdate&&(d.program&&ma(d),P.initMaterial(d,b,c,e),d.needsUpdate=!1);d.morphTargets&&!e.__webglMorphTargetInfluences&&(e.__webglMorphTargetInfluences=new Float32Array(P.maxMorphTargets));
var f=!1,g=d.program,h=g.uniforms,j=d.uniforms;g!==Jb&&(k.useProgram(g),Jb=g,f=!0);d.id!==za&&(za=d.id,f=!0);if(f||a!==ga)k.uniformMatrix4fv(h.projectionMatrix,!1,a.projectionMatrix.elements),a!==ga&&(ga=a);if(d.skinning)if(Oc&&e.useVertexTexture){if(null!==h.boneTexture){var l=K();k.uniform1i(h.boneTexture,l);P.setTexture(e.boneTexture,l)}}else null!==h.boneGlobalMatrices&&k.uniformMatrix4fv(h.boneGlobalMatrices,!1,e.boneMatrices);if(f){c&&d.fog&&(j.fogColor.value=c.color,c instanceof THREE.Fog?
(j.fogNear.value=c.near,j.fogFar.value=c.far):c instanceof THREE.FogExp2&&(j.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(Ta){var m,n=l=0,p=0,q,r,s,t=sb,u=t.directional.colors,v=t.directional.positions,w=t.point.colors,A=t.point.positions,B=t.point.distances,C=t.spot.colors,F=t.spot.positions,D=t.spot.distances,I=t.spot.directions,L=t.spot.anglesCos,O=t.spot.exponents,J=t.hemi.skyColors,Q=t.hemi.groundColors,R=t.hemi.positions,
U=0,ba=0,da=0,Aa=0,ia=0,wa=0,fa=0,na=0,T=0;c=s=T=0;for(f=b.length;c<f;c++)m=b[c],m.onlyShadow||(q=m.color,r=m.intensity,s=m.distance,m instanceof THREE.AmbientLight?m.visible&&(P.gammaInput?(l+=q.r*q.r,n+=q.g*q.g,p+=q.b*q.b):(l+=q.r,n+=q.g,p+=q.b)):m instanceof THREE.DirectionalLight?(ia+=1,m.visible&&(Pa.getPositionFromMatrix(m.matrixWorld),hb.getPositionFromMatrix(m.target.matrixWorld),Pa.sub(hb),Pa.normalize(),0===Pa.x&&0===Pa.y&&0===Pa.z||(m=3*U,v[m]=Pa.x,v[m+1]=Pa.y,v[m+2]=Pa.z,P.gammaInput?
z(u,m,q,r*r):N(u,m,q,r),U+=1))):m instanceof THREE.PointLight?(wa+=1,m.visible&&(T=3*ba,P.gammaInput?z(w,T,q,r*r):N(w,T,q,r),hb.getPositionFromMatrix(m.matrixWorld),A[T]=hb.x,A[T+1]=hb.y,A[T+2]=hb.z,B[ba]=s,ba+=1)):m instanceof THREE.SpotLight?(fa+=1,m.visible&&(T=3*da,P.gammaInput?z(C,T,q,r*r):N(C,T,q,r),hb.getPositionFromMatrix(m.matrixWorld),F[T]=hb.x,F[T+1]=hb.y,F[T+2]=hb.z,D[da]=s,Pa.copy(hb),hb.getPositionFromMatrix(m.target.matrixWorld),Pa.sub(hb),Pa.normalize(),I[T]=Pa.x,I[T+1]=Pa.y,I[T+2]=
Pa.z,L[da]=Math.cos(m.angle),O[da]=m.exponent,da+=1)):m instanceof THREE.HemisphereLight&&(na+=1,m.visible&&(Pa.getPositionFromMatrix(m.matrixWorld),Pa.normalize(),0===Pa.x&&0===Pa.y&&0===Pa.z||(s=3*Aa,R[s]=Pa.x,R[s+1]=Pa.y,R[s+2]=Pa.z,q=m.color,m=m.groundColor,P.gammaInput?(r*=r,z(J,s,q,r),z(Q,s,m,r)):(N(J,s,q,r),N(Q,s,m,r)),Aa+=1))));c=3*U;for(f=Math.max(u.length,3*ia);c<f;c++)u[c]=0;c=3*ba;for(f=Math.max(w.length,3*wa);c<f;c++)w[c]=0;c=3*da;for(f=Math.max(C.length,3*fa);c<f;c++)C[c]=0;c=3*Aa;for(f=
Math.max(J.length,3*na);c<f;c++)J[c]=0;c=3*Aa;for(f=Math.max(Q.length,3*na);c<f;c++)Q[c]=0;t.directional.length=U;t.point.length=ba;t.spot.length=da;t.hemi.length=Aa;t.ambient[0]=l;t.ambient[1]=n;t.ambient[2]=p;Ta=!1}c=sb;j.ambientLightColor.value=c.ambient;j.directionalLightColor.value=c.directional.colors;j.directionalLightDirection.value=c.directional.positions;j.pointLightColor.value=c.point.colors;j.pointLightPosition.value=c.point.positions;j.pointLightDistance.value=c.point.distances;j.spotLightColor.value=
c.spot.colors;j.spotLightPosition.value=c.spot.positions;j.spotLightDistance.value=c.spot.distances;j.spotLightDirection.value=c.spot.directions;j.spotLightAngleCos.value=c.spot.anglesCos;j.spotLightExponent.value=c.spot.exponents;j.hemisphereLightSkyColor.value=c.hemi.skyColors;j.hemisphereLightGroundColor.value=c.hemi.groundColors;j.hemisphereLightDirection.value=c.hemi.positions}if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){j.opacity.value=
d.opacity;P.gammaInput?j.diffuse.value.copyGammaToLinear(d.color):j.diffuse.value=d.color;j.map.value=d.map;j.lightMap.value=d.lightMap;j.specularMap.value=d.specularMap;d.bumpMap&&(j.bumpMap.value=d.bumpMap,j.bumpScale.value=d.bumpScale);d.normalMap&&(j.normalMap.value=d.normalMap,j.normalScale.value.copy(d.normalScale));var ya;d.map?ya=d.map:d.specularMap?ya=d.specularMap:d.normalMap?ya=d.normalMap:d.bumpMap&&(ya=d.bumpMap);void 0!==ya&&(c=ya.offset,ya=ya.repeat,j.offsetRepeat.value.set(c.x,c.y,
ya.x,ya.y));j.envMap.value=d.envMap;j.flipEnvMap.value=d.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;j.reflectivity.value=d.reflectivity;j.refractionRatio.value=d.refractionRatio;j.combine.value=d.combine;j.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping}d instanceof THREE.LineBasicMaterial?(j.diffuse.value=d.color,j.opacity.value=d.opacity):d instanceof THREE.LineDashedMaterial?(j.diffuse.value=d.color,j.opacity.value=d.opacity,j.dashSize.value=d.dashSize,
j.totalSize.value=d.dashSize+d.gapSize,j.scale.value=d.scale):d instanceof THREE.ParticleBasicMaterial?(j.psColor.value=d.color,j.opacity.value=d.opacity,j.size.value=d.size,j.scale.value=Y.height/2,j.map.value=d.map):d instanceof THREE.MeshPhongMaterial?(j.shininess.value=d.shininess,P.gammaInput?(j.ambient.value.copyGammaToLinear(d.ambient),j.emissive.value.copyGammaToLinear(d.emissive),j.specular.value.copyGammaToLinear(d.specular)):(j.ambient.value=d.ambient,j.emissive.value=d.emissive,j.specular.value=
d.specular),d.wrapAround&&j.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(P.gammaInput?(j.ambient.value.copyGammaToLinear(d.ambient),j.emissive.value.copyGammaToLinear(d.emissive)):(j.ambient.value=d.ambient,j.emissive.value=d.emissive),d.wrapAround&&j.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(j.mNear.value=a.near,j.mFar.value=a.far,j.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(j.opacity.value=d.opacity);if(e.receiveShadow&&
!d._shadowPass&&j.shadowMatrix){c=ya=0;for(f=b.length;c<f;c++)if(l=b[c],l.castShadow&&(l instanceof THREE.SpotLight||l instanceof THREE.DirectionalLight&&!l.shadowCascade))j.shadowMap.value[ya]=l.shadowMap,j.shadowMapSize.value[ya]=l.shadowMapSize,j.shadowMatrix.value[ya]=l.shadowMatrix,j.shadowDarkness.value[ya]=l.shadowDarkness,j.shadowBias.value[ya]=l.shadowBias,ya++}b=d.uniformsList;j=0;for(ya=b.length;j<ya;j++)if(f=g.uniforms[b[j][1]])if(c=b[j][0],n=c.type,l=c.value,"i"===n)k.uniform1i(f,l);
else if("f"===n)k.uniform1f(f,l);else if("v2"===n)k.uniform2f(f,l.x,l.y);else if("v3"===n)k.uniform3f(f,l.x,l.y,l.z);else if("v4"===n)k.uniform4f(f,l.x,l.y,l.z,l.w);else if("c"===n)k.uniform3f(f,l.r,l.g,l.b);else if("iv1"===n)k.uniform1iv(f,l);else if("iv"===n)k.uniform3iv(f,l);else if("fv1"===n)k.uniform1fv(f,l);else if("fv"===n)k.uniform3fv(f,l);else if("v2v"===n){void 0===c._array&&(c._array=new Float32Array(2*l.length));n=0;for(p=l.length;n<p;n++)t=2*n,c._array[t]=l[n].x,c._array[t+1]=l[n].y;
k.uniform2fv(f,c._array)}else if("v3v"===n){void 0===c._array&&(c._array=new Float32Array(3*l.length));n=0;for(p=l.length;n<p;n++)t=3*n,c._array[t]=l[n].x,c._array[t+1]=l[n].y,c._array[t+2]=l[n].z;k.uniform3fv(f,c._array)}else if("v4v"===n){void 0===c._array&&(c._array=new Float32Array(4*l.length));n=0;for(p=l.length;n<p;n++)t=4*n,c._array[t]=l[n].x,c._array[t+1]=l[n].y,c._array[t+2]=l[n].z,c._array[t+3]=l[n].w;k.uniform4fv(f,c._array)}else if("m4"===n)void 0===c._array&&(c._array=new Float32Array(16)),
l.flattenToArray(c._array),k.uniformMatrix4fv(f,!1,c._array);else if("m4v"===n){void 0===c._array&&(c._array=new Float32Array(16*l.length));n=0;for(p=l.length;n<p;n++)l[n].flattenToArrayOffset(c._array,16*n);k.uniformMatrix4fv(f,!1,c._array)}else if("t"===n){if(t=l,l=K(),k.uniform1i(f,l),t)if(t.image instanceof Array&&6===t.image.length){if(c=t,f=l,6===c.image.length)if(c.needsUpdate){c.image.__webglTextureCube||(c.image.__webglTextureCube=k.createTexture(),P.info.memory.textures++);k.activeTexture(k.TEXTURE0+
f);k.bindTexture(k.TEXTURE_CUBE_MAP,c.image.__webglTextureCube);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,c.flipY);f=c instanceof THREE.CompressedTexture;l=[];for(n=0;6>n;n++)P.autoScaleCubemaps&&!f?(p=l,t=n,u=c.image[n],w=Gc,u.width<=w&&u.height<=w||(A=Math.max(u.width,u.height),v=Math.floor(u.width*w/A),w=Math.floor(u.height*w/A),A=document.createElement("canvas"),A.width=v,A.height=w,A.getContext("2d").drawImage(u,0,0,u.width,u.height,0,0,v,w),u=A),p[t]=u):l[n]=c.image[n];n=l[0];p=0===(n.width&n.width-
1)&&0===(n.height&n.height-1);t=E(c.format);u=E(c.type);M(k.TEXTURE_CUBE_MAP,c,p);for(n=0;6>n;n++)if(f){w=l[n].mipmaps;A=0;for(B=w.length;A<B;A++)v=w[A],k.compressedTexImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+n,A,t,v.width,v.height,0,v.data)}else k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t,t,u,l[n]);c.generateMipmaps&&p&&k.generateMipmap(k.TEXTURE_CUBE_MAP);c.needsUpdate=!1;if(c.onUpdate)c.onUpdate()}else k.activeTexture(k.TEXTURE0+f),k.bindTexture(k.TEXTURE_CUBE_MAP,c.image.__webglTextureCube)}else t instanceof
THREE.WebGLRenderTargetCube?(c=t,k.activeTexture(k.TEXTURE0+l),k.bindTexture(k.TEXTURE_CUBE_MAP,c.__webglTexture)):P.setTexture(t,l)}else if("tv"===n){void 0===c._array&&(c._array=[]);n=0;for(p=c.value.length;n<p;n++)c._array[n]=K();k.uniform1iv(f,c._array);n=0;for(p=c.value.length;n<p;n++)t=c.value[n],l=c._array[n],t&&P.setTexture(t,l)}if((d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==h.cameraPosition)hb.getPositionFromMatrix(a.matrixWorld),k.uniform3f(h.cameraPosition,
hb.x,hb.y,hb.z);(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)&&null!==h.viewMatrix&&k.uniformMatrix4fv(h.viewMatrix,!1,a.matrixWorldInverse.elements)}k.uniformMatrix4fv(h.modelViewMatrix,!1,e._modelViewMatrix.elements);h.normalMatrix&&k.uniformMatrix3fv(h.normalMatrix,!1,e._normalMatrix.elements);null!==h.modelMatrix&&k.uniformMatrix4fv(h.modelMatrix,!1,e.matrixWorld.elements);return g}function K(){var a=ca;a>=Xc&&console.warn("WebGLRenderer: trying to use "+
a+" texture units while this GPU supports only "+Xc);ca+=1;return a}function C(a,b){a._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,a.matrixWorld);a._normalMatrix.getInverse(a._modelViewMatrix);a._normalMatrix.transpose()}function z(a,b,c,d){a[b]=c.r*c.r*d;a[b+1]=c.g*c.g*d;a[b+2]=c.b*c.b*d}function N(a,b,c,d){a[b]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function O(a){a!==Eb&&(k.lineWidth(a),Eb=a)}function L(a,b,c){gb!==a&&(a?k.enable(k.POLYGON_OFFSET_FILL):k.disable(k.POLYGON_OFFSET_FILL),gb=a);
if(a&&(Ya!==b||Ea!==c))k.polygonOffset(b,c),Ya=b,Ea=c}function U(a){a=a.split("\n");for(var b=0,c=a.length;b<c;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function D(a,b){var c;"fragment"===a?c=k.createShader(k.FRAGMENT_SHADER):"vertex"===a&&(c=k.createShader(k.VERTEX_SHADER));k.shaderSource(c,b);k.compileShader(c);return!k.getShaderParameter(c,k.COMPILE_STATUS)?(console.error(k.getShaderInfoLog(c)),console.error(U(b)),null):c}function M(a,b,c){c?(k.texParameteri(a,k.TEXTURE_WRAP_S,E(b.wrapS)),k.texParameteri(a,
k.TEXTURE_WRAP_T,E(b.wrapT)),k.texParameteri(a,k.TEXTURE_MAG_FILTER,E(b.magFilter)),k.texParameteri(a,k.TEXTURE_MIN_FILTER,E(b.minFilter))):(k.texParameteri(a,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(a,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(a,k.TEXTURE_MAG_FILTER,J(b.magFilter)),k.texParameteri(a,k.TEXTURE_MIN_FILTER,J(b.minFilter)));if(ob&&b.type!==THREE.FloatType&&(1<b.anisotropy||b.__oldAnisotropy))k.texParameterf(a,ob.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,pc)),b.__oldAnisotropy=
b.anisotropy}function I(a,b){k.bindRenderbuffer(k.RENDERBUFFER,a);b.depthBuffer&&!b.stencilBuffer?(k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_COMPONENT16,b.width,b.height),k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_STENCIL,b.width,b.height),k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_STENCIL_ATTACHMENT,k.RENDERBUFFER,a)):k.renderbufferStorage(k.RENDERBUFFER,k.RGBA4,b.width,b.height)}
function J(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?k.NEAREST:k.LINEAR}function E(a){if(a===THREE.RepeatWrapping)return k.REPEAT;if(a===THREE.ClampToEdgeWrapping)return k.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return k.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return k.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return k.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return k.NEAREST_MIPMAP_LINEAR;if(a===
THREE.LinearFilter)return k.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return k.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return k.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return k.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return k.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return k.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return k.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return k.BYTE;if(a===THREE.ShortType)return k.SHORT;if(a===
THREE.UnsignedShortType)return k.UNSIGNED_SHORT;if(a===THREE.IntType)return k.INT;if(a===THREE.UnsignedIntType)return k.UNSIGNED_INT;if(a===THREE.FloatType)return k.FLOAT;if(a===THREE.AlphaFormat)return k.ALPHA;if(a===THREE.RGBFormat)return k.RGB;if(a===THREE.RGBAFormat)return k.RGBA;if(a===THREE.LuminanceFormat)return k.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return k.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return k.FUNC_ADD;if(a===THREE.SubtractEquation)return k.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return k.FUNC_REVERSE_SUBTRACT;
if(a===THREE.ZeroFactor)return k.ZERO;if(a===THREE.OneFactor)return k.ONE;if(a===THREE.SrcColorFactor)return k.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return k.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return k.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return k.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return k.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return k.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return k.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return k.ONE_MINUS_DST_COLOR;
if(a===THREE.SrcAlphaSaturateFactor)return k.SRC_ALPHA_SATURATE;if(void 0!==yb){if(a===THREE.RGB_S3TC_DXT1_Format)return yb.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return yb.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return yb.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return yb.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);a=a||{};var Y=void 0!==a.canvas?a.canvas:document.createElement("canvas"),
ia=void 0!==a.precision?a.precision:"highp",Ra=void 0!==a.alpha?a.alpha:!0,Sa=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,Q=void 0!==a.antialias?a.antialias:!1,ba=void 0!==a.stencil?a.stencil:!0,ua=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,fa=void 0!==a.clearColor?new THREE.Color(a.clearColor):new THREE.Color(0),qa=void 0!==a.clearAlpha?a.clearAlpha:0;this.domElement=Y;this.context=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?
window.devicePixelRatio:1;this.autoUpdateScene=this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=
[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var P=this,j=[],ya=0,Jb=null,mb=null,za=-1,Aa=null,ga=null,wa=0,ca=0,da=-1,ta=-1,na=-1,Ba=-1,wb=-1,xb=-1,la=-1,fb=-1,gb=null,Ya=null,Ea=null,Eb=null,kb=0,Kb=0,Lb=0,bb=0,rb=0,nb=0,ra={},Fa=new THREE.Frustum,cc=new THREE.Matrix4,xa=new THREE.Matrix4,hb=new THREE.Vector3,Pa=new THREE.Vector3,Ta=!0,sb={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,
colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},k,Mb,Za,ob,yb;try{if(!(k=Y.getContext("experimental-webgl",{alpha:Ra,premultipliedAlpha:Sa,antialias:Q,stencil:ba,preserveDrawingBuffer:ua})))throw"Error creating WebGL context.";}catch(Yb){console.error(Yb)}Mb=k.getExtension("OES_texture_float");Za=k.getExtension("OES_standard_derivatives");ob=k.getExtension("EXT_texture_filter_anisotropic")||
k.getExtension("MOZ_EXT_texture_filter_anisotropic")||k.getExtension("WEBKIT_EXT_texture_filter_anisotropic");yb=k.getExtension("WEBGL_compressed_texture_s3tc")||k.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||k.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");Mb||console.log("THREE.WebGLRenderer: Float textures not supported.");Za||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");ob||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");
yb||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");void 0===k.getShaderPrecisionFormat&&(k.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});k.clearColor(0,0,0,1);k.clearDepth(1);k.clearStencil(0);k.enable(k.DEPTH_TEST);k.depthFunc(k.LEQUAL);k.frontFace(k.CCW);k.cullFace(k.BACK);k.enable(k.CULL_FACE);k.enable(k.BLEND);k.blendEquation(k.FUNC_ADD);k.blendFunc(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA);k.clearColor(fa.r,fa.g,fa.b,qa);this.context=k;
var Xc=k.getParameter(k.MAX_TEXTURE_IMAGE_UNITS),Fc=k.getParameter(k.MAX_VERTEX_TEXTURE_IMAGE_UNITS);k.getParameter(k.MAX_TEXTURE_SIZE);var Gc=k.getParameter(k.MAX_CUBE_MAP_TEXTURE_SIZE),pc=ob?k.getParameter(ob.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,qc=0<Fc,Oc=qc&&Mb;yb&&k.getParameter(k.COMPRESSED_TEXTURE_FORMATS);var Yc=k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.HIGH_FLOAT),Zc=k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.MEDIUM_FLOAT);k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.LOW_FLOAT);var yc=
k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,k.HIGH_FLOAT),zc=k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,k.MEDIUM_FLOAT);k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,k.LOW_FLOAT);k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.HIGH_INT);k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.MEDIUM_INT);k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.LOW_INT);k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,k.HIGH_INT);k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,k.MEDIUM_INT);k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,
k.LOW_INT);var $c=0<Yc.precision&&0<yc.precision,Ka=0<Zc.precision&&0<zc.precision;"highp"===ia&&!$c&&(Ka?(ia="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(ia="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"===ia&&!Ka&&(ia="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return k};this.supportsVertexTextures=function(){return qc};this.supportsFloatTextures=function(){return Mb};
this.supportsStandardDerivatives=function(){return Za};this.supportsCompressedTextureS3TC=function(){return yb};this.getMaxAnisotropy=function(){return pc};this.getPrecision=function(){return ia};this.setSize=function(a,b){Y.width=a*this.devicePixelRatio;Y.height=b*this.devicePixelRatio;Y.style.width=a+"px";Y.style.height=b+"px";this.setViewport(0,0,Y.width,Y.height)};this.setViewport=function(a,b,c,d){kb=void 0!==a?a:0;Kb=void 0!==b?b:0;Lb=void 0!==c?c:Y.width;bb=void 0!==d?d:Y.height;k.viewport(kb,
Kb,Lb,bb)};this.setScissor=function(a,b,c,d){k.scissor(a,b,c,d)};this.enableScissorTest=function(a){a?k.enable(k.SCISSOR_TEST):k.disable(k.SCISSOR_TEST)};this.setClearColorHex=function(a,b){fa.setHex(a);qa=b;k.clearColor(fa.r,fa.g,fa.b,qa)};this.setClearColor=function(a,b){fa.copy(a);qa=b;k.clearColor(fa.r,fa.g,fa.b,qa)};this.getClearColor=function(){return fa};this.getClearAlpha=function(){return qa};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=k.COLOR_BUFFER_BIT;if(void 0===b||b)d|=k.DEPTH_BUFFER_BIT;
if(void 0===c||c)d|=k.STENCIL_BUFFER_BIT;k.clear(d)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.addPostPlugin=function(a){a.init(this);this.renderPluginsPost.push(a)};this.addPrePlugin=function(a){a.init(this);this.renderPluginsPre.push(a)};this.updateShadowMap=function(a,b){Jb=null;za=Aa=fb=la=na=-1;Ta=!0;ta=da=-1;this.shadowMapPlugin.update(a,b)};var Hc=function(a){a=a.target;a.removeEventListener("dispose",Hc);a.__webglInit=void 0;void 0!==a.__webglVertexBuffer&&
k.deleteBuffer(a.__webglVertexBuffer);void 0!==a.__webglNormalBuffer&&k.deleteBuffer(a.__webglNormalBuffer);void 0!==a.__webglTangentBuffer&&k.deleteBuffer(a.__webglTangentBuffer);void 0!==a.__webglColorBuffer&&k.deleteBuffer(a.__webglColorBuffer);void 0!==a.__webglUVBuffer&&k.deleteBuffer(a.__webglUVBuffer);void 0!==a.__webglUV2Buffer&&k.deleteBuffer(a.__webglUV2Buffer);void 0!==a.__webglSkinIndicesBuffer&&k.deleteBuffer(a.__webglSkinIndicesBuffer);void 0!==a.__webglSkinWeightsBuffer&&k.deleteBuffer(a.__webglSkinWeightsBuffer);
void 0!==a.__webglFaceBuffer&&k.deleteBuffer(a.__webglFaceBuffer);void 0!==a.__webglLineBuffer&&k.deleteBuffer(a.__webglLineBuffer);void 0!==a.__webglLineDistanceBuffer&&k.deleteBuffer(a.__webglLineDistanceBuffer);if(void 0!==a.geometryGroups)for(var c in a.geometryGroups){var d=a.geometryGroups[c];if(void 0!==d.numMorphTargets)for(var e=0,f=d.numMorphTargets;e<f;e++)k.deleteBuffer(d.__webglMorphTargetsBuffers[e]);if(void 0!==d.numMorphNormals){e=0;for(f=d.numMorphNormals;e<f;e++)k.deleteBuffer(d.__webglMorphNormalsBuffers[e])}b(d)}b(a);
P.info.memory.geometries--},Qc=function(a){a=a.target;a.removeEventListener("dispose",Qc);a.image&&a.image.__webglTextureCube?k.deleteTexture(a.image.__webglTextureCube):a.__webglInit&&(a.__webglInit=!1,k.deleteTexture(a.__webglTexture));P.info.memory.textures--},R=function(a){a=a.target;a.removeEventListener("dispose",R);if(a&&a.__webglTexture)if(k.deleteTexture(a.__webglTexture),a instanceof THREE.WebGLRenderTargetCube)for(var b=0;6>b;b++)k.deleteFramebuffer(a.__webglFramebuffer[b]),k.deleteRenderbuffer(a.__webglRenderbuffer[b]);
else k.deleteFramebuffer(a.__webglFramebuffer),k.deleteRenderbuffer(a.__webglRenderbuffer);P.info.memory.textures--},sc=function(a){a=a.target;a.removeEventListener("dispose",sc);ma(a)},ma=function(a){var b=a.program;if(void 0!==b){a.program=void 0;var c,d,e=!1;a=0;for(c=j.length;a<c;a++)if(d=j[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(e=!0);break}if(!0===e){e=[];a=0;for(c=j.length;a<c;a++)d=j[a],d.program!==b&&e.push(d);j=e;k.deleteProgram(b);P.info.memory.programs--}}};this.renderBufferImmediate=
function(a,b,c){a.hasPositions&&!a.__webglVertexBuffer&&(a.__webglVertexBuffer=k.createBuffer());a.hasNormals&&!a.__webglNormalBuffer&&(a.__webglNormalBuffer=k.createBuffer());a.hasUvs&&!a.__webglUvBuffer&&(a.__webglUvBuffer=k.createBuffer());a.hasColors&&!a.__webglColorBuffer&&(a.__webglColorBuffer=k.createBuffer());a.hasPositions&&(k.bindBuffer(k.ARRAY_BUFFER,a.__webglVertexBuffer),k.bufferData(k.ARRAY_BUFFER,a.positionArray,k.DYNAMIC_DRAW),k.enableVertexAttribArray(b.attributes.position),k.vertexAttribPointer(b.attributes.position,
3,k.FLOAT,!1,0,0));if(a.hasNormals){k.bindBuffer(k.ARRAY_BUFFER,a.__webglNormalBuffer);if(c.shading===THREE.FlatShading){var d,e,f,g,h,j,l,m,n,p,q,r=3*a.count;for(q=0;q<r;q+=9)p=a.normalArray,d=p[q],e=p[q+1],f=p[q+2],g=p[q+3],j=p[q+4],m=p[q+5],h=p[q+6],l=p[q+7],n=p[q+8],d=(d+g+h)/3,e=(e+j+l)/3,f=(f+m+n)/3,p[q]=d,p[q+1]=e,p[q+2]=f,p[q+3]=d,p[q+4]=e,p[q+5]=f,p[q+6]=d,p[q+7]=e,p[q+8]=f}k.bufferData(k.ARRAY_BUFFER,a.normalArray,k.DYNAMIC_DRAW);k.enableVertexAttribArray(b.attributes.normal);k.vertexAttribPointer(b.attributes.normal,
3,k.FLOAT,!1,0,0)}a.hasUvs&&c.map&&(k.bindBuffer(k.ARRAY_BUFFER,a.__webglUvBuffer),k.bufferData(k.ARRAY_BUFFER,a.uvArray,k.DYNAMIC_DRAW),k.enableVertexAttribArray(b.attributes.uv),k.vertexAttribPointer(b.attributes.uv,2,k.FLOAT,!1,0,0));a.hasColors&&c.vertexColors!==THREE.NoColors&&(k.bindBuffer(k.ARRAY_BUFFER,a.__webglColorBuffer),k.bufferData(k.ARRAY_BUFFER,a.colorArray,k.DYNAMIC_DRAW),k.enableVertexAttribArray(b.attributes.color),k.vertexAttribPointer(b.attributes.color,3,k.FLOAT,!1,0,0));k.drawArrays(k.TRIANGLES,
0,a.count);a.count=0};this.renderBufferDirect=function(a,b,c,d,e,f){if(!1!==d.visible)if(c=F(a,b,c,d,f),a=c.attributes,b=!1,c=16777215*e.id+2*c.id+(d.wireframe?1:0),c!==Aa&&(Aa=c,b=!0),b&&n(),f instanceof THREE.Mesh)if(d=e.attributes.index){f=e.offsets;1<f.length&&(b=!0);c=0;for(var g=f.length;c<g;c++){var h=f[c].index;if(b){var j=e.attributes.position,l=j.itemSize;k.bindBuffer(k.ARRAY_BUFFER,j.buffer);m(a.position);k.vertexAttribPointer(a.position,l,k.FLOAT,!1,0,4*h*l);l=e.attributes.normal;if(0<=
a.normal&&l){var p=l.itemSize;k.bindBuffer(k.ARRAY_BUFFER,l.buffer);m(a.normal);k.vertexAttribPointer(a.normal,p,k.FLOAT,!1,0,4*h*p)}l=e.attributes.uv;0<=a.uv&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,l.buffer),m(a.uv),k.vertexAttribPointer(a.uv,p,k.FLOAT,!1,0,4*h*p));l=e.attributes.color;0<=a.color&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,l.buffer),m(a.color),k.vertexAttribPointer(a.color,p,k.FLOAT,!1,0,4*h*p));l=e.attributes.tangent;0<=a.tangent&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,
l.buffer),m(a.tangent),k.vertexAttribPointer(a.tangent,p,k.FLOAT,!1,0,4*h*p));k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,d.buffer)}k.drawElements(k.TRIANGLES,f[c].count,k.UNSIGNED_SHORT,2*f[c].start);P.info.render.calls++;P.info.render.vertices+=f[c].count;P.info.render.faces+=f[c].count/3}}else b&&(j=e.attributes.position,l=j.itemSize,k.bindBuffer(k.ARRAY_BUFFER,j.buffer),m(a.position),k.vertexAttribPointer(a.position,l,k.FLOAT,!1,0,0),l=e.attributes.normal,0<=a.normal&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,
l.buffer),m(a.normal),k.vertexAttribPointer(a.normal,p,k.FLOAT,!1,0,0)),l=e.attributes.uv,0<=a.uv&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,l.buffer),m(a.uv),k.vertexAttribPointer(a.uv,p,k.FLOAT,!1,0,0)),l=e.attributes.color,0<=a.color&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,l.buffer),m(a.color),k.vertexAttribPointer(a.color,p,k.FLOAT,!1,0,0)),l=e.attributes.tangent,0<=a.tangent&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,l.buffer),m(a.tangent),k.vertexAttribPointer(a.tangent,p,k.FLOAT,
!1,0,0))),k.drawArrays(k.TRIANGLES,0,j.numItems/3),P.info.render.calls++,P.info.render.vertices+=j.numItems/3,P.info.render.faces+=j.numItems/3/3;else f instanceof THREE.ParticleSystem?b&&(j=e.attributes.position,l=j.itemSize,k.bindBuffer(k.ARRAY_BUFFER,j.buffer),m(a.position),k.vertexAttribPointer(a.position,l,k.FLOAT,!1,0,0),l=e.attributes.color,0<=a.color&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,l.buffer),m(a.color),k.vertexAttribPointer(a.color,p,k.FLOAT,!1,0,0)),k.drawArrays(k.POINTS,0,
j.numItems/3),P.info.render.calls++,P.info.render.points+=j.numItems/3):f instanceof THREE.Line&&b&&(j=e.attributes.position,l=j.itemSize,k.bindBuffer(k.ARRAY_BUFFER,j.buffer),m(a.position),k.vertexAttribPointer(a.position,l,k.FLOAT,!1,0,0),l=e.attributes.color,0<=a.color&&l&&(p=l.itemSize,k.bindBuffer(k.ARRAY_BUFFER,l.buffer),m(a.color),k.vertexAttribPointer(a.color,p,k.FLOAT,!1,0,0)),O(d.linewidth),k.drawArrays(k.LINE_STRIP,0,j.numItems/3),P.info.render.calls++,P.info.render.points+=j.numItems)};
this.renderBuffer=function(a,b,c,d,e,f){if(!1!==d.visible){var g,h;c=F(a,b,c,d,f);a=c.attributes;b=!1;c=16777215*e.id+2*c.id+(d.wireframe?1:0);c!==Aa&&(Aa=c,b=!0);b&&n();if(!d.morphTargets&&0<=a.position)b&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglVertexBuffer),m(a.position),k.vertexAttribPointer(a.position,3,k.FLOAT,!1,0,0));else if(f.morphTargetBase){c=d.program.attributes;-1!==f.morphTargetBase&&0<=c.position?(k.bindBuffer(k.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[f.morphTargetBase]),m(c.position),
k.vertexAttribPointer(c.position,3,k.FLOAT,!1,0,0)):0<=c.position&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglVertexBuffer),m(c.position),k.vertexAttribPointer(c.position,3,k.FLOAT,!1,0,0));if(f.morphTargetForcedOrder.length){var j=0;h=f.morphTargetForcedOrder;for(g=f.morphTargetInfluences;j<d.numSupportedMorphTargets&&j<h.length;)0<=c["morphTarget"+j]&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[h[j]]),m(c["morphTarget"+j]),k.vertexAttribPointer(c["morphTarget"+j],3,k.FLOAT,!1,0,0)),0<=
c["morphNormal"+j]&&d.morphNormals&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[h[j]]),m(c["morphNormal"+j]),k.vertexAttribPointer(c["morphNormal"+j],3,k.FLOAT,!1,0,0)),f.__webglMorphTargetInfluences[j]=g[h[j]],j++}else{h=[];g=f.morphTargetInfluences;var l,q=g.length;for(l=0;l<q;l++)j=g[l],0<j&&h.push([j,l]);h.length>d.numSupportedMorphTargets?(h.sort(p),h.length=d.numSupportedMorphTargets):h.length>d.numSupportedMorphNormals?h.sort(p):0===h.length&&h.push([0,0]);for(j=0;j<d.numSupportedMorphTargets;)h[j]?
(l=h[j][1],0<=c["morphTarget"+j]&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[l]),m(c["morphTarget"+j]),k.vertexAttribPointer(c["morphTarget"+j],3,k.FLOAT,!1,0,0)),0<=c["morphNormal"+j]&&d.morphNormals&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[l]),m(c["morphNormal"+j]),k.vertexAttribPointer(c["morphNormal"+j],3,k.FLOAT,!1,0,0)),f.__webglMorphTargetInfluences[j]=g[l]):f.__webglMorphTargetInfluences[j]=0,j++}null!==d.program.uniforms.morphTargetInfluences&&k.uniform1fv(d.program.uniforms.morphTargetInfluences,
f.__webglMorphTargetInfluences)}if(b){if(e.__webglCustomAttributesList){g=0;for(h=e.__webglCustomAttributesList.length;g<h;g++)c=e.__webglCustomAttributesList[g],0<=a[c.buffer.belongsToAttribute]&&(k.bindBuffer(k.ARRAY_BUFFER,c.buffer),m(a[c.buffer.belongsToAttribute]),k.vertexAttribPointer(a[c.buffer.belongsToAttribute],c.size,k.FLOAT,!1,0,0))}0<=a.color&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglColorBuffer),m(a.color),k.vertexAttribPointer(a.color,3,k.FLOAT,!1,0,0));0<=a.normal&&(k.bindBuffer(k.ARRAY_BUFFER,
e.__webglNormalBuffer),m(a.normal),k.vertexAttribPointer(a.normal,3,k.FLOAT,!1,0,0));0<=a.tangent&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglTangentBuffer),m(a.tangent),k.vertexAttribPointer(a.tangent,4,k.FLOAT,!1,0,0));0<=a.uv&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglUVBuffer),m(a.uv),k.vertexAttribPointer(a.uv,2,k.FLOAT,!1,0,0));0<=a.uv2&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglUV2Buffer),m(a.uv2),k.vertexAttribPointer(a.uv2,2,k.FLOAT,!1,0,0));d.skinning&&0<=a.skinIndex&&0<=a.skinWeight&&(k.bindBuffer(k.ARRAY_BUFFER,
e.__webglSkinIndicesBuffer),m(a.skinIndex),k.vertexAttribPointer(a.skinIndex,4,k.FLOAT,!1,0,0),k.bindBuffer(k.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),m(a.skinWeight),k.vertexAttribPointer(a.skinWeight,4,k.FLOAT,!1,0,0));0<=a.lineDistance&&(k.bindBuffer(k.ARRAY_BUFFER,e.__webglLineDistanceBuffer),m(a.lineDistance),k.vertexAttribPointer(a.lineDistance,1,k.FLOAT,!1,0,0))}f instanceof THREE.Mesh?(d.wireframe?(O(d.wireframeLinewidth),b&&k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),k.drawElements(k.LINES,
e.__webglLineCount,k.UNSIGNED_SHORT,0)):(b&&k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),k.drawElements(k.TRIANGLES,e.__webglFaceCount,k.UNSIGNED_SHORT,0)),P.info.render.calls++,P.info.render.vertices+=e.__webglFaceCount,P.info.render.faces+=e.__webglFaceCount/3):f instanceof THREE.Line?(f=f.type===THREE.LineStrip?k.LINE_STRIP:k.LINES,O(d.linewidth),k.drawArrays(f,0,e.__webglLineCount),P.info.render.calls++):f instanceof THREE.ParticleSystem?(k.drawArrays(k.POINTS,0,e.__webglParticleCount),
P.info.render.calls++,P.info.render.points+=e.__webglParticleCount):f instanceof THREE.Ribbon&&(k.drawArrays(k.TRIANGLE_STRIP,0,e.__webglVertexCount),P.info.render.calls++)}};this.render=function(a,b,c,d){if(!1===b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var e,f,g,h,j=a.__lights,l=a.fog;za=-1;Ta=!0;this.autoUpdateScene&&a.updateMatrixWorld();void 0===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);
cc.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);Fa.setFromMatrix(cc);this.autoUpdateObjects&&this.initWebGLObjects(a);t(this.renderPluginsPre,a,b);P.info.render.calls=0;P.info.render.vertices=0;P.info.render.faces=0;P.info.render.points=0;this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);h=a.__webglObjects;d=0;for(e=h.length;d<e;d++)if(f=h[d],g=f.object,f.render=!1,g.visible&&(!(g instanceof THREE.Mesh||g instanceof
THREE.ParticleSystem)||!g.frustumCulled||Fa.intersectsObject(g))){C(g,b);var m=f,n=m.buffer,p=void 0,s=void 0,s=m.object.material;if(s instanceof THREE.MeshFaceMaterial)p=n.materialIndex,p=s.materials[p],p.transparent?(m.transparent=p,m.opaque=null):(m.opaque=p,m.transparent=null);else if(p=s)p.transparent?(m.transparent=p,m.opaque=null):(m.opaque=p,m.transparent=null);f.render=!0;!0===this.sortObjects&&(null!==g.renderDepth?f.z=g.renderDepth:(hb.getPositionFromMatrix(g.matrixWorld),hb.applyProjection(cc),
f.z=hb.z),f.id=g.id)}this.sortObjects&&h.sort(q);h=a.__webglObjectsImmediate;d=0;for(e=h.length;d<e;d++)f=h[d],g=f.object,g.visible&&(C(g,b),g=f.object.material,g.transparent?(f.transparent=g,f.opaque=null):(f.opaque=g,f.transparent=null));a.overrideMaterial?(d=a.overrideMaterial,this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),this.setDepthWrite(d.depthWrite),L(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),u(a.__webglObjects,!1,"",b,
j,l,!0,d),r(a.__webglObjectsImmediate,"",b,j,l,!1,d)):(d=null,this.setBlending(THREE.NoBlending),u(a.__webglObjects,!0,"opaque",b,j,l,!1,d),r(a.__webglObjectsImmediate,"opaque",b,j,l,!1,d),u(a.__webglObjects,!1,"transparent",b,j,l,!0,d),r(a.__webglObjectsImmediate,"transparent",b,j,l,!0,d));t(this.renderPluginsPost,a,b);c&&c.generateMipmaps&&(c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter)&&(c instanceof THREE.WebGLRenderTargetCube?(k.bindTexture(k.TEXTURE_CUBE_MAP,c.__webglTexture),
k.generateMipmap(k.TEXTURE_CUBE_MAP),k.bindTexture(k.TEXTURE_CUBE_MAP,null)):(k.bindTexture(k.TEXTURE_2D,c.__webglTexture),k.generateMipmap(k.TEXTURE_2D),k.bindTexture(k.TEXTURE_2D,null)));this.setDepthTest(!0);this.setDepthWrite(!0)}};this.renderImmediateObject=function(a,b,c,d,e){var f=F(a,b,c,d,e);Aa=-1;P.setMaterialFaces(d);e.immediateRenderCallback?e.immediateRenderCallback(f,k,Fa):e.render(function(a){P.renderBufferImmediate(a,f,d)})};this.initWebGLObjects=function(a){for(a.__webglObjects||
(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]);a.__objectsAdded.length;){var b=a.__objectsAdded[0],j=a,m=void 0,n=void 0,q=void 0,r=void 0;if(!b.__webglInit)if(b.__webglInit=!0,b._modelViewMatrix=new THREE.Matrix4,b._normalMatrix=new THREE.Matrix3,void 0!==b.geometry&&void 0===b.geometry.__webglInit&&(b.geometry.__webglInit=!0,b.geometry.addEventListener("dispose",Hc)),b instanceof THREE.Mesh)if(n=b.geometry,q=b.material,n instanceof THREE.Geometry){if(void 0===
n.geometryGroups){var t=n,u=void 0,z=void 0,E=void 0,C=void 0,F=void 0,D=void 0,I={},K=t.morphTargets.length,L=t.morphNormals.length,M=q instanceof THREE.MeshFaceMaterial;t.geometryGroups={};u=0;for(z=t.faces.length;u<z;u++)E=t.faces[u],C=M?E.materialIndex:0,void 0===I[C]&&(I[C]={hash:C,counter:0}),D=I[C].hash+"_"+I[C].counter,void 0===t.geometryGroups[D]&&(t.geometryGroups[D]={faces3:[],faces4:[],materialIndex:C,vertices:0,numMorphTargets:K,numMorphNormals:L}),F=E instanceof THREE.Face3?3:4,65535<
t.geometryGroups[D].vertices+F&&(I[C].counter+=1,D=I[C].hash+"_"+I[C].counter,void 0===t.geometryGroups[D]&&(t.geometryGroups[D]={faces3:[],faces4:[],materialIndex:C,vertices:0,numMorphTargets:K,numMorphNormals:L})),E instanceof THREE.Face3?t.geometryGroups[D].faces3.push(u):t.geometryGroups[D].faces4.push(u),t.geometryGroups[D].vertices+=F;t.geometryGroupsList=[];var N=void 0;for(N in t.geometryGroups)t.geometryGroups[N].id=wa++,t.geometryGroupsList.push(t.geometryGroups[N])}for(m in n.geometryGroups)if(r=
n.geometryGroups[m],!r.__webglVertexBuffer){var J=r;J.__webglVertexBuffer=k.createBuffer();J.__webglNormalBuffer=k.createBuffer();J.__webglTangentBuffer=k.createBuffer();J.__webglColorBuffer=k.createBuffer();J.__webglUVBuffer=k.createBuffer();J.__webglUV2Buffer=k.createBuffer();J.__webglSkinIndicesBuffer=k.createBuffer();J.__webglSkinWeightsBuffer=k.createBuffer();J.__webglFaceBuffer=k.createBuffer();J.__webglLineBuffer=k.createBuffer();var O=void 0,Q=void 0;if(J.numMorphTargets){J.__webglMorphTargetsBuffers=
[];O=0;for(Q=J.numMorphTargets;O<Q;O++)J.__webglMorphTargetsBuffers.push(k.createBuffer())}if(J.numMorphNormals){J.__webglMorphNormalsBuffers=[];O=0;for(Q=J.numMorphNormals;O<Q;O++)J.__webglMorphNormalsBuffers.push(k.createBuffer())}P.info.memory.geometries++;d(r,b);n.verticesNeedUpdate=!0;n.morphTargetsNeedUpdate=!0;n.elementsNeedUpdate=!0;n.uvsNeedUpdate=!0;n.normalsNeedUpdate=!0;n.tangentsNeedUpdate=!0;n.colorsNeedUpdate=!0}}else n instanceof THREE.BufferGeometry&&h(n);else if(b instanceof THREE.Ribbon){if(n=
b.geometry,!n.__webglVertexBuffer){var R=n;R.__webglVertexBuffer=k.createBuffer();R.__webglColorBuffer=k.createBuffer();R.__webglNormalBuffer=k.createBuffer();P.info.memory.geometries++;var U=n,Y=b,ga=U.vertices.length;U.__vertexArray=new Float32Array(3*ga);U.__colorArray=new Float32Array(3*ga);U.__normalArray=new Float32Array(3*ga);U.__webglVertexCount=ga;c(U,Y);n.verticesNeedUpdate=!0;n.colorsNeedUpdate=!0;n.normalsNeedUpdate=!0}}else if(b instanceof THREE.Line){if(n=b.geometry,!n.__webglVertexBuffer)if(n instanceof
THREE.Geometry){var ca=n;ca.__webglVertexBuffer=k.createBuffer();ca.__webglColorBuffer=k.createBuffer();ca.__webglLineDistanceBuffer=k.createBuffer();P.info.memory.geometries++;var ba=n,ya=b,da=ba.vertices.length;ba.__vertexArray=new Float32Array(3*da);ba.__colorArray=new Float32Array(3*da);ba.__lineDistanceArray=new Float32Array(1*da);ba.__webglLineCount=da;c(ba,ya);n.verticesNeedUpdate=!0;n.colorsNeedUpdate=!0;n.lineDistancesNeedUpdate=!0}else n instanceof THREE.BufferGeometry&&h(n)}else if(b instanceof
THREE.ParticleSystem&&(n=b.geometry,!n.__webglVertexBuffer))if(n instanceof THREE.Geometry){var Aa=n;Aa.__webglVertexBuffer=k.createBuffer();Aa.__webglColorBuffer=k.createBuffer();P.info.memory.geometries++;var ia=n,na=b,ma=ia.vertices.length;ia.__vertexArray=new Float32Array(3*ma);ia.__colorArray=new Float32Array(3*ma);ia.__sortArray=[];ia.__webglParticleCount=ma;c(ia,na);n.verticesNeedUpdate=!0;n.colorsNeedUpdate=!0}else n instanceof THREE.BufferGeometry&&h(n);if(!b.__webglActive){if(b instanceof
THREE.Mesh)if(n=b.geometry,n instanceof THREE.BufferGeometry)s(j.__webglObjects,n,b);else{if(n instanceof THREE.Geometry)for(m in n.geometryGroups)r=n.geometryGroups[m],s(j.__webglObjects,r,b)}else b instanceof THREE.Ribbon||b instanceof THREE.Line||b instanceof THREE.ParticleSystem?(n=b.geometry,s(j.__webglObjects,n,b)):b instanceof THREE.ImmediateRenderObject||b.immediateRenderCallback?j.__webglObjectsImmediate.push({object:b,opaque:null,transparent:null}):b instanceof THREE.Sprite?j.__webglSprites.push(b):
b instanceof THREE.LensFlare&&j.__webglFlares.push(b);b.__webglActive=!0}a.__objectsAdded.splice(0,1)}for(;a.__objectsRemoved.length;){var fa=a.__objectsRemoved[0],qa=a;fa instanceof THREE.Mesh||fa instanceof THREE.ParticleSystem||fa instanceof THREE.Ribbon||fa instanceof THREE.Line?B(qa.__webglObjects,fa):fa instanceof THREE.Sprite?w(qa.__webglSprites,fa):fa instanceof THREE.LensFlare?w(qa.__webglFlares,fa):(fa instanceof THREE.ImmediateRenderObject||fa.immediateRenderCallback)&&B(qa.__webglObjectsImmediate,
fa);fa.__webglActive=!1;a.__objectsRemoved.splice(0,1)}for(var ta=0,Ba=a.__webglObjects.length;ta<Ba;ta++){var za=a.__webglObjects[ta].object,T=za.geometry,mb=void 0,ua=void 0,la=void 0;if(za instanceof THREE.Mesh)if(T instanceof THREE.BufferGeometry)(T.verticesNeedUpdate||T.elementsNeedUpdate||T.uvsNeedUpdate||T.normalsNeedUpdate||T.colorsNeedUpdate||T.tangentsNeedUpdate)&&l(T,k.DYNAMIC_DRAW,!T.dynamic),T.verticesNeedUpdate=!1,T.elementsNeedUpdate=!1,T.uvsNeedUpdate=!1,T.normalsNeedUpdate=!1,T.colorsNeedUpdate=
!1,T.tangentsNeedUpdate=!1;else{for(var Ea=0,Jb=T.geometryGroupsList.length;Ea<Jb;Ea++)if(mb=T.geometryGroupsList[Ea],la=e(za,mb),T.buffersNeedUpdate&&d(mb,za),ua=la.attributes&&A(la),T.verticesNeedUpdate||T.morphTargetsNeedUpdate||T.elementsNeedUpdate||T.uvsNeedUpdate||T.normalsNeedUpdate||T.colorsNeedUpdate||T.tangentsNeedUpdate||ua){var pa=mb,Ka=za,ra=k.DYNAMIC_DRAW,Ra=!T.dynamic,Fa=la;if(pa.__inittedArrays){var Pa=f(Fa),Ya=Fa.vertexColors?Fa.vertexColors:!1,wb=g(Fa),fb=Pa===THREE.SmoothShading,
G=void 0,Z=void 0,Ta=void 0,S=void 0,bb=void 0,Za=void 0,Sa=void 0,xb=void 0,gb=void 0,sb=void 0,yb=void 0,X=void 0,V=void 0,W=void 0,sa=void 0,kb=void 0,nb=void 0,ob=void 0,Eb=void 0,Tb=void 0,rb=void 0,Zb=void 0,Kb=void 0,ec=void 0,tb=void 0,$b=void 0,Lb=void 0,Rb=void 0,Gb=void 0,ib=void 0,bc=void 0,Hb=void 0,Ub=void 0,fc=void 0,Mb=void 0,Ha=void 0,Yb=void 0,oc=void 0,kc=void 0,Jc=void 0,jb=void 0,sc=void 0,lb=void 0,Qa=void 0,jc=void 0,mc=void 0,$a=0,eb=0,gc=0,nc=0,Sb=0,cb=0,Ca=0,Cb=0,db=0,ha=
0,oa=0,y=0,Ja=void 0,ub=pa.__vertexArray,Kc=pa.__uvArray,Lc=pa.__uv2Array,Ib=pa.__normalArray,Ma=pa.__tangentArray,qb=pa.__colorArray,Wa=pa.__skinIndexArray,Na=pa.__skinWeightArray,pc=pa.__morphTargetsArrays,Mc=pa.__morphNormalsArrays,qc=pa.__webglCustomAttributesList,x=void 0,Vb=pa.__faceArray,Nb=pa.__lineArray,Db=Ka.geometry,Ec=Db.elementsNeedUpdate,Tc=Db.uvsNeedUpdate,Oc=Db.normalsNeedUpdate,Qc=Db.tangentsNeedUpdate,Xc=Db.colorsNeedUpdate,Wc=Db.morphTargetsNeedUpdate,Xb=Db.vertices,Da=pa.faces3,
aa=pa.faces4,vb=Db.faces,Fc=Db.faceVertexUvs[0],Gc=Db.faceVertexUvs[1],xc=Db.skinIndices,Cc=Db.skinWeights,Dc=Db.morphTargets,yc=Db.morphNormals;if(Db.verticesNeedUpdate){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],X=Xb[S.a],V=Xb[S.b],W=Xb[S.c],ub[eb]=X.x,ub[eb+1]=X.y,ub[eb+2]=X.z,ub[eb+3]=V.x,ub[eb+4]=V.y,ub[eb+5]=V.z,ub[eb+6]=W.x,ub[eb+7]=W.y,ub[eb+8]=W.z,eb+=9;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],X=Xb[S.a],V=Xb[S.b],W=Xb[S.c],sa=Xb[S.d],ub[eb]=X.x,ub[eb+1]=X.y,ub[eb+2]=X.z,ub[eb+3]=V.x,ub[eb+4]=
V.y,ub[eb+5]=V.z,ub[eb+6]=W.x,ub[eb+7]=W.y,ub[eb+8]=W.z,ub[eb+9]=sa.x,ub[eb+10]=sa.y,ub[eb+11]=sa.z,eb+=12;k.bindBuffer(k.ARRAY_BUFFER,pa.__webglVertexBuffer);k.bufferData(k.ARRAY_BUFFER,ub,ra)}if(Wc){jb=0;for(sc=Dc.length;jb<sc;jb++){G=oa=0;for(Z=Da.length;G<Z;G++)jc=Da[G],S=vb[jc],X=Dc[jb].vertices[S.a],V=Dc[jb].vertices[S.b],W=Dc[jb].vertices[S.c],lb=pc[jb],lb[oa]=X.x,lb[oa+1]=X.y,lb[oa+2]=X.z,lb[oa+3]=V.x,lb[oa+4]=V.y,lb[oa+5]=V.z,lb[oa+6]=W.x,lb[oa+7]=W.y,lb[oa+8]=W.z,Fa.morphNormals&&(fb?(mc=
yc[jb].vertexNormals[jc],Tb=mc.a,rb=mc.b,Zb=mc.c):Zb=rb=Tb=yc[jb].faceNormals[jc],Qa=Mc[jb],Qa[oa]=Tb.x,Qa[oa+1]=Tb.y,Qa[oa+2]=Tb.z,Qa[oa+3]=rb.x,Qa[oa+4]=rb.y,Qa[oa+5]=rb.z,Qa[oa+6]=Zb.x,Qa[oa+7]=Zb.y,Qa[oa+8]=Zb.z),oa+=9;G=0;for(Z=aa.length;G<Z;G++)jc=aa[G],S=vb[jc],X=Dc[jb].vertices[S.a],V=Dc[jb].vertices[S.b],W=Dc[jb].vertices[S.c],sa=Dc[jb].vertices[S.d],lb=pc[jb],lb[oa]=X.x,lb[oa+1]=X.y,lb[oa+2]=X.z,lb[oa+3]=V.x,lb[oa+4]=V.y,lb[oa+5]=V.z,lb[oa+6]=W.x,lb[oa+7]=W.y,lb[oa+8]=W.z,lb[oa+9]=sa.x,
lb[oa+10]=sa.y,lb[oa+11]=sa.z,Fa.morphNormals&&(fb?(mc=yc[jb].vertexNormals[jc],Tb=mc.a,rb=mc.b,Zb=mc.c,Kb=mc.d):Kb=Zb=rb=Tb=yc[jb].faceNormals[jc],Qa=Mc[jb],Qa[oa]=Tb.x,Qa[oa+1]=Tb.y,Qa[oa+2]=Tb.z,Qa[oa+3]=rb.x,Qa[oa+4]=rb.y,Qa[oa+5]=rb.z,Qa[oa+6]=Zb.x,Qa[oa+7]=Zb.y,Qa[oa+8]=Zb.z,Qa[oa+9]=Kb.x,Qa[oa+10]=Kb.y,Qa[oa+11]=Kb.z),oa+=12;k.bindBuffer(k.ARRAY_BUFFER,pa.__webglMorphTargetsBuffers[jb]);k.bufferData(k.ARRAY_BUFFER,pc[jb],ra);Fa.morphNormals&&(k.bindBuffer(k.ARRAY_BUFFER,pa.__webglMorphNormalsBuffers[jb]),
k.bufferData(k.ARRAY_BUFFER,Mc[jb],ra))}}if(Cc.length){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],Rb=Cc[S.a],Gb=Cc[S.b],ib=Cc[S.c],Na[ha]=Rb.x,Na[ha+1]=Rb.y,Na[ha+2]=Rb.z,Na[ha+3]=Rb.w,Na[ha+4]=Gb.x,Na[ha+5]=Gb.y,Na[ha+6]=Gb.z,Na[ha+7]=Gb.w,Na[ha+8]=ib.x,Na[ha+9]=ib.y,Na[ha+10]=ib.z,Na[ha+11]=ib.w,Hb=xc[S.a],Ub=xc[S.b],fc=xc[S.c],Wa[ha]=Hb.x,Wa[ha+1]=Hb.y,Wa[ha+2]=Hb.z,Wa[ha+3]=Hb.w,Wa[ha+4]=Ub.x,Wa[ha+5]=Ub.y,Wa[ha+6]=Ub.z,Wa[ha+7]=Ub.w,Wa[ha+8]=fc.x,Wa[ha+9]=fc.y,Wa[ha+10]=fc.z,Wa[ha+11]=fc.w,ha+=
12;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],Rb=Cc[S.a],Gb=Cc[S.b],ib=Cc[S.c],bc=Cc[S.d],Na[ha]=Rb.x,Na[ha+1]=Rb.y,Na[ha+2]=Rb.z,Na[ha+3]=Rb.w,Na[ha+4]=Gb.x,Na[ha+5]=Gb.y,Na[ha+6]=Gb.z,Na[ha+7]=Gb.w,Na[ha+8]=ib.x,Na[ha+9]=ib.y,Na[ha+10]=ib.z,Na[ha+11]=ib.w,Na[ha+12]=bc.x,Na[ha+13]=bc.y,Na[ha+14]=bc.z,Na[ha+15]=bc.w,Hb=xc[S.a],Ub=xc[S.b],fc=xc[S.c],Mb=xc[S.d],Wa[ha]=Hb.x,Wa[ha+1]=Hb.y,Wa[ha+2]=Hb.z,Wa[ha+3]=Hb.w,Wa[ha+4]=Ub.x,Wa[ha+5]=Ub.y,Wa[ha+6]=Ub.z,Wa[ha+7]=Ub.w,Wa[ha+8]=fc.x,Wa[ha+9]=fc.y,Wa[ha+
10]=fc.z,Wa[ha+11]=fc.w,Wa[ha+12]=Mb.x,Wa[ha+13]=Mb.y,Wa[ha+14]=Mb.z,Wa[ha+15]=Mb.w,ha+=16;0<ha&&(k.bindBuffer(k.ARRAY_BUFFER,pa.__webglSkinIndicesBuffer),k.bufferData(k.ARRAY_BUFFER,Wa,ra),k.bindBuffer(k.ARRAY_BUFFER,pa.__webglSkinWeightsBuffer),k.bufferData(k.ARRAY_BUFFER,Na,ra))}if(Xc&&Ya){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],Sa=S.vertexColors,xb=S.color,3===Sa.length&&Ya===THREE.VertexColors?(ec=Sa[0],tb=Sa[1],$b=Sa[2]):$b=tb=ec=xb,qb[db]=ec.r,qb[db+1]=ec.g,qb[db+2]=ec.b,qb[db+3]=tb.r,qb[db+
4]=tb.g,qb[db+5]=tb.b,qb[db+6]=$b.r,qb[db+7]=$b.g,qb[db+8]=$b.b,db+=9;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],Sa=S.vertexColors,xb=S.color,4===Sa.length&&Ya===THREE.VertexColors?(ec=Sa[0],tb=Sa[1],$b=Sa[2],Lb=Sa[3]):Lb=$b=tb=ec=xb,qb[db]=ec.r,qb[db+1]=ec.g,qb[db+2]=ec.b,qb[db+3]=tb.r,qb[db+4]=tb.g,qb[db+5]=tb.b,qb[db+6]=$b.r,qb[db+7]=$b.g,qb[db+8]=$b.b,qb[db+9]=Lb.r,qb[db+10]=Lb.g,qb[db+11]=Lb.b,db+=12;0<db&&(k.bindBuffer(k.ARRAY_BUFFER,pa.__webglColorBuffer),k.bufferData(k.ARRAY_BUFFER,qb,ra))}if(Qc&&
Db.hasTangents){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],gb=S.vertexTangents,kb=gb[0],nb=gb[1],ob=gb[2],Ma[Ca]=kb.x,Ma[Ca+1]=kb.y,Ma[Ca+2]=kb.z,Ma[Ca+3]=kb.w,Ma[Ca+4]=nb.x,Ma[Ca+5]=nb.y,Ma[Ca+6]=nb.z,Ma[Ca+7]=nb.w,Ma[Ca+8]=ob.x,Ma[Ca+9]=ob.y,Ma[Ca+10]=ob.z,Ma[Ca+11]=ob.w,Ca+=12;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],gb=S.vertexTangents,kb=gb[0],nb=gb[1],ob=gb[2],Eb=gb[3],Ma[Ca]=kb.x,Ma[Ca+1]=kb.y,Ma[Ca+2]=kb.z,Ma[Ca+3]=kb.w,Ma[Ca+4]=nb.x,Ma[Ca+5]=nb.y,Ma[Ca+6]=nb.z,Ma[Ca+7]=nb.w,Ma[Ca+8]=ob.x,Ma[Ca+
9]=ob.y,Ma[Ca+10]=ob.z,Ma[Ca+11]=ob.w,Ma[Ca+12]=Eb.x,Ma[Ca+13]=Eb.y,Ma[Ca+14]=Eb.z,Ma[Ca+15]=Eb.w,Ca+=16;k.bindBuffer(k.ARRAY_BUFFER,pa.__webglTangentBuffer);k.bufferData(k.ARRAY_BUFFER,Ma,ra)}if(Oc&&Pa){G=0;for(Z=Da.length;G<Z;G++)if(S=vb[Da[G]],bb=S.vertexNormals,Za=S.normal,3===bb.length&&fb)for(Ha=0;3>Ha;Ha++)oc=bb[Ha],Ib[cb]=oc.x,Ib[cb+1]=oc.y,Ib[cb+2]=oc.z,cb+=3;else for(Ha=0;3>Ha;Ha++)Ib[cb]=Za.x,Ib[cb+1]=Za.y,Ib[cb+2]=Za.z,cb+=3;G=0;for(Z=aa.length;G<Z;G++)if(S=vb[aa[G]],bb=S.vertexNormals,
Za=S.normal,4===bb.length&&fb)for(Ha=0;4>Ha;Ha++)oc=bb[Ha],Ib[cb]=oc.x,Ib[cb+1]=oc.y,Ib[cb+2]=oc.z,cb+=3;else for(Ha=0;4>Ha;Ha++)Ib[cb]=Za.x,Ib[cb+1]=Za.y,Ib[cb+2]=Za.z,cb+=3;k.bindBuffer(k.ARRAY_BUFFER,pa.__webglNormalBuffer);k.bufferData(k.ARRAY_BUFFER,Ib,ra)}if(Tc&&Fc&&wb){G=0;for(Z=Da.length;G<Z;G++)if(Ta=Da[G],sb=Fc[Ta],void 0!==sb)for(Ha=0;3>Ha;Ha++)kc=sb[Ha],Kc[gc]=kc.x,Kc[gc+1]=kc.y,gc+=2;G=0;for(Z=aa.length;G<Z;G++)if(Ta=aa[G],sb=Fc[Ta],void 0!==sb)for(Ha=0;4>Ha;Ha++)kc=sb[Ha],Kc[gc]=kc.x,
Kc[gc+1]=kc.y,gc+=2;0<gc&&(k.bindBuffer(k.ARRAY_BUFFER,pa.__webglUVBuffer),k.bufferData(k.ARRAY_BUFFER,Kc,ra))}if(Tc&&Gc&&wb){G=0;for(Z=Da.length;G<Z;G++)if(Ta=Da[G],yb=Gc[Ta],void 0!==yb)for(Ha=0;3>Ha;Ha++)Jc=yb[Ha],Lc[nc]=Jc.x,Lc[nc+1]=Jc.y,nc+=2;G=0;for(Z=aa.length;G<Z;G++)if(Ta=aa[G],yb=Gc[Ta],void 0!==yb)for(Ha=0;4>Ha;Ha++)Jc=yb[Ha],Lc[nc]=Jc.x,Lc[nc+1]=Jc.y,nc+=2;0<nc&&(k.bindBuffer(k.ARRAY_BUFFER,pa.__webglUV2Buffer),k.bufferData(k.ARRAY_BUFFER,Lc,ra))}if(Ec){G=0;for(Z=Da.length;G<Z;G++)Vb[Sb]=
$a,Vb[Sb+1]=$a+1,Vb[Sb+2]=$a+2,Sb+=3,Nb[Cb]=$a,Nb[Cb+1]=$a+1,Nb[Cb+2]=$a,Nb[Cb+3]=$a+2,Nb[Cb+4]=$a+1,Nb[Cb+5]=$a+2,Cb+=6,$a+=3;G=0;for(Z=aa.length;G<Z;G++)Vb[Sb]=$a,Vb[Sb+1]=$a+1,Vb[Sb+2]=$a+3,Vb[Sb+3]=$a+1,Vb[Sb+4]=$a+2,Vb[Sb+5]=$a+3,Sb+=6,Nb[Cb]=$a,Nb[Cb+1]=$a+1,Nb[Cb+2]=$a,Nb[Cb+3]=$a+3,Nb[Cb+4]=$a+1,Nb[Cb+5]=$a+2,Nb[Cb+6]=$a+2,Nb[Cb+7]=$a+3,Cb+=8,$a+=4;k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,pa.__webglFaceBuffer);k.bufferData(k.ELEMENT_ARRAY_BUFFER,Vb,ra);k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,pa.__webglLineBuffer);
k.bufferData(k.ELEMENT_ARRAY_BUFFER,Nb,ra)}if(qc){Ha=0;for(Yb=qc.length;Ha<Yb;Ha++)if(x=qc[Ha],x.__original.needsUpdate){y=0;if(1===x.size)if(void 0===x.boundTo||"vertices"===x.boundTo){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],x.array[y]=x.value[S.a],x.array[y+1]=x.value[S.b],x.array[y+2]=x.value[S.c],y+=3;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],x.array[y]=x.value[S.a],x.array[y+1]=x.value[S.b],x.array[y+2]=x.value[S.c],x.array[y+3]=x.value[S.d],y+=4}else{if("faces"===x.boundTo){G=0;for(Z=Da.length;G<
Z;G++)Ja=x.value[Da[G]],x.array[y]=Ja,x.array[y+1]=Ja,x.array[y+2]=Ja,y+=3;G=0;for(Z=aa.length;G<Z;G++)Ja=x.value[aa[G]],x.array[y]=Ja,x.array[y+1]=Ja,x.array[y+2]=Ja,x.array[y+3]=Ja,y+=4}}else if(2===x.size)if(void 0===x.boundTo||"vertices"===x.boundTo){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],X=x.value[S.a],V=x.value[S.b],W=x.value[S.c],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=V.x,x.array[y+3]=V.y,x.array[y+4]=W.x,x.array[y+5]=W.y,y+=6;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],X=x.value[S.a],V=
x.value[S.b],W=x.value[S.c],sa=x.value[S.d],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=V.x,x.array[y+3]=V.y,x.array[y+4]=W.x,x.array[y+5]=W.y,x.array[y+6]=sa.x,x.array[y+7]=sa.y,y+=8}else{if("faces"===x.boundTo){G=0;for(Z=Da.length;G<Z;G++)W=V=X=Ja=x.value[Da[G]],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=V.x,x.array[y+3]=V.y,x.array[y+4]=W.x,x.array[y+5]=W.y,y+=6;G=0;for(Z=aa.length;G<Z;G++)sa=W=V=X=Ja=x.value[aa[G]],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=V.x,x.array[y+3]=V.y,x.array[y+
4]=W.x,x.array[y+5]=W.y,x.array[y+6]=sa.x,x.array[y+7]=sa.y,y+=8}}else if(3===x.size){var ea;ea="c"===x.type?["r","g","b"]:["x","y","z"];if(void 0===x.boundTo||"vertices"===x.boundTo){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],X=x.value[S.a],V=x.value[S.b],W=x.value[S.c],x.array[y]=X[ea[0]],x.array[y+1]=X[ea[1]],x.array[y+2]=X[ea[2]],x.array[y+3]=V[ea[0]],x.array[y+4]=V[ea[1]],x.array[y+5]=V[ea[2]],x.array[y+6]=W[ea[0]],x.array[y+7]=W[ea[1]],x.array[y+8]=W[ea[2]],y+=9;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],
X=x.value[S.a],V=x.value[S.b],W=x.value[S.c],sa=x.value[S.d],x.array[y]=X[ea[0]],x.array[y+1]=X[ea[1]],x.array[y+2]=X[ea[2]],x.array[y+3]=V[ea[0]],x.array[y+4]=V[ea[1]],x.array[y+5]=V[ea[2]],x.array[y+6]=W[ea[0]],x.array[y+7]=W[ea[1]],x.array[y+8]=W[ea[2]],x.array[y+9]=sa[ea[0]],x.array[y+10]=sa[ea[1]],x.array[y+11]=sa[ea[2]],y+=12}else if("faces"===x.boundTo){G=0;for(Z=Da.length;G<Z;G++)W=V=X=Ja=x.value[Da[G]],x.array[y]=X[ea[0]],x.array[y+1]=X[ea[1]],x.array[y+2]=X[ea[2]],x.array[y+3]=V[ea[0]],
x.array[y+4]=V[ea[1]],x.array[y+5]=V[ea[2]],x.array[y+6]=W[ea[0]],x.array[y+7]=W[ea[1]],x.array[y+8]=W[ea[2]],y+=9;G=0;for(Z=aa.length;G<Z;G++)sa=W=V=X=Ja=x.value[aa[G]],x.array[y]=X[ea[0]],x.array[y+1]=X[ea[1]],x.array[y+2]=X[ea[2]],x.array[y+3]=V[ea[0]],x.array[y+4]=V[ea[1]],x.array[y+5]=V[ea[2]],x.array[y+6]=W[ea[0]],x.array[y+7]=W[ea[1]],x.array[y+8]=W[ea[2]],x.array[y+9]=sa[ea[0]],x.array[y+10]=sa[ea[1]],x.array[y+11]=sa[ea[2]],y+=12}else if("faceVertices"===x.boundTo){G=0;for(Z=Da.length;G<
Z;G++)Ja=x.value[Da[G]],X=Ja[0],V=Ja[1],W=Ja[2],x.array[y]=X[ea[0]],x.array[y+1]=X[ea[1]],x.array[y+2]=X[ea[2]],x.array[y+3]=V[ea[0]],x.array[y+4]=V[ea[1]],x.array[y+5]=V[ea[2]],x.array[y+6]=W[ea[0]],x.array[y+7]=W[ea[1]],x.array[y+8]=W[ea[2]],y+=9;G=0;for(Z=aa.length;G<Z;G++)Ja=x.value[aa[G]],X=Ja[0],V=Ja[1],W=Ja[2],sa=Ja[3],x.array[y]=X[ea[0]],x.array[y+1]=X[ea[1]],x.array[y+2]=X[ea[2]],x.array[y+3]=V[ea[0]],x.array[y+4]=V[ea[1]],x.array[y+5]=V[ea[2]],x.array[y+6]=W[ea[0]],x.array[y+7]=W[ea[1]],
x.array[y+8]=W[ea[2]],x.array[y+9]=sa[ea[0]],x.array[y+10]=sa[ea[1]],x.array[y+11]=sa[ea[2]],y+=12}}else if(4===x.size)if(void 0===x.boundTo||"vertices"===x.boundTo){G=0;for(Z=Da.length;G<Z;G++)S=vb[Da[G]],X=x.value[S.a],V=x.value[S.b],W=x.value[S.c],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=X.z,x.array[y+3]=X.w,x.array[y+4]=V.x,x.array[y+5]=V.y,x.array[y+6]=V.z,x.array[y+7]=V.w,x.array[y+8]=W.x,x.array[y+9]=W.y,x.array[y+10]=W.z,x.array[y+11]=W.w,y+=12;G=0;for(Z=aa.length;G<Z;G++)S=vb[aa[G]],
X=x.value[S.a],V=x.value[S.b],W=x.value[S.c],sa=x.value[S.d],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=X.z,x.array[y+3]=X.w,x.array[y+4]=V.x,x.array[y+5]=V.y,x.array[y+6]=V.z,x.array[y+7]=V.w,x.array[y+8]=W.x,x.array[y+9]=W.y,x.array[y+10]=W.z,x.array[y+11]=W.w,x.array[y+12]=sa.x,x.array[y+13]=sa.y,x.array[y+14]=sa.z,x.array[y+15]=sa.w,y+=16}else if("faces"===x.boundTo){G=0;for(Z=Da.length;G<Z;G++)W=V=X=Ja=x.value[Da[G]],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=X.z,x.array[y+3]=X.w,x.array[y+
4]=V.x,x.array[y+5]=V.y,x.array[y+6]=V.z,x.array[y+7]=V.w,x.array[y+8]=W.x,x.array[y+9]=W.y,x.array[y+10]=W.z,x.array[y+11]=W.w,y+=12;G=0;for(Z=aa.length;G<Z;G++)sa=W=V=X=Ja=x.value[aa[G]],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=X.z,x.array[y+3]=X.w,x.array[y+4]=V.x,x.array[y+5]=V.y,x.array[y+6]=V.z,x.array[y+7]=V.w,x.array[y+8]=W.x,x.array[y+9]=W.y,x.array[y+10]=W.z,x.array[y+11]=W.w,x.array[y+12]=sa.x,x.array[y+13]=sa.y,x.array[y+14]=sa.z,x.array[y+15]=sa.w,y+=16}else if("faceVertices"===x.boundTo){G=
0;for(Z=Da.length;G<Z;G++)Ja=x.value[Da[G]],X=Ja[0],V=Ja[1],W=Ja[2],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=X.z,x.array[y+3]=X.w,x.array[y+4]=V.x,x.array[y+5]=V.y,x.array[y+6]=V.z,x.array[y+7]=V.w,x.array[y+8]=W.x,x.array[y+9]=W.y,x.array[y+10]=W.z,x.array[y+11]=W.w,y+=12;G=0;for(Z=aa.length;G<Z;G++)Ja=x.value[aa[G]],X=Ja[0],V=Ja[1],W=Ja[2],sa=Ja[3],x.array[y]=X.x,x.array[y+1]=X.y,x.array[y+2]=X.z,x.array[y+3]=X.w,x.array[y+4]=V.x,x.array[y+5]=V.y,x.array[y+6]=V.z,x.array[y+7]=V.w,x.array[y+
8]=W.x,x.array[y+9]=W.y,x.array[y+10]=W.z,x.array[y+11]=W.w,x.array[y+12]=sa.x,x.array[y+13]=sa.y,x.array[y+14]=sa.z,x.array[y+15]=sa.w,y+=16}k.bindBuffer(k.ARRAY_BUFFER,x.buffer);k.bufferData(k.ARRAY_BUFFER,x.array,ra)}}Ra&&(delete pa.__inittedArrays,delete pa.__colorArray,delete pa.__normalArray,delete pa.__tangentArray,delete pa.__uvArray,delete pa.__uv2Array,delete pa.__faceArray,delete pa.__vertexArray,delete pa.__lineArray,delete pa.__skinIndexArray,delete pa.__skinWeightArray)}}T.verticesNeedUpdate=
!1;T.morphTargetsNeedUpdate=!1;T.elementsNeedUpdate=!1;T.uvsNeedUpdate=!1;T.normalsNeedUpdate=!1;T.colorsNeedUpdate=!1;T.tangentsNeedUpdate=!1;T.buffersNeedUpdate=!1;la.attributes&&v(la)}else if(za instanceof THREE.Ribbon){la=e(za,T);ua=la.attributes&&A(la);if(T.verticesNeedUpdate||T.colorsNeedUpdate||T.normalsNeedUpdate||ua){var Wb=T,zc=k.DYNAMIC_DRAW,gd=void 0,hd=void 0,id=void 0,pd=void 0,Ia=void 0,qd=void 0,rd=void 0,sd=void 0,Yc=void 0,Ab=void 0,dd=void 0,Va=void 0,Ob=void 0,Zc=Wb.vertices,$c=
Wb.colors,ie=Wb.normals,Oe=Zc.length,Pe=$c.length,Qe=ie.length,zd=Wb.__vertexArray,Ad=Wb.__colorArray,Bd=Wb.__normalArray,Re=Wb.colorsNeedUpdate,Se=Wb.normalsNeedUpdate,Rd=Wb.__webglCustomAttributesList;if(Wb.verticesNeedUpdate){for(gd=0;gd<Oe;gd++)pd=Zc[gd],Ia=3*gd,zd[Ia]=pd.x,zd[Ia+1]=pd.y,zd[Ia+2]=pd.z;k.bindBuffer(k.ARRAY_BUFFER,Wb.__webglVertexBuffer);k.bufferData(k.ARRAY_BUFFER,zd,zc)}if(Re){for(hd=0;hd<Pe;hd++)qd=$c[hd],Ia=3*hd,Ad[Ia]=qd.r,Ad[Ia+1]=qd.g,Ad[Ia+2]=qd.b;k.bindBuffer(k.ARRAY_BUFFER,
Wb.__webglColorBuffer);k.bufferData(k.ARRAY_BUFFER,Ad,zc)}if(Se){for(id=0;id<Qe;id++)rd=ie[id],Ia=3*id,Bd[Ia]=rd.x,Bd[Ia+1]=rd.y,Bd[Ia+2]=rd.z;k.bindBuffer(k.ARRAY_BUFFER,Wb.__webglNormalBuffer);k.bufferData(k.ARRAY_BUFFER,Bd,zc)}if(Rd){sd=0;for(Yc=Rd.length;sd<Yc;sd++)if(Va=Rd[sd],Va.needsUpdate&&(void 0===Va.boundTo||"vertices"===Va.boundTo)){Ia=0;dd=Va.value.length;if(1===Va.size)for(Ab=0;Ab<dd;Ab++)Va.array[Ab]=Va.value[Ab];else if(2===Va.size)for(Ab=0;Ab<dd;Ab++)Ob=Va.value[Ab],Va.array[Ia]=
Ob.x,Va.array[Ia+1]=Ob.y,Ia+=2;else if(3===Va.size)if("c"===Va.type)for(Ab=0;Ab<dd;Ab++)Ob=Va.value[Ab],Va.array[Ia]=Ob.r,Va.array[Ia+1]=Ob.g,Va.array[Ia+2]=Ob.b,Ia+=3;else for(Ab=0;Ab<dd;Ab++)Ob=Va.value[Ab],Va.array[Ia]=Ob.x,Va.array[Ia+1]=Ob.y,Va.array[Ia+2]=Ob.z,Ia+=3;else if(4===Va.size)for(Ab=0;Ab<dd;Ab++)Ob=Va.value[Ab],Va.array[Ia]=Ob.x,Va.array[Ia+1]=Ob.y,Va.array[Ia+2]=Ob.z,Va.array[Ia+3]=Ob.w,Ia+=4;k.bindBuffer(k.ARRAY_BUFFER,Va.buffer);k.bufferData(k.ARRAY_BUFFER,Va.array,zc)}}}T.verticesNeedUpdate=
!1;T.colorsNeedUpdate=!1;T.normalsNeedUpdate=!1;la.attributes&&v(la)}else if(za instanceof THREE.Line)if(T instanceof THREE.BufferGeometry)(T.verticesNeedUpdate||T.colorsNeedUpdate)&&l(T,k.DYNAMIC_DRAW,!T.dynamic),T.verticesNeedUpdate=!1,T.colorsNeedUpdate=!1;else{la=e(za,T);ua=la.attributes&&A(la);if(T.verticesNeedUpdate||T.colorsNeedUpdate||T.lineDistancesNeedUpdate||ua){var ac=T,Cd=k.DYNAMIC_DRAW,ld=void 0,md=void 0,nd=void 0,Dd=void 0,ab=void 0,Ed=void 0,je=ac.vertices,ke=ac.colors,le=ac.lineDistances,
Ye=je.length,Ze=ke.length,$e=le.length,Fd=ac.__vertexArray,Gd=ac.__colorArray,me=ac.__lineDistanceArray,af=ac.colorsNeedUpdate,bf=ac.lineDistancesNeedUpdate,Sd=ac.__webglCustomAttributesList,Hd=void 0,ne=void 0,Bb=void 0,ed=void 0,Pb=void 0,Xa=void 0;if(ac.verticesNeedUpdate){for(ld=0;ld<Ye;ld++)Dd=je[ld],ab=3*ld,Fd[ab]=Dd.x,Fd[ab+1]=Dd.y,Fd[ab+2]=Dd.z;k.bindBuffer(k.ARRAY_BUFFER,ac.__webglVertexBuffer);k.bufferData(k.ARRAY_BUFFER,Fd,Cd)}if(af){for(md=0;md<Ze;md++)Ed=ke[md],ab=3*md,Gd[ab]=Ed.r,Gd[ab+
1]=Ed.g,Gd[ab+2]=Ed.b;k.bindBuffer(k.ARRAY_BUFFER,ac.__webglColorBuffer);k.bufferData(k.ARRAY_BUFFER,Gd,Cd)}if(bf){for(nd=0;nd<$e;nd++)me[nd]=le[nd];k.bindBuffer(k.ARRAY_BUFFER,ac.__webglLineDistanceBuffer);k.bufferData(k.ARRAY_BUFFER,me,Cd)}if(Sd){Hd=0;for(ne=Sd.length;Hd<ne;Hd++)if(Xa=Sd[Hd],Xa.needsUpdate&&(void 0===Xa.boundTo||"vertices"===Xa.boundTo)){ab=0;ed=Xa.value.length;if(1===Xa.size)for(Bb=0;Bb<ed;Bb++)Xa.array[Bb]=Xa.value[Bb];else if(2===Xa.size)for(Bb=0;Bb<ed;Bb++)Pb=Xa.value[Bb],Xa.array[ab]=
Pb.x,Xa.array[ab+1]=Pb.y,ab+=2;else if(3===Xa.size)if("c"===Xa.type)for(Bb=0;Bb<ed;Bb++)Pb=Xa.value[Bb],Xa.array[ab]=Pb.r,Xa.array[ab+1]=Pb.g,Xa.array[ab+2]=Pb.b,ab+=3;else for(Bb=0;Bb<ed;Bb++)Pb=Xa.value[Bb],Xa.array[ab]=Pb.x,Xa.array[ab+1]=Pb.y,Xa.array[ab+2]=Pb.z,ab+=3;else if(4===Xa.size)for(Bb=0;Bb<ed;Bb++)Pb=Xa.value[Bb],Xa.array[ab]=Pb.x,Xa.array[ab+1]=Pb.y,Xa.array[ab+2]=Pb.z,Xa.array[ab+3]=Pb.w,ab+=4;k.bindBuffer(k.ARRAY_BUFFER,Xa.buffer);k.bufferData(k.ARRAY_BUFFER,Xa.array,Cd)}}}T.verticesNeedUpdate=
!1;T.colorsNeedUpdate=!1;T.lineDistancesNeedUpdate=!1;la.attributes&&v(la)}else if(za instanceof THREE.ParticleSystem)if(T instanceof THREE.BufferGeometry)(T.verticesNeedUpdate||T.colorsNeedUpdate)&&l(T,k.DYNAMIC_DRAW,!T.dynamic),T.verticesNeedUpdate=!1,T.colorsNeedUpdate=!1;else{la=e(za,T);ua=la.attributes&&A(la);if(T.verticesNeedUpdate||T.colorsNeedUpdate||za.sortParticles||ua){var tc=T,Td=k.DYNAMIC_DRAW,od=za,Qb=void 0,uc=void 0,vc=void 0,ka=void 0,wc=void 0,Nc=void 0,Id=tc.vertices,Ud=Id.length,
Vd=tc.colors,oe=Vd.length,Uc=tc.__vertexArray,Vc=tc.__colorArray,Ac=tc.__sortArray,pe=tc.verticesNeedUpdate,qe=tc.colorsNeedUpdate,Bc=tc.__webglCustomAttributesList,hc=void 0,fd=void 0,va=void 0,ic=void 0,Oa=void 0,ja=void 0;if(od.sortParticles){xa.copy(cc);xa.multiply(od.matrixWorld);for(Qb=0;Qb<Ud;Qb++)vc=Id[Qb],hb.copy(vc),hb.applyProjection(xa),Ac[Qb]=[hb.z,Qb];Ac.sort(p);for(Qb=0;Qb<Ud;Qb++)vc=Id[Ac[Qb][1]],ka=3*Qb,Uc[ka]=vc.x,Uc[ka+1]=vc.y,Uc[ka+2]=vc.z;for(uc=0;uc<oe;uc++)ka=3*uc,Nc=Vd[Ac[uc][1]],
Vc[ka]=Nc.r,Vc[ka+1]=Nc.g,Vc[ka+2]=Nc.b;if(Bc){hc=0;for(fd=Bc.length;hc<fd;hc++)if(ja=Bc[hc],void 0===ja.boundTo||"vertices"===ja.boundTo)if(ka=0,ic=ja.value.length,1===ja.size)for(va=0;va<ic;va++)wc=Ac[va][1],ja.array[va]=ja.value[wc];else if(2===ja.size)for(va=0;va<ic;va++)wc=Ac[va][1],Oa=ja.value[wc],ja.array[ka]=Oa.x,ja.array[ka+1]=Oa.y,ka+=2;else if(3===ja.size)if("c"===ja.type)for(va=0;va<ic;va++)wc=Ac[va][1],Oa=ja.value[wc],ja.array[ka]=Oa.r,ja.array[ka+1]=Oa.g,ja.array[ka+2]=Oa.b,ka+=3;else for(va=
0;va<ic;va++)wc=Ac[va][1],Oa=ja.value[wc],ja.array[ka]=Oa.x,ja.array[ka+1]=Oa.y,ja.array[ka+2]=Oa.z,ka+=3;else if(4===ja.size)for(va=0;va<ic;va++)wc=Ac[va][1],Oa=ja.value[wc],ja.array[ka]=Oa.x,ja.array[ka+1]=Oa.y,ja.array[ka+2]=Oa.z,ja.array[ka+3]=Oa.w,ka+=4}}else{if(pe)for(Qb=0;Qb<Ud;Qb++)vc=Id[Qb],ka=3*Qb,Uc[ka]=vc.x,Uc[ka+1]=vc.y,Uc[ka+2]=vc.z;if(qe)for(uc=0;uc<oe;uc++)Nc=Vd[uc],ka=3*uc,Vc[ka]=Nc.r,Vc[ka+1]=Nc.g,Vc[ka+2]=Nc.b;if(Bc){hc=0;for(fd=Bc.length;hc<fd;hc++)if(ja=Bc[hc],ja.needsUpdate&&
(void 0===ja.boundTo||"vertices"===ja.boundTo))if(ic=ja.value.length,ka=0,1===ja.size)for(va=0;va<ic;va++)ja.array[va]=ja.value[va];else if(2===ja.size)for(va=0;va<ic;va++)Oa=ja.value[va],ja.array[ka]=Oa.x,ja.array[ka+1]=Oa.y,ka+=2;else if(3===ja.size)if("c"===ja.type)for(va=0;va<ic;va++)Oa=ja.value[va],ja.array[ka]=Oa.r,ja.array[ka+1]=Oa.g,ja.array[ka+2]=Oa.b,ka+=3;else for(va=0;va<ic;va++)Oa=ja.value[va],ja.array[ka]=Oa.x,ja.array[ka+1]=Oa.y,ja.array[ka+2]=Oa.z,ka+=3;else if(4===ja.size)for(va=
0;va<ic;va++)Oa=ja.value[va],ja.array[ka]=Oa.x,ja.array[ka+1]=Oa.y,ja.array[ka+2]=Oa.z,ja.array[ka+3]=Oa.w,ka+=4}}if(pe||od.sortParticles)k.bindBuffer(k.ARRAY_BUFFER,tc.__webglVertexBuffer),k.bufferData(k.ARRAY_BUFFER,Uc,Td);if(qe||od.sortParticles)k.bindBuffer(k.ARRAY_BUFFER,tc.__webglColorBuffer),k.bufferData(k.ARRAY_BUFFER,Vc,Td);if(Bc){hc=0;for(fd=Bc.length;hc<fd;hc++)if(ja=Bc[hc],ja.needsUpdate||od.sortParticles)k.bindBuffer(k.ARRAY_BUFFER,ja.buffer),k.bufferData(k.ARRAY_BUFFER,ja.array,Td)}}T.verticesNeedUpdate=
!1;T.colorsNeedUpdate=!1;la.attributes&&v(la)}}};this.initMaterial=function(a,b,c,d){var e,f,g,h;a.addEventListener("dispose",sc);var l,m,n,p,q;a instanceof THREE.MeshDepthMaterial?q="depth":a instanceof THREE.MeshNormalMaterial?q="normal":a instanceof THREE.MeshBasicMaterial?q="basic":a instanceof THREE.MeshLambertMaterial?q="lambert":a instanceof THREE.MeshPhongMaterial?q="phong":a instanceof THREE.LineBasicMaterial?q="basic":a instanceof THREE.LineDashedMaterial?q="dashed":a instanceof THREE.ParticleBasicMaterial&&
(q="particle_basic");if(q){var r=THREE.ShaderLib[q];a.uniforms=THREE.UniformsUtils.clone(r.uniforms);a.vertexShader=r.vertexShader;a.fragmentShader=r.fragmentShader}var t,s,u;e=g=s=u=r=0;for(f=b.length;e<f;e++)t=b[e],t.onlyShadow||(t instanceof THREE.DirectionalLight&&g++,t instanceof THREE.PointLight&&s++,t instanceof THREE.SpotLight&&u++,t instanceof THREE.HemisphereLight&&r++);e=g;f=s;g=u;h=r;r=t=0;for(u=b.length;r<u;r++)s=b[r],s.castShadow&&(s instanceof THREE.SpotLight&&t++,s instanceof THREE.DirectionalLight&&
!s.shadowCascade&&t++);p=t;Oc&&d&&d.useVertexTexture?n=1024:(b=k.getParameter(k.MAX_VERTEX_UNIFORM_VECTORS),b=Math.floor((b-20)/4),void 0!==d&&d instanceof THREE.SkinnedMesh&&(b=Math.min(d.bones.length,b),b<d.bones.length&&console.warn("WebGLRenderer: too many bones - "+d.bones.length+", this GPU supports just "+b+" (try OpenGL instead of ANGLE)")),n=b);a:{s=a.fragmentShader;u=a.vertexShader;r=a.uniforms;b=a.attributes;t=a.defines;c={map:!!a.map,envMap:!!a.envMap,lightMap:!!a.lightMap,bumpMap:!!a.bumpMap,
normalMap:!!a.normalMap,specularMap:!!a.specularMap,vertexColors:a.vertexColors,fog:c,useFog:a.fog,fogExp:c instanceof THREE.FogExp2,sizeAttenuation:a.sizeAttenuation,skinning:a.skinning,maxBones:n,useVertexTexture:Oc&&d&&d.useVertexTexture,boneTextureWidth:d&&d.boneTextureWidth,boneTextureHeight:d&&d.boneTextureHeight,morphTargets:a.morphTargets,morphNormals:a.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:e,maxPointLights:f,maxSpotLights:g,maxHemiLights:h,
maxShadows:p,shadowMapEnabled:this.shadowMapEnabled&&d.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:a.alphaTest,metal:a.metal,perPixel:a.perPixel,wrapAround:a.wrapAround,doubleSided:a.side===THREE.DoubleSide,flipSided:a.side===THREE.BackSide};var v,w,A;d=[];q?d.push(q):(d.push(s),d.push(u));for(w in t)d.push(w),d.push(t[w]);for(v in c)d.push(v),d.push(c[v]);q=d.join();v=0;for(w=j.length;v<w;v++)if(d=j[v],d.code===
q){d.usedTimes++;m=d.program;break a}v="SHADOWMAP_TYPE_BASIC";c.shadowMapType===THREE.PCFShadowMap?v="SHADOWMAP_TYPE_PCF":c.shadowMapType===THREE.PCFSoftShadowMap&&(v="SHADOWMAP_TYPE_PCF_SOFT");w=[];for(A in t)d=t[A],!1!==d&&(d="#define "+A+" "+d,w.push(d));d=w.join("\n");A=k.createProgram();w=["precision "+ia+" float;",d,qc?"#define VERTEX_TEXTURES":"",P.gammaInput?"#define GAMMA_INPUT":"",P.gammaOutput?"#define GAMMA_OUTPUT":"",P.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+
c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_HEMI_LIGHTS "+c.maxHemiLights,"#define MAX_SHADOWS "+c.maxShadows,"#define MAX_BONES "+c.maxBones,c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.vertexColors?"#define USE_COLOR":"",c.skinning?"#define USE_SKINNING":"",
c.useVertexTexture?"#define BONE_TEXTURE":"",c.boneTextureWidth?"#define N_BONE_PIXEL_X "+c.boneTextureWidth.toFixed(1):"",c.boneTextureHeight?"#define N_BONE_PIXEL_Y "+c.boneTextureHeight.toFixed(1):"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals?"#define USE_MORPHNORMALS":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?"#define WRAP_AROUND":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?
"#define "+v:"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");
v=["precision "+ia+" float;",c.bumpMap||c.normalMap?"#extension GL_OES_standard_derivatives : enable":"",d,"#define MAX_DIR_LIGHTS "+c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_HEMI_LIGHTS "+c.maxHemiLights,"#define MAX_SHADOWS "+c.maxShadows,c.alphaTest?"#define ALPHATEST "+c.alphaTest:"",P.gammaInput?"#define GAMMA_INPUT":"",P.gammaOutput?"#define GAMMA_OUTPUT":"",P.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":
"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.vertexColors?"#define USE_COLOR":"",c.metal?"#define METAL":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?"#define WRAP_AROUND":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":
"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+v:"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");v=D("fragment",v+s);w=D("vertex",w+u);k.attachShader(A,w);k.attachShader(A,v);k.linkProgram(A);k.getProgramParameter(A,k.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+k.getProgramParameter(A,k.VALIDATE_STATUS)+", gl error ["+
k.getError()+"]");k.deleteShader(v);k.deleteShader(w);A.uniforms={};A.attributes={};var z;v="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" ");c.useVertexTexture?v.push("boneTexture"):v.push("boneGlobalMatrices");for(z in r)v.push(z);z=v;v=0;for(w=z.length;v<w;v++)r=z[v],A.uniforms[r]=k.getUniformLocation(A,r);v="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(z=0;z<c.maxMorphTargets;z++)v.push("morphTarget"+
z);for(z=0;z<c.maxMorphNormals;z++)v.push("morphNormal"+z);for(m in b)v.push(m);m=v;z=0;for(b=m.length;z<b;z++)v=m[z],A.attributes[v]=k.getAttribLocation(A,v);A.id=ya++;j.push({program:A,code:q,usedTimes:1});P.info.memory.programs=j.length;m=A}a.program=m;z=a.program.attributes;if(a.morphTargets){a.numSupportedMorphTargets=0;b="morphTarget";for(m=0;m<this.maxMorphTargets;m++)A=b+m,0<=z[A]&&a.numSupportedMorphTargets++}if(a.morphNormals){a.numSupportedMorphNormals=0;b="morphNormal";for(m=0;m<this.maxMorphNormals;m++)A=
b+m,0<=z[A]&&a.numSupportedMorphNormals++}a.uniformsList=[];for(l in a.uniforms)a.uniformsList.push([a.uniforms[l],l])};this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?k.disable(k.CULL_FACE):(b===THREE.FrontFaceDirectionCW?k.frontFace(k.CW):k.frontFace(k.CCW),a===THREE.CullFaceBack?k.cullFace(k.BACK):a===THREE.CullFaceFront?k.cullFace(k.FRONT):k.cullFace(k.FRONT_AND_BACK),k.enable(k.CULL_FACE))};this.setMaterialFaces=function(a){var b=a.side===THREE.DoubleSide;a=a.side===THREE.BackSide;da!==
b&&(b?k.disable(k.CULL_FACE):k.enable(k.CULL_FACE),da=b);ta!==a&&(a?k.frontFace(k.CW):k.frontFace(k.CCW),ta=a)};this.setDepthTest=function(a){la!==a&&(a?k.enable(k.DEPTH_TEST):k.disable(k.DEPTH_TEST),la=a)};this.setDepthWrite=function(a){fb!==a&&(k.depthMask(a),fb=a)};this.setBlending=function(a,b,c,d){a!==na&&(a===THREE.NoBlending?k.disable(k.BLEND):a===THREE.AdditiveBlending?(k.enable(k.BLEND),k.blendEquation(k.FUNC_ADD),k.blendFunc(k.SRC_ALPHA,k.ONE)):a===THREE.SubtractiveBlending?(k.enable(k.BLEND),
k.blendEquation(k.FUNC_ADD),k.blendFunc(k.ZERO,k.ONE_MINUS_SRC_COLOR)):a===THREE.MultiplyBlending?(k.enable(k.BLEND),k.blendEquation(k.FUNC_ADD),k.blendFunc(k.ZERO,k.SRC_COLOR)):a===THREE.CustomBlending?k.enable(k.BLEND):(k.enable(k.BLEND),k.blendEquationSeparate(k.FUNC_ADD,k.FUNC_ADD),k.blendFuncSeparate(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA)),na=a);if(a===THREE.CustomBlending){if(b!==Ba&&(k.blendEquation(E(b)),Ba=b),c!==wb||d!==xb)k.blendFunc(E(c),E(d)),wb=c,xb=d}else xb=
wb=Ba=null};this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",Qc),a.__webglTexture=k.createTexture(),P.info.memory.textures++);k.activeTexture(k.TEXTURE0+b);k.bindTexture(k.TEXTURE_2D,a.__webglTexture);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,a.flipY);k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);k.pixelStorei(k.UNPACK_ALIGNMENT,a.unpackAlignment);var c=a.image,d=0===(c.width&c.width-1)&&0===(c.height&c.height-1),e=E(a.format),
f=E(a.type);M(k.TEXTURE_2D,a,d);var g=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<g.length&&d){for(var h=0,j=g.length;h<j;h++)c=g[h],k.texImage2D(k.TEXTURE_2D,h,e,c.width,c.height,0,e,f,c.data);a.generateMipmaps=!1}else k.texImage2D(k.TEXTURE_2D,0,e,c.width,c.height,0,e,f,c.data);else if(a instanceof THREE.CompressedTexture){h=0;for(j=g.length;h<j;h++)c=g[h],k.compressedTexImage2D(k.TEXTURE_2D,h,e,c.width,c.height,0,c.data)}else if(0<g.length&&d){h=0;for(j=g.length;h<j;h++)c=g[h],k.texImage2D(k.TEXTURE_2D,
h,e,e,f,c);a.generateMipmaps=!1}else k.texImage2D(k.TEXTURE_2D,0,e,e,f,a.image);a.generateMipmaps&&d&&k.generateMipmap(k.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else k.activeTexture(k.TEXTURE0+b),k.bindTexture(k.TEXTURE_2D,a.__webglTexture)};this.setRenderTarget=function(a){var b=a instanceof THREE.WebGLRenderTargetCube;if(a&&!a.__webglFramebuffer){void 0===a.depthBuffer&&(a.depthBuffer=!0);void 0===a.stencilBuffer&&(a.stencilBuffer=!0);a.addEventListener("dispose",R);a.__webglTexture=
k.createTexture();P.info.memory.textures++;var c=0===(a.width&a.width-1)&&0===(a.height&a.height-1),d=E(a.format),e=E(a.type);if(b){a.__webglFramebuffer=[];a.__webglRenderbuffer=[];k.bindTexture(k.TEXTURE_CUBE_MAP,a.__webglTexture);M(k.TEXTURE_CUBE_MAP,a,c);for(var f=0;6>f;f++){a.__webglFramebuffer[f]=k.createFramebuffer();a.__webglRenderbuffer[f]=k.createRenderbuffer();k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,d,a.width,a.height,0,d,e,null);var g=a,h=k.TEXTURE_CUBE_MAP_POSITIVE_X+f;k.bindFramebuffer(k.FRAMEBUFFER,
a.__webglFramebuffer[f]);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,h,g.__webglTexture,0);I(a.__webglRenderbuffer[f],a)}c&&k.generateMipmap(k.TEXTURE_CUBE_MAP)}else a.__webglFramebuffer=k.createFramebuffer(),a.__webglRenderbuffer=a.shareDepthFrom?a.shareDepthFrom.__webglRenderbuffer:k.createRenderbuffer(),k.bindTexture(k.TEXTURE_2D,a.__webglTexture),M(k.TEXTURE_2D,a,c),k.texImage2D(k.TEXTURE_2D,0,d,a.width,a.height,0,d,e,null),d=k.TEXTURE_2D,k.bindFramebuffer(k.FRAMEBUFFER,a.__webglFramebuffer),
k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,d,a.__webglTexture,0),a.shareDepthFrom?a.depthBuffer&&!a.stencilBuffer?k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,a.__webglRenderbuffer):a.depthBuffer&&a.stencilBuffer&&k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_STENCIL_ATTACHMENT,k.RENDERBUFFER,a.__webglRenderbuffer):I(a.__webglRenderbuffer,a),c&&k.generateMipmap(k.TEXTURE_2D);b?k.bindTexture(k.TEXTURE_CUBE_MAP,null):k.bindTexture(k.TEXTURE_2D,null);k.bindRenderbuffer(k.RENDERBUFFER,
null);k.bindFramebuffer(k.FRAMEBUFFER,null)}a?(b=b?a.__webglFramebuffer[a.activeCubeFace]:a.__webglFramebuffer,c=a.width,a=a.height,e=d=0):(b=null,c=Lb,a=bb,d=kb,e=Kb);b!==mb&&(k.bindFramebuffer(k.FRAMEBUFFER,b),k.viewport(d,e,c,a),mb=b);rb=c;nb=a};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};
THREE.WebGLRenderTarget=function(a,b,c){THREE.EventDispatcher.call(this);this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);
this.format=void 0!==c.format?c.format:THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};
THREE.WebGLRenderTarget.prototype.clone=function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;a.shareDepthFrom=this.shareDepthFrom;return a};
THREE.WebGLRenderTarget.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};
THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};
THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=null};
THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];
this.material=this.color=null;this.uvs=[[]];this.z=null};THREE.RenderableObject=function(){this.z=this.object=null};THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=this.object=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.material=null};
THREE.GeometryUtils={merge:function(a,b){var c,d,e=a.vertices.length,f=b instanceof THREE.Mesh?b.geometry:b,g=a.vertices,h=f.vertices,l=a.faces,m=f.faces,n=a.faceVertexUvs[0],f=f.faceVertexUvs[0];b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),c=b.matrix,d=new THREE.Matrix3,d.getInverse(c),d.transpose());for(var q=0,p=h.length;q<p;q++){var t=h[q].clone();c&&t.applyMatrix4(c);g.push(t)}q=0;for(p=m.length;q<p;q++){var t=m[q],u,r,s=t.vertexNormals,A=t.vertexColors;t instanceof THREE.Face3?
u=new THREE.Face3(t.a+e,t.b+e,t.c+e):t instanceof THREE.Face4&&(u=new THREE.Face4(t.a+e,t.b+e,t.c+e,t.d+e));u.normal.copy(t.normal);d&&u.normal.applyMatrix3(d).normalize();g=0;for(h=s.length;g<h;g++)r=s[g].clone(),d&&r.applyMatrix3(d).normalize(),u.vertexNormals.push(r);u.color.copy(t.color);g=0;for(h=A.length;g<h;g++)r=A[g],u.vertexColors.push(r.clone());u.materialIndex=t.materialIndex;u.centroid.copy(t.centroid);c&&u.centroid.applyMatrix4(c);l.push(u)}q=0;for(p=f.length;q<p;q++){c=f[q];d=[];g=0;
for(h=c.length;g<h;g++)d.push(new THREE.Vector2(c[g].x,c[g].y));n.push(d)}},removeMaterials:function(a,b){for(var c={},d=0,e=b.length;d<e;d++)c[b[d]]=!0;for(var f,g=[],d=0,e=a.faces.length;d<e;d++)f=a.faces[d],f.materialIndex in c||g.push(f);a.faces=g},randomPointInTriangle:function(a,b,c){var d,e,f,g=new THREE.Vector3,h=THREE.GeometryUtils.__v1;d=THREE.GeometryUtils.random();e=THREE.GeometryUtils.random();1<d+e&&(d=1-d,e=1-e);f=1-d-e;g.copy(a);g.multiplyScalar(d);h.copy(b);h.multiplyScalar(e);g.add(h);
h.copy(c);h.multiplyScalar(f);g.add(h);return g},randomPointInFace:function(a,b,c){var d,e,f;if(a instanceof THREE.Face3)return d=b.vertices[a.a],e=b.vertices[a.b],f=b.vertices[a.c],THREE.GeometryUtils.randomPointInTriangle(d,e,f);if(a instanceof THREE.Face4){d=b.vertices[a.a];e=b.vertices[a.b];f=b.vertices[a.c];b=b.vertices[a.d];var g;c?a._area1&&a._area2?(c=a._area1,g=a._area2):(c=THREE.GeometryUtils.triangleArea(d,e,b),g=THREE.GeometryUtils.triangleArea(e,f,b),a._area1=c,a._area2=g):(c=THREE.GeometryUtils.triangleArea(d,
e,b),g=THREE.GeometryUtils.triangleArea(e,f,b));return THREE.GeometryUtils.random()*(c+g)<c?THREE.GeometryUtils.randomPointInTriangle(d,e,b):THREE.GeometryUtils.randomPointInTriangle(e,f,b)}},randomPointsInGeometry:function(a,b){function c(a){function b(c,d){if(d<c)return c;var e=c+Math.floor((d-c)/2);return m[e]>a?b(c,e-1):m[e]<a?b(e+1,d):e}return b(0,m.length-1)}var d,e,f=a.faces,g=a.vertices,h=f.length,l=0,m=[],n,q,p,t;for(e=0;e<h;e++)d=f[e],d instanceof THREE.Face3?(n=g[d.a],q=g[d.b],p=g[d.c],
d._area=THREE.GeometryUtils.triangleArea(n,q,p)):d instanceof THREE.Face4&&(n=g[d.a],q=g[d.b],p=g[d.c],t=g[d.d],d._area1=THREE.GeometryUtils.triangleArea(n,q,t),d._area2=THREE.GeometryUtils.triangleArea(q,p,t),d._area=d._area1+d._area2),l+=d._area,m[e]=l;d=[];for(e=0;e<b;e++)g=THREE.GeometryUtils.random()*l,g=c(g),d[e]=THREE.GeometryUtils.randomPointInFace(f[g],a,!0);return d},triangleArea:function(a,b,c){var d=THREE.GeometryUtils.__v1,e=THREE.GeometryUtils.__v2;d.subVectors(b,a);e.subVectors(c,a);
d.cross(e);return 0.5*d.length()},center:function(a){a.computeBoundingBox();var b=a.boundingBox,c=new THREE.Vector3;c.addVectors(b.min,b.max);c.multiplyScalar(-0.5);a.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z));a.computeBoundingBox();return c},normalizeUVs:function(a){a=a.faceVertexUvs[0];for(var b=0,c=a.length;b<c;b++)for(var d=a[b],e=0,f=d.length;e<f;e++)1!==d[e].x&&(d[e].x-=Math.floor(d[e].x)),1!==d[e].y&&(d[e].y-=Math.floor(d[e].y))},triangulateQuads:function(a){var b,c,d,e,
f=[],g=[],h=[];b=0;for(c=a.faceUvs.length;b<c;b++)g[b]=[];b=0;for(c=a.faceVertexUvs.length;b<c;b++)h[b]=[];b=0;for(c=a.faces.length;b<c;b++)if(d=a.faces[b],d instanceof THREE.Face4){e=d.a;var l=d.b,m=d.c,n=d.d,q=new THREE.Face3,p=new THREE.Face3;q.color.copy(d.color);p.color.copy(d.color);q.materialIndex=d.materialIndex;p.materialIndex=d.materialIndex;q.a=e;q.b=l;q.c=n;p.a=l;p.b=m;p.c=n;4===d.vertexColors.length&&(q.vertexColors[0]=d.vertexColors[0].clone(),q.vertexColors[1]=d.vertexColors[1].clone(),
q.vertexColors[2]=d.vertexColors[3].clone(),p.vertexColors[0]=d.vertexColors[1].clone(),p.vertexColors[1]=d.vertexColors[2].clone(),p.vertexColors[2]=d.vertexColors[3].clone());f.push(q,p);d=0;for(e=a.faceVertexUvs.length;d<e;d++)a.faceVertexUvs[d].length&&(q=a.faceVertexUvs[d][b],l=q[1],m=q[2],n=q[3],q=[q[0].clone(),l.clone(),n.clone()],l=[l.clone(),m.clone(),n.clone()],h[d].push(q,l));d=0;for(e=a.faceUvs.length;d<e;d++)a.faceUvs[d].length&&(l=a.faceUvs[d][b],g[d].push(l,l))}else{f.push(d);d=0;for(e=
a.faceUvs.length;d<e;d++)g[d].push(a.faceUvs[d][b]);d=0;for(e=a.faceVertexUvs.length;d<e;d++)h[d].push(a.faceVertexUvs[d][b])}a.faces=f;a.faceUvs=g;a.faceVertexUvs=h;a.computeCentroids();a.computeFaceNormals();a.computeVertexNormals();a.hasTangents&&a.computeTangents()},setMaterialIndex:function(a,b,c,d){a=a.faces;d=d||a.length-1;for(c=c||0;c<=d;c++)a[c].materialIndex=b}};THREE.GeometryUtils.random=THREE.Math.random16;THREE.GeometryUtils.__v1=new THREE.Vector3;THREE.GeometryUtils.__v2=new THREE.Vector3;
THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(a,b,c,d){var e=new Image,f=new THREE.Texture(e,b);b=new THREE.ImageLoader;b.addEventListener("load",function(a){f.image=a.content;f.needsUpdate=!0;c&&c(f)});b.addEventListener("error",function(a){d&&d(a.message)});b.crossOrigin=this.crossOrigin;b.load(a,e);f.sourceFile=a;return f},loadCompressedTexture:function(a,b,c,d){var e=new THREE.CompressedTexture;e.mapping=b;var f=new XMLHttpRequest;f.onload=function(){var a=THREE.ImageUtils.parseDDS(f.response,
!0);e.format=a.format;e.mipmaps=a.mipmaps;e.image.width=a.width;e.image.height=a.height;e.generateMipmaps=!1;e.needsUpdate=!0;c&&c(e)};f.onerror=d;f.open("GET",a,!0);f.responseType="arraybuffer";f.send(null);return e},loadTextureCube:function(a,b,c,d){var e=[];e.loadCount=0;var f=new THREE.Texture;f.image=e;void 0!==b&&(f.mapping=b);f.flipY=!1;b=0;for(var g=a.length;b<g;++b){var h=new Image;e[b]=h;h.onload=function(){e.loadCount+=1;6===e.loadCount&&(f.needsUpdate=!0,c&&c(f))};h.onerror=d;h.crossOrigin=
this.crossOrigin;h.src=a[b]}return f},loadCompressedTextureCube:function(a,b,c,d){var e=[];e.loadCount=0;var f=new THREE.CompressedTexture;f.image=e;void 0!==b&&(f.mapping=b);f.flipY=!1;f.generateMipmaps=!1;b=function(a,b){return function(){var d=THREE.ImageUtils.parseDDS(a.response,!0);b.format=d.format;b.mipmaps=d.mipmaps;b.width=d.width;b.height=d.height;e.loadCount+=1;6===e.loadCount&&(f.format=d.format,f.needsUpdate=!0,c&&c(f))}};if(a instanceof Array)for(var g=0,h=a.length;g<h;++g){var l={};
e[g]=l;var m=new XMLHttpRequest;m.onload=b(m,l);m.onerror=d;l=a[g];m.open("GET",l,!0);m.responseType="arraybuffer";m.send(null)}else m=new XMLHttpRequest,m.onload=function(){var a=THREE.ImageUtils.parseDDS(m.response,!0);if(a.isCubemap){for(var b=a.mipmaps.length/a.mipmapCount,d=0;d<b;d++){e[d]={mipmaps:[]};for(var g=0;g<a.mipmapCount;g++)e[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+g]),e[d].format=a.format,e[d].width=a.width,e[d].height=a.height}f.format=a.format;f.needsUpdate=!0;c&&c(f)}},m.onerror=
d,m.open("GET",a,!0),m.responseType="arraybuffer",m.send(null);return f},parseDDS:function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}var d={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},e=c("DXT1"),f=c("DXT3"),g=c("DXT5"),h=new Int32Array(a,0,31);if(542327876!==h[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),d;if(!h[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),
d;var l=h[21];switch(l){case e:e=8;d.format=THREE.RGB_S3TC_DXT1_Format;break;case f:e=16;d.format=THREE.RGBA_S3TC_DXT3_Format;break;case g:e=16;d.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(l&255,l>>8&255,l>>16&255,l>>24&255)),d}d.mipmapCount=1;h[2]&131072&&!1!==b&&(d.mipmapCount=Math.max(1,h[7]));d.isCubemap=h[28]&512?!0:!1;d.width=h[4];d.height=h[3];for(var h=h[1]+4,f=d.width,g=d.height,l=d.isCubemap?
6:1,m=0;m<l;m++){for(var n=0;n<d.mipmapCount;n++){var q=Math.max(4,f)/4*Math.max(4,g)/4*e,p={data:new Uint8Array(a,h,q),width:f,height:g};d.mipmaps.push(p);h+=q;f=Math.max(0.5*f,1);g=Math.max(0.5*g,1)}f=d.width;g=d.height}return d},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]};b|=1;var d=a.width,e=a.height,f=document.createElement("canvas");f.width=d;f.height=e;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,
0,d,e).data,l=g.createImageData(d,e),m=l.data,n=0;n<d;n++)for(var q=0;q<e;q++){var p=0>q-1?0:q-1,t=q+1>e-1?e-1:q+1,u=0>n-1?0:n-1,r=n+1>d-1?d-1:n+1,s=[],A=[0,0,h[4*(q*d+n)]/255*b];s.push([-1,0,h[4*(q*d+u)]/255*b]);s.push([-1,-1,h[4*(p*d+u)]/255*b]);s.push([0,-1,h[4*(p*d+n)]/255*b]);s.push([1,-1,h[4*(p*d+r)]/255*b]);s.push([1,0,h[4*(q*d+r)]/255*b]);s.push([1,1,h[4*(t*d+r)]/255*b]);s.push([0,1,h[4*(t*d+n)]/255*b]);s.push([-1,1,h[4*(t*d+u)]/255*b]);p=[];u=s.length;for(t=0;t<u;t++){var r=s[t],v=s[(t+1)%
u],r=[r[0]-A[0],r[1]-A[1],r[2]-A[2]],v=[v[0]-A[0],v[1]-A[1],v[2]-A[2]];p.push(c([r[1]*v[2]-r[2]*v[1],r[2]*v[0]-r[0]*v[2],r[0]*v[1]-r[1]*v[0]]))}s=[0,0,0];for(t=0;t<p.length;t++)s[0]+=p[t][0],s[1]+=p[t][1],s[2]+=p[t][2];s[0]/=p.length;s[1]/=p.length;s[2]/=p.length;A=4*(q*d+n);m[A]=255*((s[0]+1)/2)|0;m[A+1]=255*((s[1]+1)/2)|0;m[A+2]=255*s[2]|0;m[A+3]=255}g.putImageData(l,0,0);return f},generateDataTexture:function(a,b,c){var d=a*b,e=new Uint8Array(3*d),f=Math.floor(255*c.r),g=Math.floor(255*c.g);c=
Math.floor(255*c.b);for(var h=0;h<d;h++)e[3*h]=f,e[3*h+1]=g,e[3*h+2]=c;a=new THREE.DataTexture(e,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,d=0,e=b.length;d<e;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=a},drawText:function(a){var b=this.getFace(),c=this.size/b.resolution,d=0,e=
String(a).split(""),f=e.length,g=[];for(a=0;a<f;a++){var h=new THREE.Path,h=this.extractGlyphPoints(e[a],b,c,d,h),d=d+h.offset;g.push(h.path)}return{paths:g,offset:d/2}},extractGlyphPoints:function(a,b,c,d,e){var f=[],g,h,l,m,n,q,p,t,u,r,s,A=b.glyphs[a]||b.glyphs["?"];if(A){if(A.o){b=A._cachedOutline||(A._cachedOutline=A.o.split(" "));m=b.length;for(a=0;a<m;)switch(l=b[a++],l){case "m":l=b[a++]*c+d;n=b[a++]*c;e.moveTo(l,n);break;case "l":l=b[a++]*c+d;n=b[a++]*c;e.lineTo(l,n);break;case "q":l=b[a++]*
c+d;n=b[a++]*c;t=b[a++]*c+d;u=b[a++]*c;e.quadraticCurveTo(t,u,l,n);if(g=f[f.length-1]){q=g.x;p=g.y;g=1;for(h=this.divisions;g<=h;g++){var v=g/h;THREE.Shape.Utils.b2(v,q,t,l);THREE.Shape.Utils.b2(v,p,u,n)}}break;case "b":if(l=b[a++]*c+d,n=b[a++]*c,t=b[a++]*c+d,u=b[a++]*-c,r=b[a++]*c+d,s=b[a++]*-c,e.bezierCurveTo(l,n,t,u,r,s),g=f[f.length-1]){q=g.x;p=g.y;g=1;for(h=this.divisions;g<=h;g++)v=g/h,THREE.Shape.Utils.b3(v,q,t,r,l),THREE.Shape.Utils.b3(v,p,u,s,n)}}}return{offset:A.ha*c,path:e}}}};
THREE.FontUtils.generateShapes=function(a,b){b=b||{};var c=void 0!==b.curveSegments?b.curveSegments:4,d=void 0!==b.font?b.font:"helvetiker",e=void 0!==b.weight?b.weight:"normal",f=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=d;THREE.FontUtils.weight=e;THREE.FontUtils.style=f;c=THREE.FontUtils.drawText(a).paths;d=[];e=0;for(f=c.length;e<f;e++)Array.prototype.push.apply(d,c[e].toShapes());return d};
(function(a){var b=function(a){for(var b=a.length,e=0,f=b-1,g=0;g<b;f=g++)e+=a[f].x*a[g].y-a[g].x*a[f].y;return 0.5*e};a.Triangulate=function(a,d){var e=a.length;if(3>e)return null;var f=[],g=[],h=[],l,m,n;if(0<b(a))for(m=0;m<e;m++)g[m]=m;else for(m=0;m<e;m++)g[m]=e-1-m;var q=2*e;for(m=e-1;2<e;){if(0>=q--){console.log("Warning, unable to triangulate polygon!");break}l=m;e<=l&&(l=0);m=l+1;e<=m&&(m=0);n=m+1;e<=n&&(n=0);var p;a:{var t=void 0,u=void 0,r=void 0,s=void 0,A=void 0,v=void 0,B=void 0,w=void 0,
t=a[g[l]].x,u=a[g[l]].y,r=a[g[m]].x,s=a[g[m]].y,A=a[g[n]].x,v=a[g[n]].y;if(1E-10>(r-t)*(v-u)-(s-u)*(A-t))p=!1;else{var F=void 0,K=void 0,C=void 0,z=void 0,N=void 0,O=void 0,L=void 0,U=void 0,D=void 0,M=void 0,D=U=L=w=B=void 0,F=A-r,K=v-s,C=t-A,z=u-v,N=r-t,O=s-u;for(p=0;p<e;p++)if(!(p===l||p===m||p===n))if(B=a[g[p]].x,w=a[g[p]].y,L=B-t,U=w-u,D=B-r,M=w-s,B-=A,w-=v,D=F*M-K*D,L=N*U-O*L,U=C*w-z*B,0<=D&&0<=U&&0<=L){p=!1;break a}p=!0}}if(p){f.push([a[g[l]],a[g[m]],a[g[n]]]);h.push([g[l],g[m],g[n]]);l=m;
for(n=m+1;n<e;l++,n++)g[l]=g[n];e--;q=2*e}}return d?h:f};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){a=this.getUtoTmapping(a);return this.getPoint(a)};
THREE.Curve.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c};THREE.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c};THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};
THREE.Curve.prototype.getLengths=function(a){a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),e,f=0;b.push(0);for(e=1;e<=a;e++)c=this.getPoint(e/a),f+=c.distanceTo(d),b.push(f),d=c;return this.cacheArcLengths=b};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};
THREE.Curve.prototype.getUtoTmapping=function(a,b){var c=this.getLengths(),d=0,e=c.length,f;f=b?b:a*c[e-1];for(var g=0,h=e-1,l;g<=h;)if(d=Math.floor(g+(h-g)/2),l=c[d]-f,0>l)g=d+1;else if(0<l)h=d-1;else{h=d;break}d=h;if(c[d]==f)return d/(e-1);g=c[d];return(d+(f-g)/(c[d+1]-g))/(e-1)};THREE.Curve.prototype.getTangent=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()};
THREE.Curve.prototype.getTangentAt=function(a){a=this.getUtoTmapping(a);return this.getTangent(a)};THREE.LineCurve=function(a,b){this.v1=a;this.v2=b};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);b.multiplyScalar(a).add(this.v1);return b};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};
THREE.QuadraticBezierCurve=function(a,b,c){this.v0=a;this.v1=b;this.v2=c};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(b,a)};
THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.y,this.v1.y,this.v2.y);b=new THREE.Vector2(b,a);b.normalize();return b};THREE.CubicBezierCurve=function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.CubicBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(b,a)};THREE.CubicBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);b=new THREE.Vector2(b,a);b.normalize();return b};
THREE.SplineCurve=function(a){this.points=void 0==a?[]:a};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(a){var b=new THREE.Vector2,c=[],d=this.points,e;e=(d.length-1)*a;a=Math.floor(e);e-=a;c[0]=0==a?a:a-1;c[1]=a;c[2]=a>d.length-2?d.length-1:a+1;c[3]=a>d.length-3?d.length-1:a+2;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,e);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,e);return b};
THREE.EllipseCurve=function(a,b,c,d,e,f,g){this.aX=a;this.aY=b;this.xRadius=c;this.yRadius=d;this.aStartAngle=e;this.aEndAngle=f;this.aClockwise=g};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.getPoint=function(a){var b=this.aEndAngle-this.aStartAngle;this.aClockwise||(a=1-a);b=this.aStartAngle+a*b;a=this.aX+this.xRadius*Math.cos(b);b=this.aY+this.yRadius*Math.sin(b);return new THREE.Vector2(a,b)};
THREE.ArcCurve=function(a,b,c,d,e,f){THREE.EllipseCurve.call(this,a,b,c,c,d,e,f)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);
THREE.Curve.Utils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,e){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*e},tangentSpline:function(a){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,e){a=0.5*(c-a);d=0.5*(d-b);var f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}};
THREE.Curve.create=function(a,b){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.getPoint=b;return a};THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a;this.v2=b},function(a){var b=new THREE.Vector3;b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b});
THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,b,c){this.v0=a;this.v1=b;this.v2=c},function(a){var b,c;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);c=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);a=THREE.Shape.Utils.b2(a,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(b,c,a)});
THREE.CubicBezierCurve3=THREE.Curve.create(function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d},function(a){var b,c;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);c=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);a=THREE.Shape.Utils.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(b,c,a)});
THREE.SplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,e;a*=d.length-1;e=Math.floor(a);a-=e;c[0]=0==e?e:e-1;c[1]=e;c[2]=e>d.length-2?d.length-1:e+1;c[3]=e>d.length-3?d.length-1:e+2;e=d[c[0]];var f=d[c[1]],g=d[c[2]],c=d[c[3]];b.x=THREE.Curve.Utils.interpolate(e.x,f.x,g.x,c.x,a);b.y=THREE.Curve.Utils.interpolate(e.y,f.y,g.y,c.y,a);b.z=THREE.Curve.Utils.interpolate(e.z,f.z,g.z,c.z,a);return b});
THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,e;e=(d.length-0)*a;a=Math.floor(e);e-=a;a+=0<a?0:(Math.floor(Math.abs(a)/d.length)+1)*d.length;c[0]=(a-1)%d.length;c[1]=a%d.length;c[2]=(a+1)%d.length;c[3]=(a+2)%d.length;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,e);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,e);b.z=THREE.Curve.Utils.interpolate(d[c[0]].z,
d[c[1]].z,d[c[2]].z,d[c[3]].z,e);return b});THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))};
THREE.CurvePath.prototype.getPoint=function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],b=1-b/a.getLength(),a.getPointAt(b);a++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a=[],b=0,c,d=this.curves.length;for(c=0;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a};
THREE.CurvePath.prototype.getBoundingBox=function(){var a=this.getPoints(),b,c,d,e,f,g;b=c=Number.NEGATIVE_INFINITY;e=f=Number.POSITIVE_INFINITY;var h,l,m,n,q=a[0]instanceof THREE.Vector3;n=q?new THREE.Vector3:new THREE.Vector2;l=0;for(m=a.length;l<m;l++)h=a[l],h.x>b?b=h.x:h.x<e&&(e=h.x),h.y>c?c=h.y:h.y<f&&(f=h.y),q&&(h.z>d?d=h.z:h.z<g&&(g=h.z)),n.add(h);a={minX:e,minY:f,maxX:b,maxY:c,centroid:n.divideScalar(m)};q&&(a.maxZ=d,a.minZ=g);return a};
THREE.CurvePath.prototype.createPointsGeometry=function(a){a=this.getPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){a=this.getSpacedPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(new THREE.Vector3(a[c].x,a[c].y,a[c].z||0));return b};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};
THREE.CurvePath.prototype.getTransformedPoints=function(a,b){var c=this.getPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(a,b){var c=this.getSpacedPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};
THREE.CurvePath.prototype.getWrapPoints=function(a,b){var c=this.getBoundingBox(),d,e,f,g,h,l;d=0;for(e=a.length;d<e;d++)f=a[d],g=f.x,h=f.y,l=g/c.maxX,l=b.getUtoTmapping(l,g),g=b.getPoint(l),h=b.getNormalVector(l).multiplyScalar(h),f.x=g.x+h.x,f.y=g.y+h.y;return a};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),
this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;
THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)};
THREE.Path.prototype.moveTo=function(a,b){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};THREE.Path.prototype.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,d=new THREE.LineCurve(new THREE.Vector2(d[d.length-2],d[d.length-1]),new THREE.Vector2(a,b));this.curves.push(d);this.actions.push({action:THREE.PathActions.LINE_TO,args:c})};
THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var e=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,f=new THREE.QuadraticBezierCurve(new THREE.Vector2(f[f.length-2],f[f.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d));this.curves.push(f);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:e})};
THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,e,f){var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,h=new THREE.CubicBezierCurve(new THREE.Vector2(h[h.length-2],h[h.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(e,f));this.curves.push(h);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:g})};
THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a);c=new THREE.SplineCurve(c);this.curves.push(c);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:b})};THREE.Path.prototype.arc=function(a,b,c,d,e,f){var g=this.actions[this.actions.length-1].args;this.absarc(a+g[g.length-2],b+g[g.length-1],c,d,e,f)};
THREE.Path.prototype.absarc=function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)};THREE.Path.prototype.ellipse=function(a,b,c,d,e,f,g){var h=this.actions[this.actions.length-1].args;this.absellipse(a+h[h.length-2],b+h[h.length-1],c,d,e,f,g)};THREE.Path.prototype.absellipse=function(a,b,c,d,e,f,g){var h=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(a,b,c,d,e,f,g);this.curves.push(l);l=l.getPoint(g?1:0);h.push(l.x);h.push(l.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:h})};
THREE.Path.prototype.getSpacedPoints=function(a){a||(a=40);for(var b=[],c=0;c<a;c++)b.push(this.getPoint(c/a));return b};
THREE.Path.prototype.getPoints=function(a,b){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,b);a=a||12;var c=[],d,e,f,g,h,l,m,n,q,p,t,u,r;d=0;for(e=this.actions.length;d<e;d++)switch(f=this.actions[d],g=f.action,f=f.args,g){case THREE.PathActions.MOVE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.LINE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:h=f[2];l=f[3];q=f[0];p=f[1];0<c.length?(g=c[c.length-1],t=g.x,
u=g.y):(g=this.actions[d-1].args,t=g[g.length-2],u=g[g.length-1]);for(f=1;f<=a;f++)r=f/a,g=THREE.Shape.Utils.b2(r,t,q,h),r=THREE.Shape.Utils.b2(r,u,p,l),c.push(new THREE.Vector2(g,r));break;case THREE.PathActions.BEZIER_CURVE_TO:h=f[4];l=f[5];q=f[0];p=f[1];m=f[2];n=f[3];0<c.length?(g=c[c.length-1],t=g.x,u=g.y):(g=this.actions[d-1].args,t=g[g.length-2],u=g[g.length-1]);for(f=1;f<=a;f++)r=f/a,g=THREE.Shape.Utils.b3(r,t,q,m,h),r=THREE.Shape.Utils.b3(r,u,p,n,l),c.push(new THREE.Vector2(g,r));break;case THREE.PathActions.CSPLINE_THRU:g=
this.actions[d-1].args;r=[new THREE.Vector2(g[g.length-2],g[g.length-1])];g=a*f[0].length;r=r.concat(f[0]);r=new THREE.SplineCurve(r);for(f=1;f<=g;f++)c.push(r.getPointAt(f/g));break;case THREE.PathActions.ARC:h=f[0];l=f[1];p=f[2];m=f[3];g=f[4];q=!!f[5];t=g-m;u=2*a;for(f=1;f<=u;f++)r=f/u,q||(r=1-r),r=m+r*t,g=h+p*Math.cos(r),r=l+p*Math.sin(r),c.push(new THREE.Vector2(g,r));break;case THREE.PathActions.ELLIPSE:h=f[0];l=f[1];p=f[2];n=f[3];m=f[4];g=f[5];q=!!f[6];t=g-m;u=2*a;for(f=1;f<=u;f++)r=f/u,q||
(r=1-r),r=m+r*t,g=h+p*Math.cos(r),r=l+n*Math.sin(r),c.push(new THREE.Vector2(g,r))}d=c[c.length-1];1E-10>Math.abs(d.x-c[0].x)&&1E-10>Math.abs(d.y-c[0].y)&&c.splice(c.length-1,1);b&&c.push(c[0]);return c};
THREE.Path.prototype.toShapes=function(){var a,b,c,d,e=[],f=new THREE.Path;a=0;for(b=this.actions.length;a<b;a++)c=this.actions[a],d=c.args,c=c.action,c==THREE.PathActions.MOVE_TO&&0!=f.actions.length&&(e.push(f),f=new THREE.Path),f[c].apply(f,d);0!=f.actions.length&&e.push(f);if(0==e.length)return[];var g;d=[];a=!THREE.Shape.Utils.isClockWise(e[0].getPoints());if(1==e.length)return f=e[0],g=new THREE.Shape,g.actions=f.actions,g.curves=f.curves,d.push(g),d;if(a){g=new THREE.Shape;a=0;for(b=e.length;a<
b;a++)f=e[a],THREE.Shape.Utils.isClockWise(f.getPoints())?(g.actions=f.actions,g.curves=f.curves,d.push(g),g=new THREE.Shape):g.holes.push(f)}else{a=0;for(b=e.length;a<b;a++)f=e[a],THREE.Shape.Utils.isClockWise(f.getPoints())?(g&&d.push(g),g=new THREE.Shape,g.actions=f.actions,g.curves=f.curves):g.holes.push(f);d.push(g)}return d};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);
THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)};THREE.Shape.prototype.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedPoints(a,this.bends);return d};THREE.Shape.prototype.getSpacedPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedSpacedPoints(a,this.bends);return d};
THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};THREE.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};
THREE.Shape.Utils={removeHoles:function(a,b){var c=a.concat(),d=c.concat(),e,f,g,h,l,m,n,q,p,t,u=[];for(l=0;l<b.length;l++){m=b[l];Array.prototype.push.apply(d,m);f=Number.POSITIVE_INFINITY;for(e=0;e<m.length;e++){p=m[e];t=[];for(q=0;q<c.length;q++)n=c[q],n=p.distanceToSquared(n),t.push(n),n<f&&(f=n,g=e,h=q)}e=0<=h-1?h-1:c.length-1;f=0<=g-1?g-1:m.length-1;var r=[m[g],c[h],c[e]];q=THREE.FontUtils.Triangulate.area(r);var s=[m[g],m[f],c[h]];p=THREE.FontUtils.Triangulate.area(s);t=h;n=g;h+=1;g+=-1;0>
h&&(h+=c.length);h%=c.length;0>g&&(g+=m.length);g%=m.length;e=0<=h-1?h-1:c.length-1;f=0<=g-1?g-1:m.length-1;r=[m[g],c[h],c[e]];r=THREE.FontUtils.Triangulate.area(r);s=[m[g],m[f],c[h]];s=THREE.FontUtils.Triangulate.area(s);q+p>r+s&&(h=t,g=n,0>h&&(h+=c.length),h%=c.length,0>g&&(g+=m.length),g%=m.length,e=0<=h-1?h-1:c.length-1,f=0<=g-1?g-1:m.length-1);q=c.slice(0,h);p=c.slice(h);t=m.slice(g);n=m.slice(0,g);f=[m[g],m[f],c[h]];u.push([m[g],c[h],c[e]]);u.push(f);c=q.concat(t).concat(n).concat(p)}return{shape:c,
isolatedPts:u,allpoints:d}},triangulateShape:function(a,b){var c=THREE.Shape.Utils.removeHoles(a,b),d=c.allpoints,e=c.isolatedPts,c=THREE.FontUtils.Triangulate(c.shape,!1),f,g,h,l,m={};f=0;for(g=d.length;f<g;f++)l=d[f].x+":"+d[f].y,void 0!==m[l]&&console.log("Duplicate point",l),m[l]=f;f=0;for(g=c.length;f<g;f++){h=c[f];for(d=0;3>d;d++)l=h[d].x+":"+h[d].y,l=m[l],void 0!==l&&(h[d]=l)}f=0;for(g=e.length;f<g;f++){h=e[f];for(d=0;3>d;d++)l=h[d].x+":"+h[d].y,l=m[l],void 0!==l&&(h[d]=l)}return c.concat(e)},
isClockWise:function(a){return 0>THREE.FontUtils.Triangulate.area(a)},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){return 3*(1-a)*a*a*b},b3p3:function(a,b){return a*a*a*b},b3:function(a,b,c,d,e){return this.b3p0(a,b)+this.b3p1(a,c)+this.b3p2(a,d)+
this.b3p3(a,e)}};
THREE.AnimationHandler=function(){var a=[],b={},c={update:function(b){for(var c=0;c<a.length;c++)a[c].update(b)},addToUpdate:function(b){-1===a.indexOf(b)&&a.push(b)},removeFromUpdate:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},add:function(a){void 0!==b[a.name]&&console.log("THREE.AnimationHandler.add: Warning! "+a.name+" already exists in library. Overwriting.");b[a.name]=a;if(!0!==a.initialized){for(var c=0;c<a.hierarchy.length;c++){for(var d=0;d<a.hierarchy[c].keys.length;d++)if(0>a.hierarchy[c].keys[d].time&&
(a.hierarchy[c].keys[d].time=0),void 0!==a.hierarchy[c].keys[d].rot&&!(a.hierarchy[c].keys[d].rot instanceof THREE.Quaternion)){var h=a.hierarchy[c].keys[d].rot;a.hierarchy[c].keys[d].rot=new THREE.Quaternion(h[0],h[1],h[2],h[3])}if(a.hierarchy[c].keys.length&&void 0!==a.hierarchy[c].keys[0].morphTargets){h={};for(d=0;d<a.hierarchy[c].keys.length;d++)for(var l=0;l<a.hierarchy[c].keys[d].morphTargets.length;l++){var m=a.hierarchy[c].keys[d].morphTargets[l];h[m]=-1}a.hierarchy[c].usedMorphTargets=h;
for(d=0;d<a.hierarchy[c].keys.length;d++){var n={};for(m in h){for(l=0;l<a.hierarchy[c].keys[d].morphTargets.length;l++)if(a.hierarchy[c].keys[d].morphTargets[l]===m){n[m]=a.hierarchy[c].keys[d].morphTargetsInfluences[l];break}l===a.hierarchy[c].keys[d].morphTargets.length&&(n[m]=0)}a.hierarchy[c].keys[d].morphTargetsInfluences=n}}for(d=1;d<a.hierarchy[c].keys.length;d++)a.hierarchy[c].keys[d].time===a.hierarchy[c].keys[d-1].time&&(a.hierarchy[c].keys.splice(d,1),d--);for(d=0;d<a.hierarchy[c].keys.length;d++)a.hierarchy[c].keys[d].index=
d}d=parseInt(a.length*a.fps,10);a.JIT={};a.JIT.hierarchy=[];for(c=0;c<a.hierarchy.length;c++)a.JIT.hierarchy.push(Array(d));a.initialized=!0}},get:function(a){if("string"===typeof a){if(b[a])return b[a];console.log("THREE.AnimationHandler.get: Couldn't find animation "+a);return null}},parse:function(a){var b=[];if(a instanceof THREE.SkinnedMesh)for(var c=0;c<a.bones.length;c++)b.push(a.bones[c]);else d(a,b);return b}},d=function(a,b){b.push(a);for(var c=0;c<a.children.length;c++)d(a.children[c],
b)};c.LINEAR=0;c.CATMULLROM=1;c.CATMULLROM_FORWARD=2;return c}();THREE.Animation=function(a,b,c){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=void 0!==c?c:THREE.AnimationHandler.LINEAR;this.points=[];this.target=new THREE.Vector3};
THREE.Animation.prototype.play=function(a,b){if(!1===this.isPlaying){this.isPlaying=!0;this.loop=void 0!==a?a:!0;this.currentTime=void 0!==b?b:0;var c,d=this.hierarchy.length,e;for(c=0;c<d;c++){e=this.hierarchy[c];this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(e.useQuaternion=!0);e.matrixAutoUpdate=!0;void 0===e.animationCache&&(e.animationCache={},e.animationCache.prevKey={pos:0,rot:0,scl:0},e.animationCache.nextKey={pos:0,rot:0,scl:0},e.animationCache.originalMatrix=e instanceof
THREE.Bone?e.skinMatrix:e.matrix);var f=e.animationCache.prevKey;e=e.animationCache.nextKey;f.pos=this.data.hierarchy[c].keys[0];f.rot=this.data.hierarchy[c].keys[0];f.scl=this.data.hierarchy[c].keys[0];e.pos=this.getNextKeyWith("pos",c,1);e.rot=this.getNextKeyWith("rot",c,1);e.scl=this.getNextKeyWith("scl",c,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};
THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this)};
THREE.Animation.prototype.update=function(a){if(!1!==this.isPlaying){var b=["pos","rot","scl"],c,d,e,f,g,h,l,m,n;n=this.currentTime+=a*this.timeScale;m=this.currentTime%=this.data.length;parseInt(Math.min(m*this.data.fps,this.data.length*this.data.fps),10);for(var q=0,p=this.hierarchy.length;q<p;q++){a=this.hierarchy[q];l=a.animationCache;for(var t=0;3>t;t++){c=b[t];g=l.prevKey[c];h=l.nextKey[c];if(h.time<=n){if(m<n)if(this.loop){g=this.data.hierarchy[q].keys[0];for(h=this.getNextKeyWith(c,q,1);h.time<
m;)g=h,h=this.getNextKeyWith(c,q,h.index+1)}else{this.stop();return}else{do g=h,h=this.getNextKeyWith(c,q,h.index+1);while(h.time<m)}l.prevKey[c]=g;l.nextKey[c]=h}a.matrixAutoUpdate=!0;a.matrixWorldNeedsUpdate=!0;d=(m-g.time)/(h.time-g.time);e=g[c];f=h[c];if(0>d||1<d)console.log("THREE.Animation.update: Warning! Scale out of bounds:"+d+" on bone "+q),d=0>d?0:1;if("pos"===c)if(c=a.position,this.interpolationType===THREE.AnimationHandler.LINEAR)c.x=e[0]+(f[0]-e[0])*d,c.y=e[1]+(f[1]-e[1])*d,c.z=e[2]+
(f[2]-e[2])*d;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)this.points[0]=this.getPrevKeyWith("pos",q,g.index-1).pos,this.points[1]=e,this.points[2]=f,this.points[3]=this.getNextKeyWith("pos",q,h.index+1).pos,d=0.33*d+0.33,e=this.interpolateCatmullRom(this.points,d),c.x=e[0],c.y=e[1],c.z=e[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(d=this.interpolateCatmullRom(this.points,1.01*d),
this.target.set(d[0],d[1],d[2]),this.target.sub(c),this.target.y=0,this.target.normalize(),d=Math.atan2(this.target.x,this.target.z),a.rotation.set(0,d,0))}else"rot"===c?THREE.Quaternion.slerp(e,f,a.quaternion,d):"scl"===c&&(c=a.scale,c.x=e[0]+(f[0]-e[0])*d,c.y=e[1]+(f[1]-e[1])*d,c.z=e[2]+(f[2]-e[2])*d)}}}};
THREE.Animation.prototype.interpolateCatmullRom=function(a,b){var c=[],d=[],e,f,g,h,l,m;e=(a.length-1)*b;f=Math.floor(e);e-=f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>a.length-2?f:f+1;c[3]=f>a.length-3?f:f+2;f=a[c[0]];h=a[c[1]];l=a[c[2]];m=a[c[3]];c=e*e;g=e*c;d[0]=this.interpolate(f[0],h[0],l[0],m[0],e,c,g);d[1]=this.interpolate(f[1],h[1],l[1],m[1],e,c,g);d[2]=this.interpolate(f[2],h[2],l[2],m[2],e,c,g);return d};
THREE.Animation.prototype.interpolate=function(a,b,c,d,e,f,g){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*g+(-3*(b-c)-2*a-d)*f+a*e+b};THREE.Animation.prototype.getNextKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[0]};
THREE.Animation.prototype.getPrevKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[d.length-1]};
THREE.KeyFrameAnimation=function(a,b,c){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;this.JITCompile=void 0!==c?c:!0;a=0;for(b=this.hierarchy.length;a<b;a++){c=this.data.hierarchy[a].sids;var d=this.hierarchy[a];if(this.data.hierarchy[a].keys.length&&c){for(var e=0;e<c.length;e++){var f=c[e],g=this.getNextKeyWith(f,a,0);g&&g.apply(f)}d.matrixAutoUpdate=!1;this.data.hierarchy[a].node.updateMatrix();
d.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a,b){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==a?a:!0;this.currentTime=void 0!==b?b:0;this.startTimeMs=b;this.startTime=1E7;this.endTime=-this.startTime;var c,d=this.hierarchy.length,e,f;for(c=0;c<d;c++)e=this.hierarchy[c],f=this.data.hierarchy[c],e.useQuaternion=!0,void 0===f.animationCache&&(f.animationCache={},f.animationCache.prevKey=null,f.animationCache.nextKey=null,f.animationCache.originalMatrix=e instanceof THREE.Bone?e.skinMatrix:
e.matrix),e=this.data.hierarchy[c].keys,e.length&&(f.animationCache.prevKey=e[0],f.animationCache.nextKey=e[1],this.startTime=Math.min(e[0].time,this.startTime),this.endTime=Math.max(e[e.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};
THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var d=c.animationCache.originalMatrix;b instanceof THREE.Bone?(d.copy(b.skinMatrix),b.skinMatrix=d):(d.copy(b.matrix),b.matrix=d);delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(this.isPlaying){var b,c,d,e,f=this.data.JIT.hierarchy,g,h,l;h=this.currentTime+=a*this.timeScale;g=this.currentTime%=this.data.length;g<this.startTimeMs&&(g=this.currentTime=this.startTimeMs+g);e=parseInt(Math.min(g*this.data.fps,this.data.length*this.data.fps),10);if((l=g<h)&&!this.loop){a=0;for(var m=this.hierarchy.length;a<m;a++){var n=this.data.hierarchy[a].keys,f=this.data.hierarchy[a].sids;d=n.length-1;e=this.hierarchy[a];if(n.length){for(n=
0;n<f.length;n++)g=f[n],(h=this.getPrevKeyWith(g,a,d))&&h.apply(g);this.data.hierarchy[a].node.updateMatrix();e.matrixWorldNeedsUpdate=!0}}this.stop()}else if(!(g<this.startTime)){a=0;for(m=this.hierarchy.length;a<m;a++){d=this.hierarchy[a];b=this.data.hierarchy[a];var n=b.keys,q=b.animationCache;if(this.JITCompile&&void 0!==f[a][e])d instanceof THREE.Bone?(d.skinMatrix=f[a][e],d.matrixWorldNeedsUpdate=!1):(d.matrix=f[a][e],d.matrixWorldNeedsUpdate=!0);else if(n.length){this.JITCompile&&q&&(d instanceof
THREE.Bone?d.skinMatrix=q.originalMatrix:d.matrix=q.originalMatrix);b=q.prevKey;c=q.nextKey;if(b&&c){if(c.time<=h){if(l&&this.loop){b=n[0];for(c=n[1];c.time<g;)b=c,c=n[b.index+1]}else if(!l)for(var p=n.length-1;c.time<g&&c.index!==p;)b=c,c=n[b.index+1];q.prevKey=b;q.nextKey=c}c.time>=g?b.interpolate(c,g):b.interpolate(c,c.time)}this.data.hierarchy[a].node.updateMatrix();d.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===f[0][e]){this.hierarchy[0].updateMatrixWorld(!0);for(a=0;a<this.hierarchy.length;a++)f[a][e]=
this.hierarchy[a]instanceof THREE.Bone?this.hierarchy[a].skinMatrix.clone():this.hierarchy[a].matrix.clone()}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(1,0,0));this.add(d);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(-1,0,0));this.add(e);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,1);f.lookAt(new THREE.Vector3(0,1,0));this.add(f);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,-1);g.lookAt(new THREE.Vector3(0,-1,0));this.add(g);var h=new THREE.PerspectiveCamera(90,
1,a,b);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,1));this.add(h);var l=new THREE.PerspectiveCamera(90,1,a,b);l.up.set(0,-1,0);l.lookAt(new THREE.Vector3(0,0,-1));this.add(l);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){var c=this.renderTarget,p=c.generateMipmaps;c.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=1;a.render(b,e,c);c.activeCubeFace=
2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,g,c);c.activeCubeFace=4;a.render(b,h,c);c.generateMipmaps=p;c.activeCubeFace=5;a.render(b,l,c)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(a,b,c,d,e,f,g){THREE.Camera.call(this);this.fov=c;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.cameraO=new THREE.OrthographicCamera(a/-2,a/2,b/2,b/-2,f,g);this.cameraP=new THREE.PerspectiveCamera(c,a/b,d,e);this.zoom=1;this.toPerspective()};
THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};
THREE.CombinedCamera.prototype.toOrthographic=function(){var a=this.cameraP.aspect,b=(this.cameraP.near+this.cameraP.far)/2,b=Math.tan(this.fov/2)*b,a=2*b*a/2,b=b/this.zoom,a=a/this.zoom;this.cameraO.left=-a;this.cameraO.right=a;this.cameraO.top=b;this.cameraO.bottom=-b;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};
THREE.CombinedCamera.prototype.setSize=function(a,b){this.cameraP.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};THREE.CombinedCamera.prototype.setFov=function(a){this.fov=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};
THREE.CombinedCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);var c=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.setFov(c);return c};THREE.CombinedCamera.prototype.setZoom=function(a){this.zoom=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.AsteriskGeometry=function(a,b){THREE.Geometry.call(this);for(var c=0.707*a,d=0.707*b,c=[[a,0,0],[b,0,0],[-a,0,0],[-b,0,0],[0,a,0],[0,b,0],[0,-a,0],[0,-b,0],[0,0,a],[0,0,b],[0,0,-a],[0,0,-b],[c,c,0],[d,d,0],[-c,-c,0],[-d,-d,0],[c,-c,0],[d,-d,0],[-c,c,0],[-d,d,0],[c,0,c],[d,0,d],[-c,0,-c],[-d,0,-d],[c,0,-c],[d,0,-d],[-c,0,c],[-d,0,d],[0,c,c],[0,d,d],[0,-c,-c],[0,-d,-d],[0,c,-c],[0,d,-d],[0,-c,c],[0,-d,d]],d=0,e=c.length;d<e;d++)this.vertices.push(new THREE.Vector3(c[d][0],c[d][1],c[d][2]))};
THREE.AsteriskGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CircleGeometry=function(a,b,c,d){THREE.Geometry.call(this);a=a||50;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;b=void 0!==b?Math.max(3,b):8;var e,f=[];e=new THREE.Vector3;var g=new THREE.Vector2(0.5,0.5);this.vertices.push(e);f.push(g);for(e=0;e<=b;e++){var h=new THREE.Vector3;h.x=a*Math.cos(c+e/b*d);h.y=a*Math.sin(c+e/b*d);this.vertices.push(h);f.push(new THREE.Vector2((h.x/a+1)/2,-(h.y/a+1)/2+1))}c=new THREE.Vector3(0,0,-1);for(e=1;e<=b;e++)this.faces.push(new THREE.Face3(e,e+1,0,[c,c,c])),
this.faceVertexUvs[0].push([f[e],f[e+1],g]);this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CubeGeometry=function(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,r){var s,A=h.widthSegments,v=h.heightSegments,B=e/2,w=f/2,F=h.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)s="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)s="y",v=h.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)s="x",A=h.depthSegments;var K=A+1,C=v+1,z=e/A,N=f/v,O=new THREE.Vector3;O[s]=0<g?1:-1;for(e=0;e<C;e++)for(f=0;f<K;f++){var L=new THREE.Vector3;L[a]=(f*z-B)*c;L[b]=(e*N-w)*d;L[s]=g;h.vertices.push(L)}for(e=
0;e<v;e++)for(f=0;f<A;f++)a=new THREE.Face4(f+K*e+F,f+K*(e+1)+F,f+1+K*(e+1)+F,f+1+K*e+F),a.normal.copy(O),a.vertexNormals.push(O.clone(),O.clone(),O.clone(),O.clone()),a.materialIndex=r,h.faces.push(a),h.faceVertexUvs[0].push([new THREE.Vector2(f/A,1-e/v),new THREE.Vector2(f/A,1-(e+1)/v),new THREE.Vector2((f+1)/A,1-(e+1)/v),new THREE.Vector2((f+1)/A,1-e/v)])}THREE.Geometry.call(this);var h=this;this.width=a;this.height=b;this.depth=c;this.widthSegments=d||1;this.heightSegments=e||1;this.depthSegments=
f||1;a=this.width/2;b=this.height/2;c=this.depth/2;g("z","y",-1,-1,this.depth,this.height,a,0);g("z","y",1,-1,this.depth,this.height,-a,1);g("x","z",1,1,this.width,this.depth,b,2);g("x","z",1,-1,this.width,this.depth,-b,3);g("x","y",1,-1,this.width,this.height,c,4);g("x","y",-1,-1,this.width,this.height,-c,5);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CylinderGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);a=void 0!==a?a:20;b=void 0!==b?b:20;c=void 0!==c?c:100;var g=c/2;d=d||8;e=e||1;var h,l,m=[],n=[];for(l=0;l<=e;l++){var q=[],p=[],t=l/e,u=t*(b-a)+a;for(h=0;h<=d;h++){var r=h/d,s=new THREE.Vector3;s.x=u*Math.sin(2*r*Math.PI);s.y=-t*c+g;s.z=u*Math.cos(2*r*Math.PI);this.vertices.push(s);q.push(this.vertices.length-1);p.push(new THREE.Vector2(r,1-t))}m.push(q);n.push(p)}c=(b-a)/c;for(h=0;h<d;h++){0!==a?(q=this.vertices[m[0][h]].clone(),
p=this.vertices[m[0][h+1]].clone()):(q=this.vertices[m[1][h]].clone(),p=this.vertices[m[1][h+1]].clone());q.setY(Math.sqrt(q.x*q.x+q.z*q.z)*c).normalize();p.setY(Math.sqrt(p.x*p.x+p.z*p.z)*c).normalize();for(l=0;l<e;l++){var t=m[l][h],u=m[l+1][h],r=m[l+1][h+1],s=m[l][h+1],A=q.clone(),v=q.clone(),B=p.clone(),w=p.clone(),F=n[l][h].clone(),K=n[l+1][h].clone(),C=n[l+1][h+1].clone(),z=n[l][h+1].clone();this.faces.push(new THREE.Face4(t,u,r,s,[A,v,B,w]));this.faceVertexUvs[0].push([F,K,C,z])}}if(!f&&0<
a){this.vertices.push(new THREE.Vector3(0,g,0));for(h=0;h<d;h++)t=m[0][h],u=m[0][h+1],r=this.vertices.length-1,A=new THREE.Vector3(0,1,0),v=new THREE.Vector3(0,1,0),B=new THREE.Vector3(0,1,0),F=n[0][h].clone(),K=n[0][h+1].clone(),C=new THREE.Vector2(K.u,0),this.faces.push(new THREE.Face3(t,u,r,[A,v,B])),this.faceVertexUvs[0].push([F,K,C])}if(!f&&0<b){this.vertices.push(new THREE.Vector3(0,-g,0));for(h=0;h<d;h++)t=m[l][h+1],u=m[l][h],r=this.vertices.length-1,A=new THREE.Vector3(0,-1,0),v=new THREE.Vector3(0,
-1,0),B=new THREE.Vector3(0,-1,0),F=n[l][h+1].clone(),K=n[l][h].clone(),C=new THREE.Vector2(K.u,1),this.faces.push(new THREE.Face3(t,u,r,[A,v,B])),this.faceVertexUvs[0].push([F,K,C])}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),a=a instanceof Array?a:[a],this.shapebb=a[a.length-1].getBoundingBox(),this.addShapeList(a,b),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){b||console.log("die");return b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=THREE.ExtrudeGeometry.__v1,e=THREE.ExtrudeGeometry.__v2,f=THREE.ExtrudeGeometry.__v3,g=THREE.ExtrudeGeometry.__v4,h=THREE.ExtrudeGeometry.__v5,l=THREE.ExtrudeGeometry.__v6;d.set(a.x-b.x,a.y-b.y);e.set(a.x-c.x,a.y-c.y);d=d.normalize();e=e.normalize();f.set(-d.y,d.x);g.set(e.y,-e.x);h.copy(a).add(f);l.copy(a).add(g);if(h.equals(l))return g.clone();
h.copy(b).add(f);l.copy(c).add(g);f=d.dot(g);g=l.sub(h).dot(g);0===f&&(console.log("Either infinite or no solutions!"),0===g?console.log("Its finite solutions."):console.log("Too bad, no solutions."));g/=f;return 0>g?(b=Math.atan2(b.y-a.y,b.x-a.x),a=Math.atan2(c.y-a.y,c.x-a.x),b>a&&(a+=2*Math.PI),c=(b+a)/2,a=-Math.cos(c),c=-Math.sin(c),new THREE.Vector2(a,c)):d.multiplyScalar(g).add(h).sub(a).clone()}function e(c,d){var e,f;for(Q=c.length;0<=--Q;){e=Q;f=Q-1;0>f&&(f=c.length-1);for(var g=0,h=t+2*n,
g=0;g<h;g++){var l=ia*g,m=ia*(g+1),p=d+e+l,l=d+f+l,q=d+f+m,m=d+e+m,r=c,s=g,u=h,w=e,A=f,p=p+U,l=l+U,q=q+U,m=m+U;L.faces.push(new THREE.Face4(p,l,q,m,null,null,v));p=B.generateSideWallUV(L,a,r,b,p,l,q,m,s,u,w,A);L.faceVertexUvs[0].push(p)}}}function f(a,b,c){L.vertices.push(new THREE.Vector3(a,b,c))}function g(c,d,e,f){c+=U;d+=U;e+=U;L.faces.push(new THREE.Face3(c,d,e,null,null,A));c=f?B.generateBottomUV(L,a,b,c,d,e):B.generateTopUV(L,a,b,c,d,e);L.faceVertexUvs[0].push(c)}var h=void 0!==b.amount?b.amount:
100,l=void 0!==b.bevelThickness?b.bevelThickness:6,m=void 0!==b.bevelSize?b.bevelSize:l-2,n=void 0!==b.bevelSegments?b.bevelSegments:3,q=void 0!==b.bevelEnabled?b.bevelEnabled:!0,p=void 0!==b.curveSegments?b.curveSegments:12,t=void 0!==b.steps?b.steps:1,u=b.extrudePath,r,s=!1,A=b.material,v=b.extrudeMaterial,B=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,w,F,K,C;u&&(r=u.getSpacedPoints(t),s=!0,q=!1,w=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(u,t,
!1),F=new THREE.Vector3,K=new THREE.Vector3,C=new THREE.Vector3);q||(m=l=n=0);var z,N,O,L=this,U=this.vertices.length,p=a.extractPoints(p),D=p.shape,p=p.holes;if(u=!THREE.Shape.Utils.isClockWise(D)){D=D.reverse();N=0;for(O=p.length;N<O;N++)z=p[N],THREE.Shape.Utils.isClockWise(z)&&(p[N]=z.reverse());u=!1}var M=THREE.Shape.Utils.triangulateShape(D,p),u=D;N=0;for(O=p.length;N<O;N++)z=p[N],D=D.concat(z);var I,J,E,Y,ia=D.length,Ra=M.length,Sa=[],Q=0,ba=u.length;I=ba-1;for(J=Q+1;Q<ba;Q++,I++,J++)I===ba&&
(I=0),J===ba&&(J=0),Sa[Q]=d(u[Q],u[I],u[J]);var ua=[],fa,qa=Sa.concat();N=0;for(O=p.length;N<O;N++){z=p[N];fa=[];Q=0;ba=z.length;I=ba-1;for(J=Q+1;Q<ba;Q++,I++,J++)I===ba&&(I=0),J===ba&&(J=0),fa[Q]=d(z[Q],z[I],z[J]);ua.push(fa);qa=qa.concat(fa)}for(I=0;I<n;I++){z=I/n;E=l*(1-z);J=m*Math.sin(z*Math.PI/2);Q=0;for(ba=u.length;Q<ba;Q++)Y=c(u[Q],Sa[Q],J),f(Y.x,Y.y,-E);N=0;for(O=p.length;N<O;N++){z=p[N];fa=ua[N];Q=0;for(ba=z.length;Q<ba;Q++)Y=c(z[Q],fa[Q],J),f(Y.x,Y.y,-E)}}J=m;for(Q=0;Q<ia;Q++)Y=q?c(D[Q],
qa[Q],J):D[Q],s?(K.copy(w.normals[0]).multiplyScalar(Y.x),F.copy(w.binormals[0]).multiplyScalar(Y.y),C.copy(r[0]).add(K).add(F),f(C.x,C.y,C.z)):f(Y.x,Y.y,0);for(z=1;z<=t;z++)for(Q=0;Q<ia;Q++)Y=q?c(D[Q],qa[Q],J):D[Q],s?(K.copy(w.normals[z]).multiplyScalar(Y.x),F.copy(w.binormals[z]).multiplyScalar(Y.y),C.copy(r[z]).add(K).add(F),f(C.x,C.y,C.z)):f(Y.x,Y.y,h/t*z);for(I=n-1;0<=I;I--){z=I/n;E=l*(1-z);J=m*Math.sin(z*Math.PI/2);Q=0;for(ba=u.length;Q<ba;Q++)Y=c(u[Q],Sa[Q],J),f(Y.x,Y.y,h+E);N=0;for(O=p.length;N<
O;N++){z=p[N];fa=ua[N];Q=0;for(ba=z.length;Q<ba;Q++)Y=c(z[Q],fa[Q],J),s?f(Y.x,Y.y+r[t-1].y,r[t-1].x+E):f(Y.x,Y.y,h+E)}}if(q){l=0*ia;for(Q=0;Q<Ra;Q++)h=M[Q],g(h[2]+l,h[1]+l,h[0]+l,!0);l=ia*(t+2*n);for(Q=0;Q<Ra;Q++)h=M[Q],g(h[0]+l,h[1]+l,h[2]+l,!1)}else{for(Q=0;Q<Ra;Q++)h=M[Q],g(h[2],h[1],h[0],!0);for(Q=0;Q<Ra;Q++)h=M[Q],g(h[0]+ia*t,h[1]+ia*t,h[2]+ia*t,!1)}h=0;e(u,h);h+=u.length;N=0;for(O=p.length;N<O;N++)z=p[N],e(z,h),h+=z.length};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d,e,f){b=a.vertices[e].x;e=a.vertices[e].y;c=a.vertices[f].x;f=a.vertices[f].y;return[new THREE.Vector2(a.vertices[d].x,a.vertices[d].y),new THREE.Vector2(b,e),new THREE.Vector2(c,f)]},generateBottomUV:function(a,b,c,d,e,f){return this.generateTopUV(a,b,c,d,e,f)},generateSideWallUV:function(a,b,c,d,e,f,g,h){b=a.vertices[e].x;c=a.vertices[e].y;e=a.vertices[e].z;d=a.vertices[f].x;var l=a.vertices[f].y;f=a.vertices[f].z;var m=a.vertices[g].x,
n=a.vertices[g].y;g=a.vertices[g].z;var q=a.vertices[h].x,p=a.vertices[h].y;a=a.vertices[h].z;return 0.01>Math.abs(c-l)?[new THREE.Vector2(b,1-e),new THREE.Vector2(d,1-f),new THREE.Vector2(m,1-g),new THREE.Vector2(q,1-a)]:[new THREE.Vector2(c,1-e),new THREE.Vector2(l,1-f),new THREE.Vector2(n,1-g),new THREE.Vector2(p,1-a)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;
THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);!1===a instanceof Array&&(a=[a]);this.shapebb=a[a.length-1].getBoundingBox();this.addShapeList(a,b);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,d=a.length;c<d;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,d=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,e,f,g,h=this.vertices.length;e=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var l=e.shape,m=e.holes;if(!THREE.Shape.Utils.isClockWise(l)){l=l.reverse();e=0;for(f=m.length;e<f;e++)g=m[e],THREE.Shape.Utils.isClockWise(g)&&(m[e]=g.reverse())}var n=THREE.Shape.Utils.triangulateShape(l,m);e=0;for(f=m.length;e<f;e++)g=m[e],
l=l.concat(g);m=l.length;f=n.length;for(e=0;e<m;e++)g=l[e],this.vertices.push(new THREE.Vector3(g.x,g.y,0));for(e=0;e<f;e++)m=n[e],l=m[0]+h,g=m[1]+h,m=m[2]+h,this.faces.push(new THREE.Face3(l,g,m,null,null,c)),this.faceVertexUvs[0].push(d.generateBottomUV(this,a,b,l,g,m))};
THREE.LatheGeometry=function(a,b,c,d){THREE.Geometry.call(this);b=b||12;c=c||0;d=d||2*Math.PI;for(var e=1/(a.length-1),f=1/b,g=0,h=b;g<=h;g++)for(var l=c+g*f*d,m=Math.cos(l),n=Math.sin(l),l=0,q=a.length;l<q;l++){var p=a[l],t=new THREE.Vector3;t.x=m*p.x-n*p.y;t.y=n*p.x+m*p.y;t.z=p.z;this.vertices.push(t)}c=a.length;g=0;for(h=b;g<h;g++){l=0;for(q=a.length-1;l<q;l++)d=b=l+c*g,n=b+c,m=b+1+c,this.faces.push(new THREE.Face4(d,n,m,b+1)),m=g*f,b=l*e,d=m+f,n=b+e,this.faceVertexUvs[0].push([new THREE.Vector2(m,
b),new THREE.Vector2(d,b),new THREE.Vector2(d,n),new THREE.Vector2(m,n)])}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.width=a;this.height=b;this.widthSegments=c||1;this.heightSegments=d||1;c=a/2;var e=b/2;d=this.widthSegments;var f=this.heightSegments,g=d+1,h=f+1,l=this.width/d,m=this.height/f,n=new THREE.Vector3(0,0,1);for(a=0;a<h;a++)for(b=0;b<g;b++)this.vertices.push(new THREE.Vector3(b*l-c,-(a*m-e),0));for(a=0;a<f;a++)for(b=0;b<d;b++)c=new THREE.Face4(b+g*a,b+g*(a+1),b+1+g*(a+1),b+1+g*a),c.normal.copy(n),c.vertexNormals.push(n.clone(),n.clone(),
n.clone(),n.clone()),this.faces.push(c),this.faceVertexUvs[0].push([new THREE.Vector2(b/d,1-a/f),new THREE.Vector2(b/d,1-(a+1)/f),new THREE.Vector2((b+1)/d,1-(a+1)/f),new THREE.Vector2((b+1)/d,1-a/f)]);this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(a,b,c,d,e,f,g){THREE.Geometry.call(this);this.radius=a||50;this.widthSegments=Math.max(3,Math.floor(b)||8);this.heightSegments=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;f=void 0!==f?f:0;g=void 0!==g?g:Math.PI;var h=[],l=[];for(c=0;c<=this.heightSegments;c++){var m=[],n=[];for(b=0;b<=this.widthSegments;b++){var q=b/this.widthSegments,p=c/this.heightSegments,t=new THREE.Vector3;t.x=-this.radius*Math.cos(d+q*e)*Math.sin(f+p*g);t.y=this.radius*
Math.cos(f+p*g);t.z=this.radius*Math.sin(d+q*e)*Math.sin(f+p*g);this.vertices.push(t);m.push(this.vertices.length-1);n.push(new THREE.Vector2(q,1-p))}h.push(m);l.push(n)}for(c=0;c<this.heightSegments;c++)for(b=0;b<this.widthSegments;b++){d=h[c][b+1];e=h[c][b];f=h[c+1][b];g=h[c+1][b+1];var m=this.vertices[d].clone().normalize(),n=this.vertices[e].clone().normalize(),q=this.vertices[f].clone().normalize(),p=this.vertices[g].clone().normalize(),t=l[c][b+1].clone(),u=l[c][b].clone(),r=l[c+1][b].clone(),
s=l[c+1][b+1].clone();Math.abs(this.vertices[d].y)===this.radius?(this.faces.push(new THREE.Face3(d,f,g,[m,q,p])),this.faceVertexUvs[0].push([t,r,s])):Math.abs(this.vertices[f].y)===this.radius?(this.faces.push(new THREE.Face3(d,e,f,[m,n,q])),this.faceVertexUvs[0].push([t,u,r])):(this.faces.push(new THREE.Face4(d,e,f,g,[m,n,q,p])),this.faceVertexUvs[0].push([t,u,r,s]))}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};
THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(a,b){var c=THREE.FontUtils.generateShapes(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,b)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TorusGeometry=function(a,b,c,d,e){THREE.Geometry.call(this);this.radius=a||100;this.tube=b||40;this.radialSegments=c||8;this.tubularSegments=d||6;this.arc=e||2*Math.PI;e=new THREE.Vector3;a=[];b=[];for(c=0;c<=this.radialSegments;c++)for(d=0;d<=this.tubularSegments;d++){var f=d/this.tubularSegments*this.arc,g=2*c/this.radialSegments*Math.PI;e.x=this.radius*Math.cos(f);e.y=this.radius*Math.sin(f);var h=new THREE.Vector3;h.x=(this.radius+this.tube*Math.cos(g))*Math.cos(f);h.y=(this.radius+this.tube*
Math.cos(g))*Math.sin(f);h.z=this.tube*Math.sin(g);this.vertices.push(h);a.push(new THREE.Vector2(d/this.tubularSegments,c/this.radialSegments));b.push(h.clone().sub(e).normalize())}for(c=1;c<=this.radialSegments;c++)for(d=1;d<=this.tubularSegments;d++){e=(this.tubularSegments+1)*c+d-1;var f=(this.tubularSegments+1)*(c-1)+d-1,g=(this.tubularSegments+1)*(c-1)+d,h=(this.tubularSegments+1)*c+d,l=new THREE.Face4(e,f,g,h,[b[e],b[f],b[g],b[h]]);l.normal.add(b[e]);l.normal.add(b[f]);l.normal.add(b[g]);l.normal.add(b[h]);
l.normal.normalize();this.faces.push(l);this.faceVertexUvs[0].push([a[e].clone(),a[f].clone(),a[g].clone(),a[h].clone()])}this.computeCentroids()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TorusKnotGeometry=function(a,b,c,d,e,f,g){function h(a,b,c,d,e,f){var g=Math.cos(a);Math.cos(b);b=Math.sin(a);a*=c/d;c=Math.cos(a);g*=0.5*e*(2+c);b*=0.5*e*(2+c);e=0.5*f*e*Math.sin(a);return new THREE.Vector3(g,b,e)}THREE.Geometry.call(this);this.radius=a||100;this.tube=b||40;this.radialSegments=c||64;this.tubularSegments=d||8;this.p=e||2;this.q=f||3;this.heightScale=g||1;this.grid=Array(this.radialSegments);c=new THREE.Vector3;d=new THREE.Vector3;e=new THREE.Vector3;for(a=0;a<this.radialSegments;++a){this.grid[a]=
Array(this.tubularSegments);for(b=0;b<this.tubularSegments;++b){var l=2*(a/this.radialSegments)*this.p*Math.PI;g=2*(b/this.tubularSegments)*Math.PI;f=h(l,g,this.q,this.p,this.radius,this.heightScale);l=h(l+0.01,g,this.q,this.p,this.radius,this.heightScale);c.subVectors(l,f);d.addVectors(l,f);e.crossVectors(c,d);d.crossVectors(e,c);e.normalize();d.normalize();l=-this.tube*Math.cos(g);g=this.tube*Math.sin(g);f.x+=l*d.x+g*e.x;f.y+=l*d.y+g*e.y;f.z+=l*d.z+g*e.z;this.grid[a][b]=this.vertices.push(new THREE.Vector3(f.x,
f.y,f.z))-1}}for(a=0;a<this.radialSegments;++a)for(b=0;b<this.tubularSegments;++b){e=(a+1)%this.radialSegments;f=(b+1)%this.tubularSegments;c=this.grid[a][b];d=this.grid[e][b];e=this.grid[e][f];f=this.grid[a][f];g=new THREE.Vector2(a/this.radialSegments,b/this.tubularSegments);var l=new THREE.Vector2((a+1)/this.radialSegments,b/this.tubularSegments),m=new THREE.Vector2((a+1)/this.radialSegments,(b+1)/this.tubularSegments),n=new THREE.Vector2(a/this.radialSegments,(b+1)/this.tubularSegments);this.faces.push(new THREE.Face4(c,
d,e,f));this.faceVertexUvs[0].push([g,l,m,n])}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);this.path=a;this.segments=b||64;this.radius=c||1;this.radiusSegments=d||8;this.closed=e||!1;f&&(this.debug=new THREE.Object3D);this.grid=[];var g,h;e=this.segments+1;var l,m,n;f=new THREE.Vector3;var q,p,t;b=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);q=b.tangents;p=b.normals;t=b.binormals;this.tangents=q;this.normals=p;this.binormals=t;for(b=0;b<e;b++){this.grid[b]=[];d=b/(e-1);n=a.getPointAt(d);d=q[b];
g=p[b];h=t[b];this.debug&&(this.debug.add(new THREE.ArrowHelper(d,n,c,255)),this.debug.add(new THREE.ArrowHelper(g,n,c,16711680)),this.debug.add(new THREE.ArrowHelper(h,n,c,65280)));for(d=0;d<this.radiusSegments;d++)l=2*(d/this.radiusSegments)*Math.PI,m=-this.radius*Math.cos(l),l=this.radius*Math.sin(l),f.copy(n),f.x+=m*g.x+l*h.x,f.y+=m*g.y+l*h.y,f.z+=m*g.z+l*h.z,this.grid[b][d]=this.vertices.push(new THREE.Vector3(f.x,f.y,f.z))-1}for(b=0;b<this.segments;b++)for(d=0;d<this.radiusSegments;d++)e=this.closed?
(b+1)%this.segments:b+1,f=(d+1)%this.radiusSegments,a=this.grid[b][d],c=this.grid[e][d],e=this.grid[e][f],f=this.grid[b][f],q=new THREE.Vector2(b/this.segments,d/this.radiusSegments),p=new THREE.Vector2((b+1)/this.segments,d/this.radiusSegments),t=new THREE.Vector2((b+1)/this.segments,(d+1)/this.radiusSegments),g=new THREE.Vector2(b/this.segments,(d+1)/this.radiusSegments),this.faces.push(new THREE.Face4(a,c,e,f)),this.faceVertexUvs[0].push([q,p,t,g]);this.computeCentroids();this.computeFaceNormals();
this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(a,b,c){new THREE.Vector3;var d=new THREE.Vector3;new THREE.Vector3;var e=[],f=[],g=[],h=new THREE.Vector3,l=new THREE.Matrix4;b+=1;var m,n,q;this.tangents=e;this.normals=f;this.binormals=g;for(m=0;m<b;m++)n=m/(b-1),e[m]=a.getTangentAt(n),e[m].normalize();f[0]=new THREE.Vector3;g[0]=new THREE.Vector3;a=Number.MAX_VALUE;m=Math.abs(e[0].x);n=Math.abs(e[0].y);q=Math.abs(e[0].z);m<=a&&(a=m,d.set(1,0,0));n<=a&&(a=n,d.set(0,1,0));q<=a&&d.set(0,0,1);h.crossVectors(e[0],
d).normalize();f[0].crossVectors(e[0],h);g[0].crossVectors(e[0],f[0]);for(m=1;m<b;m++)f[m]=f[m-1].clone(),g[m]=g[m-1].clone(),h.crossVectors(e[m-1],e[m]),1E-4<h.length()&&(h.normalize(),d=Math.acos(e[m-1].dot(e[m])),f[m].applyMatrix4(l.makeRotationAxis(h,d))),g[m].crossVectors(e[m],f[m]);if(c){d=Math.acos(f[0].dot(f[b-1]));d/=b-1;0<e[0].dot(h.crossVectors(f[0],f[b-1]))&&(d=-d);for(m=1;m<b;m++)f[m].applyMatrix4(l.makeRotationAxis(e[m],d*m)),g[m].crossVectors(e[m],f[m])}};
THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=l.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+0.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5;b.uv=new THREE.Vector2(c,1-a);return b}function f(a,b,c,d){1>d?(d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]),d.centroid.add(a).add(b).add(c).divideScalar(3),d.normal=d.centroid.clone().normalize(),l.faces.push(d),d=Math.atan2(d.centroid.z,-d.centroid.x),l.faceVertexUvs[0].push([h(a.uv,
a,d),h(b.uv,b,d),h(c.uv,c,d)])):(d-=1,f(a,g(a,b),g(a,c),d),f(g(a,b),b,g(b,c),d),f(g(a,c),g(b,c),c,d),f(g(a,b),g(b,c),g(a,c),d))}function g(a,b){q[a.index]||(q[a.index]=[]);q[b.index]||(q[b.index]=[]);var c=q[a.index][b.index];void 0===c&&(q[a.index][b.index]=q[b.index][a.index]=c=e((new THREE.Vector3).addVectors(a,b).divideScalar(2)));return c}function h(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+0.5,a.y));return a}THREE.Geometry.call(this);
c=c||1;d=d||0;for(var l=this,m=0,n=a.length;m<n;m++)e(new THREE.Vector3(a[m][0],a[m][1],a[m][2]));var q=[];a=this.vertices;m=0;for(n=b.length;m<n;m++)f(a[b[m][0]],a[b[m][1]],a[b[m][2]],d);this.mergeVertices();m=0;for(n=this.vertices.length;m<n;m++)this.vertices[m].multiplyScalar(c);this.computeCentroids();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.IcosahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,c,0],[1,c,0],[-1,-c,0],[1,-c,0],[0,-1,c],[0,1,c],[0,-1,-c],[0,1,-c],[c,0,-1],[c,0,1],[-c,0,-1],[-c,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],a,b)};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.OctahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],a,b)};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],a,b)};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ParametricGeometry=function(a,b,c,d){THREE.Geometry.call(this);var e=this.vertices,f=this.faces,g=this.faceVertexUvs[0];d=void 0===d?!1:d;var h,l,m,n,q=b+1;for(h=0;h<=c;h++){n=h/c;for(l=0;l<=b;l++)m=l/b,m=a(m,n),e.push(m)}var p,t,u,r;for(h=0;h<c;h++)for(l=0;l<b;l++)a=h*q+l,e=h*q+l+1,n=(h+1)*q+l,m=(h+1)*q+l+1,p=new THREE.Vector2(l/b,h/c),t=new THREE.Vector2((l+1)/b,h/c),u=new THREE.Vector2(l/b,(h+1)/c),r=new THREE.Vector2((l+1)/b,(h+1)/c),d?(f.push(new THREE.Face3(a,e,n)),f.push(new THREE.Face3(e,
m,n)),g.push([p,t,u]),g.push([t,r,u])):(f.push(new THREE.Face4(a,e,m,n)),g.push([p,t,r,u]));this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ConvexGeometry=function(a){function b(a){var b=a.length();return new THREE.Vector2(a.x/b,a.y/b)}THREE.Geometry.call(this);for(var c=[[0,1,2],[0,2,1]],d=3;d<a.length;d++){var e=d,f=a[e].clone(),g=f.length();f.x+=2E-6*g*(Math.random()-0.5);f.y+=2E-6*g*(Math.random()-0.5);f.z+=2E-6*g*(Math.random()-0.5);for(var g=[],h=0;h<c.length;){var l=c[h],m=f,n=a[l[0]],q;q=n;var p=a[l[1]],t=a[l[2]],u=new THREE.Vector3,r=new THREE.Vector3;u.subVectors(t,p);r.subVectors(q,p);u.cross(r);u.normalize();q=u;n=q.dot(n);
if(q.dot(m)>=n){for(m=0;3>m;m++){n=[l[m],l[(m+1)%3]];q=!0;for(p=0;p<g.length;p++)if(g[p][0]===n[1]&&g[p][1]===n[0]){g[p]=g[g.length-1];g.pop();q=!1;break}q&&g.push(n)}c[h]=c[c.length-1];c.pop()}else h++}for(p=0;p<g.length;p++)c.push([g[p][0],g[p][1],e])}e=0;f=Array(a.length);for(d=0;d<c.length;d++){g=c[d];for(h=0;3>h;h++)void 0===f[g[h]]&&(f[g[h]]=e++,this.vertices.push(a[g[h]])),g[h]=f[g[h]]}for(d=0;d<c.length;d++)this.faces.push(new THREE.Face3(c[d][0],c[d][1],c[d][2]));for(d=0;d<this.faces.length;d++)g=
this.faces[d],this.faceVertexUvs[0].push([b(this.vertices[g.a]),b(this.vertices[g.b]),b(this.vertices[g.c])]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(a){var b=new THREE.Geometry;b.vertices.push(new THREE.Vector3,new THREE.Vector3(a||1,0,0),new THREE.Vector3,new THREE.Vector3(0,a||1,0),new THREE.Vector3,new THREE.Vector3(0,0,a||1));b.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));a=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,b,a,THREE.LinePieces)};
THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(a,b,c,d){THREE.Object3D.call(this);void 0===c&&(c=20);void 0===d&&(d=16776960);var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(0,0,0));e.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(e,new THREE.LineBasicMaterial({color:d}));this.add(this.line);e=new THREE.CylinderGeometry(0,0.05,0.25,5,1);this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:d}));this.cone.position.set(0,1,0);this.add(this.cone);b instanceof THREE.Vector3&&(this.position=
b);this.setDirection(a);this.setLength(c)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(a){var b=THREE.ArrowHelper.__v1.copy(a).normalize();0.999<b.y?this.rotation.set(0,0,0):-0.999>b.y?this.rotation.set(Math.PI,0,0):(a=THREE.ArrowHelper.__v2.set(b.z,0,-b.x).normalize(),b=Math.acos(b.y),a=THREE.ArrowHelper.__q1.setFromAxisAngle(a,b),this.rotation.setEulerFromQuaternion(a,this.eulerOrder))};
THREE.ArrowHelper.prototype.setLength=function(a){this.scale.set(a,a,a)};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.setHex(a);this.cone.material.color.setHex(a)};THREE.ArrowHelper.__v1=new THREE.Vector3;THREE.ArrowHelper.__v2=new THREE.Vector3;THREE.ArrowHelper.__q1=new THREE.Quaternion;
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){d.geometry.vertices.push(new THREE.Vector3);d.geometry.colors.push(new THREE.Color(b));void 0===d.pointMap[a]&&(d.pointMap[a]=[]);d.pointMap[a].push(d.geometry.vertices.length-1)}THREE.Line.call(this);var d=this;this.geometry=new THREE.Geometry;this.material=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors});this.type=THREE.LinePieces;this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=
{};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1",
"cf2",3355443);b("cf3","cf4",3355443);this.camera=a;this.update(a)};THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);
THREE.CameraHelper.prototype.update=function(){function a(a,d,e,f){THREE.CameraHelper.__v.set(d,e,f);THREE.CameraHelper.__projector.unprojectVector(THREE.CameraHelper.__v,THREE.CameraHelper.__c);a=b.pointMap[a];if(void 0!==a){d=0;for(e=a.length;d<e;d++)b.geometry.vertices[a[d]].copy(THREE.CameraHelper.__v)}}var b=this;THREE.CameraHelper.__c.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,1,-1);a("f1",-1,-1,1);
a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",0.7,1.1,-1);a("u2",-0.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);this.geometry.verticesNeedUpdate=!0};THREE.CameraHelper.__projector=new THREE.Projector;THREE.CameraHelper.__v=new THREE.Vector3;THREE.CameraHelper.__c=new THREE.Camera;
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.position=a.position;this.direction=new THREE.Vector3;this.direction.subVectors(a.target.position,a.position);var c=THREE.Math.clamp(a.intensity,0,1);this.color=a.color.clone();this.color.multiplyScalar(c);var c=this.color.getHex(),d=new THREE.SphereGeometry(b,16,8),e=new THREE.AsteriskGeometry(1.25*b,2.25*b),f=new THREE.MeshBasicMaterial({color:c,fog:!1}),g=new THREE.LineBasicMaterial({color:c,fog:!1});this.lightSphere=
new THREE.Mesh(d,f);this.lightRays=new THREE.Line(e,g,THREE.LinePieces);this.add(this.lightSphere);this.add(this.lightRays);this.lightSphere.properties.isGizmo=!0;this.lightSphere.properties.gizmoSubject=a;this.lightSphere.properties.gizmoRoot=this;this.targetSphere=null;void 0!==a.target.properties.targetInverse&&(d=new THREE.SphereGeometry(b,8,4),e=new THREE.MeshBasicMaterial({color:c,wireframe:!0,fog:!1}),this.targetSphere=new THREE.Mesh(d,e),this.targetSphere.position=a.target.position,this.targetSphere.properties.isGizmo=
!0,this.targetSphere.properties.gizmoSubject=a.target,this.targetSphere.properties.gizmoRoot=this.targetSphere,c=new THREE.LineDashedMaterial({color:c,dashSize:4,gapSize:4,opacity:0.75,transparent:!0,fog:!1}),d=new THREE.Geometry,d.vertices.push(this.position.clone()),d.vertices.push(this.targetSphere.position.clone()),d.computeLineDistances(),this.targetLine=new THREE.Line(d,c),this.targetLine.properties.isGizmo=!0);this.properties.isGizmo=!0};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.DirectionalLightHelper.prototype.update=function(){this.direction.subVectors(this.light.target.position,this.light.position);var a=THREE.Math.clamp(this.light.intensity,0,1);this.color.copy(this.light.color);this.color.multiplyScalar(a);this.lightSphere.material.color.copy(this.color);this.lightRays.material.color.copy(this.color);null!==this.targetSphere&&(this.targetSphere.material.color.copy(this.color),this.targetLine.material.color.copy(this.color),this.targetLine.geometry.vertices[0].copy(this.light.position),
this.targetLine.geometry.vertices[1].copy(this.light.target.position),this.targetLine.geometry.computeLineDistances(),this.targetLine.geometry.verticesNeedUpdate=!0)};
THREE.HemisphereLightHelper=function(a,b,c){THREE.Object3D.call(this);this.light=a;this.position=a.position;var d=THREE.Math.clamp(a.intensity,0,1);this.color=a.color.clone();this.color.multiplyScalar(d);var e=this.color.getHex();this.groundColor=a.groundColor.clone();this.groundColor.multiplyScalar(d);for(var d=this.groundColor.getHex(),f=new THREE.SphereGeometry(b,16,8,0,2*Math.PI,0,0.5*Math.PI),g=new THREE.SphereGeometry(b,16,8,0,2*Math.PI,0.5*Math.PI,Math.PI),h=new THREE.MeshBasicMaterial({color:e,
fog:!1}),l=new THREE.MeshBasicMaterial({color:d,fog:!1}),m=0,n=f.faces.length;m<n;m++)f.faces[m].materialIndex=0;m=0;for(n=g.faces.length;m<n;m++)g.faces[m].materialIndex=1;THREE.GeometryUtils.merge(f,g);this.lightSphere=new THREE.Mesh(f,new THREE.MeshFaceMaterial([h,l]));this.lightArrow=new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,1.1*(b+c),0),c,e);this.lightArrow.rotation.x=Math.PI;this.lightArrowGround=new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,-1.1*
(b+c),0),c,d);b=new THREE.Object3D;b.rotation.x=0.5*-Math.PI;b.add(this.lightSphere);b.add(this.lightArrow);b.add(this.lightArrowGround);this.add(b);this.lightSphere.properties.isGizmo=!0;this.lightSphere.properties.gizmoSubject=a;this.lightSphere.properties.gizmoRoot=this;this.properties.isGizmo=!0;this.target=new THREE.Vector3;this.lookAt(this.target)};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.HemisphereLightHelper.prototype.update=function(){var a=THREE.Math.clamp(this.light.intensity,0,1);this.color.copy(this.light.color);this.color.multiplyScalar(a);this.groundColor.copy(this.light.groundColor);this.groundColor.multiplyScalar(a);this.lightSphere.material.materials[0].color.copy(this.color);this.lightSphere.material.materials[1].color.copy(this.groundColor);this.lightArrow.setColor(this.color.getHex());this.lightArrowGround.setColor(this.groundColor.getHex());this.lookAt(this.target)};
THREE.PointLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.position=a.position;var c=THREE.Math.clamp(a.intensity,0,1);this.color=a.color.clone();this.color.multiplyScalar(c);var d=this.color.getHex(),c=new THREE.SphereGeometry(b,16,8),e=new THREE.AsteriskGeometry(1.25*b,2.25*b),f=new THREE.IcosahedronGeometry(1,2),g=new THREE.MeshBasicMaterial({color:d,fog:!1}),h=new THREE.LineBasicMaterial({color:d,fog:!1}),d=new THREE.MeshBasicMaterial({color:d,fog:!1,wireframe:!0,opacity:0.1,
transparent:!0});this.lightSphere=new THREE.Mesh(c,g);this.lightRays=new THREE.Line(e,h,THREE.LinePieces);this.lightDistance=new THREE.Mesh(f,d);c=a.distance;0===c?this.lightDistance.visible=!1:this.lightDistance.scale.set(c,c,c);this.add(this.lightSphere);this.add(this.lightRays);this.add(this.lightDistance);this.lightSphere.properties.isGizmo=!0;this.lightSphere.properties.gizmoSubject=a;this.lightSphere.properties.gizmoRoot=this;this.properties.isGizmo=!0};THREE.PointLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.PointLightHelper.prototype.update=function(){var a=THREE.Math.clamp(this.light.intensity,0,1);this.color.copy(this.light.color);this.color.multiplyScalar(a);this.lightSphere.material.color.copy(this.color);this.lightRays.material.color.copy(this.color);this.lightDistance.material.color.copy(this.color);a=this.light.distance;0===a?this.lightDistance.visible=!1:(this.lightDistance.visible=!0,this.lightDistance.scale.set(a,a,a))};
THREE.SpotLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.position=a.position;this.direction=new THREE.Vector3;this.direction.subVectors(a.target.position,a.position);var c=THREE.Math.clamp(a.intensity,0,1);this.color=a.color.clone();this.color.multiplyScalar(c);var c=this.color.getHex(),d=new THREE.SphereGeometry(b,16,8),e=new THREE.AsteriskGeometry(1.25*b,2.25*b),f=new THREE.CylinderGeometry(1E-4,1,1,8,1,!0),g=new THREE.Matrix4;g.rotateX(-Math.PI/2);g.translate(new THREE.Vector3(0,
-0.5,0));f.applyMatrix(g);var h=new THREE.MeshBasicMaterial({color:c,fog:!1}),g=new THREE.LineBasicMaterial({color:c,fog:!1}),l=new THREE.MeshBasicMaterial({color:c,fog:!1,wireframe:!0,opacity:0.3,transparent:!0});this.lightSphere=new THREE.Mesh(d,h);this.lightCone=new THREE.Mesh(f,l);d=a.distance?a.distance:1E4;f=2*d*Math.tan(0.5*a.angle);this.lightCone.scale.set(f,f,d);this.lightRays=new THREE.Line(e,g,THREE.LinePieces);this.gyroscope=new THREE.Gyroscope;this.gyroscope.add(this.lightSphere);this.gyroscope.add(this.lightRays);
this.add(this.gyroscope);this.add(this.lightCone);this.lookAt(a.target.position);this.lightSphere.properties.isGizmo=!0;this.lightSphere.properties.gizmoSubject=a;this.lightSphere.properties.gizmoRoot=this;this.targetSphere=null;void 0!==a.target.properties.targetInverse&&(e=new THREE.SphereGeometry(b,8,4),g=new THREE.MeshBasicMaterial({color:c,wireframe:!0,fog:!1}),this.targetSphere=new THREE.Mesh(e,g),this.targetSphere.position=a.target.position,this.targetSphere.properties.isGizmo=!0,this.targetSphere.properties.gizmoSubject=
a.target,this.targetSphere.properties.gizmoRoot=this.targetSphere,c=new THREE.LineDashedMaterial({color:c,dashSize:4,gapSize:4,opacity:0.75,transparent:!0,fog:!1}),e=new THREE.Geometry,e.vertices.push(this.position.clone()),e.vertices.push(this.targetSphere.position.clone()),e.computeLineDistances(),this.targetLine=new THREE.Line(e,c),this.targetLine.properties.isGizmo=!0);this.properties.isGizmo=!0};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.update=function(){this.direction.subVectors(this.light.target.position,this.light.position);this.lookAt(this.light.target.position);var a=this.light.distance?this.light.distance:1E4,b=2*a*Math.tan(0.5*this.light.angle);this.lightCone.scale.set(b,b,a);a=THREE.Math.clamp(this.light.intensity,0,1);this.color.copy(this.light.color);this.color.multiplyScalar(a);this.lightSphere.material.color.copy(this.color);this.lightRays.material.color.copy(this.color);this.lightCone.material.color.copy(this.color);
null!==this.targetSphere&&(this.targetSphere.material.color.copy(this.color),this.targetLine.material.color.copy(this.color),this.targetLine.geometry.vertices[0].copy(this.light.position),this.targetLine.geometry.vertices[1].copy(this.light.target.position),this.targetLine.geometry.computeLineDistances(),this.targetLine.geometry.verticesNeedUpdate=!0)};THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);
THREE.LensFlare=function(a,b,c,d,e){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==a&&this.add(a,b,c,d,e)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);
THREE.LensFlare.prototype.add=function(a,b,c,d,e,f){void 0===b&&(b=-1);void 0===c&&(c=0);void 0===f&&(f=1);void 0===e&&(e=new THREE.Color(16777215));void 0===d&&(d=THREE.NormalBlending);c=Math.min(c,Math.max(0,c));this.lensFlares.push({texture:a,size:b,distance:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:f,color:e,blending:d})};
THREE.LensFlare.prototype.updateLensFlares=function(){var a,b=this.lensFlares.length,c,d=2*-this.positionScreen.x,e=2*-this.positionScreen.y;for(a=0;a<b;a++)c=this.lensFlares[a],c.x=this.positionScreen.x+d*c.distance,c.y=this.positionScreen.y+e*c.distance,c.wantedRotation=0.25*c.x*Math.PI,c.rotation+=0.25*(c.wantedRotation-c.rotation)};
THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);
THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={startFrame:b,endFrame:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=b;this.animationsList.push(b)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b=/([a-z]+)(\d+)/,c,d={},e=this.geometry,f=0,g=e.morphTargets.length;f<g;f++){var h=e.morphTargets[f].name.match(b);if(h&&1<h.length){var l=h[1];d[l]||(d[l]={start:Infinity,end:-Infinity});h=d[l];f<h.start&&(h.start=f);f>h.end&&(h.end=f);c||(c=l)}}for(l in d)h=d[l],this.createAnimation(l,h.start,h.end,a);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;if(a=this.animationsMap[a])b=a.time;return b};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;if(a=this.animationsMap[a])b=a.duration;return b};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):console.warn("animation["+a+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var e=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var f=d.startFrame+THREE.Math.clamp(Math.floor(d.time/e),0,d.length-1),g=d.weight;
f!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*g,this.morphTargetInfluences[f]=0,d.lastFrame=d.currentFrame,d.currentFrame=f);e=d.time%e/e;d.directionBackwards&&(e=1-e);this.morphTargetInfluences[d.currentFrame]=e*g;this.morphTargetInfluences[d.lastFrame]=(1-e)*g}}};
THREE.LensFlarePlugin=function(){function a(a,c){var d=b.createProgram(),e=b.createShader(b.FRAGMENT_SHADER),f=b.createShader(b.VERTEX_SHADER),g="precision "+c+" float;\n";b.shaderSource(e,g+a.fragmentShader);b.shaderSource(f,g+a.vertexShader);b.compileShader(e);b.compileShader(f);b.attachShader(d,e);b.attachShader(d,f);b.linkProgram(d);return d}var b,c,d,e,f,g,h,l,m,n,q,p,t;this.init=function(u){b=u.context;c=u;d=u.getPrecision();e=new Float32Array(16);f=new Uint16Array(6);u=0;e[u++]=-1;e[u++]=-1;
e[u++]=0;e[u++]=0;e[u++]=1;e[u++]=-1;e[u++]=1;e[u++]=0;e[u++]=1;e[u++]=1;e[u++]=1;e[u++]=1;e[u++]=-1;e[u++]=1;e[u++]=0;e[u++]=1;u=0;f[u++]=0;f[u++]=1;f[u++]=2;f[u++]=0;f[u++]=2;f[u++]=3;g=b.createBuffer();h=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,e,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,h);b.bufferData(b.ELEMENT_ARRAY_BUFFER,f,b.STATIC_DRAW);l=b.createTexture();m=b.createTexture();b.bindTexture(b.TEXTURE_2D,l);b.texImage2D(b.TEXTURE_2D,0,b.RGB,16,16,
0,b.RGB,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.bindTexture(b.TEXTURE_2D,m);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,16,16,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);0>=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(n=!1,q=a(THREE.ShaderFlares.lensFlare,d)):(n=!0,q=a(THREE.ShaderFlares.lensFlareVertexTexture,d));p={};t={};p.vertex=b.getAttribLocation(q,"position");p.uv=b.getAttribLocation(q,"uv");t.renderType=b.getUniformLocation(q,"renderType");t.map=b.getUniformLocation(q,"map");t.occlusionMap=b.getUniformLocation(q,"occlusionMap");t.opacity=
b.getUniformLocation(q,"opacity");t.color=b.getUniformLocation(q,"color");t.scale=b.getUniformLocation(q,"scale");t.rotation=b.getUniformLocation(q,"rotation");t.screenPosition=b.getUniformLocation(q,"screenPosition")};this.render=function(a,d,e,f){a=a.__webglFlares;var v=a.length;if(v){var B=new THREE.Vector3,w=f/e,F=0.5*e,K=0.5*f,C=16/f,z=new THREE.Vector2(C*w,C),N=new THREE.Vector3(1,1,0),O=new THREE.Vector2(1,1),L=t,C=p;b.useProgram(q);b.enableVertexAttribArray(p.vertex);b.enableVertexAttribArray(p.uv);
b.uniform1i(L.occlusionMap,0);b.uniform1i(L.map,1);b.bindBuffer(b.ARRAY_BUFFER,g);b.vertexAttribPointer(C.vertex,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(C.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,h);b.disable(b.CULL_FACE);b.depthMask(!1);var U,D,M,I,J;for(U=0;U<v;U++)if(C=16/f,z.set(C*w,C),I=a[U],B.set(I.matrixWorld.elements[12],I.matrixWorld.elements[13],I.matrixWorld.elements[14]),B.applyMatrix4(d.matrixWorldInverse),B.applyProjection(d.projectionMatrix),N.copy(B),O.x=N.x*F+F,
O.y=N.y*K+K,n||0<O.x&&O.x<e&&0<O.y&&O.y<f){b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,l);b.copyTexImage2D(b.TEXTURE_2D,0,b.RGB,O.x-8,O.y-8,16,16,0);b.uniform1i(L.renderType,0);b.uniform2f(L.scale,z.x,z.y);b.uniform3f(L.screenPosition,N.x,N.y,N.z);b.disable(b.BLEND);b.enable(b.DEPTH_TEST);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,m);b.copyTexImage2D(b.TEXTURE_2D,0,b.RGBA,O.x-8,O.y-8,16,16,0);b.uniform1i(L.renderType,1);b.disable(b.DEPTH_TEST);
b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,l);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);I.positionScreen.copy(N);I.customUpdateCallback?I.customUpdateCallback(I):I.updateLensFlares();b.uniform1i(L.renderType,2);b.enable(b.BLEND);D=0;for(M=I.lensFlares.length;D<M;D++)J=I.lensFlares[D],0.001<J.opacity&&0.001<J.scale&&(N.x=J.x,N.y=J.y,N.z=J.z,C=J.size*J.scale/f,z.x=C*w,z.y=C,b.uniform3f(L.screenPosition,N.x,N.y,N.z),b.uniform2f(L.scale,z.x,z.y),b.uniform1f(L.rotation,J.rotation),b.uniform1f(L.opacity,
J.opacity),b.uniform3f(L.color,J.color.r,J.color.g,J.color.b),c.setBlending(J.blending,J.blendEquation,J.blendSrc,J.blendDst),c.setTexture(J.texture,1),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0))}b.enable(b.CULL_FACE);b.enable(b.DEPTH_TEST);b.depthMask(!0)}}};
THREE.ShadowMapPlugin=function(){var a,b,c,d,e,f,g=new THREE.Frustum,h=new THREE.Matrix4,l=new THREE.Vector3,m=new THREE.Vector3,n=new THREE.Vector3;this.init=function(g){a=g.context;b=g;g=THREE.ShaderLib.depthRGBA;var h=THREE.UniformsUtils.clone(g.uniforms);c=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h});d=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0});e=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,
vertexShader:g.vertexShader,uniforms:h,skinning:!0});f=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0,skinning:!0});c._shadowPass=!0;d._shadowPass=!0;e._shadowPass=!0;f._shadowPass=!0};this.render=function(a,c){b.shadowMapEnabled&&b.shadowMapAutoUpdate&&this.update(a,c)};this.update=function(q,p){var t,u,r,s,A,v,B,w,F,K=[];s=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);b.shadowMapCullFace===THREE.CullFaceFront?
a.cullFace(a.FRONT):a.cullFace(a.BACK);b.setDepthTest(!0);t=0;for(u=q.__lights.length;t<u;t++)if(r=q.__lights[t],r.castShadow)if(r instanceof THREE.DirectionalLight&&r.shadowCascade)for(A=0;A<r.shadowCascadeCount;A++){var C;if(r.shadowCascadeArray[A])C=r.shadowCascadeArray[A];else{F=r;B=A;C=new THREE.DirectionalLight;C.isVirtual=!0;C.onlyShadow=!0;C.castShadow=!0;C.shadowCameraNear=F.shadowCameraNear;C.shadowCameraFar=F.shadowCameraFar;C.shadowCameraLeft=F.shadowCameraLeft;C.shadowCameraRight=F.shadowCameraRight;
C.shadowCameraBottom=F.shadowCameraBottom;C.shadowCameraTop=F.shadowCameraTop;C.shadowCameraVisible=F.shadowCameraVisible;C.shadowDarkness=F.shadowDarkness;C.shadowBias=F.shadowCascadeBias[B];C.shadowMapWidth=F.shadowCascadeWidth[B];C.shadowMapHeight=F.shadowCascadeHeight[B];C.pointsWorld=[];C.pointsFrustum=[];w=C.pointsWorld;v=C.pointsFrustum;for(var z=0;8>z;z++)w[z]=new THREE.Vector3,v[z]=new THREE.Vector3;w=F.shadowCascadeNearZ[B];F=F.shadowCascadeFarZ[B];v[0].set(-1,-1,w);v[1].set(1,-1,w);v[2].set(-1,
1,w);v[3].set(1,1,w);v[4].set(-1,-1,F);v[5].set(1,-1,F);v[6].set(-1,1,F);v[7].set(1,1,F);C.originalCamera=p;v=new THREE.Gyroscope;v.position=r.shadowCascadeOffset;v.add(C);v.add(C.target);p.add(v);r.shadowCascadeArray[A]=C;console.log("Created virtualLight",C)}B=r;w=A;F=B.shadowCascadeArray[w];F.position.copy(B.position);F.target.position.copy(B.target.position);F.lookAt(F.target);F.shadowCameraVisible=B.shadowCameraVisible;F.shadowDarkness=B.shadowDarkness;F.shadowBias=B.shadowCascadeBias[w];v=B.shadowCascadeNearZ[w];
B=B.shadowCascadeFarZ[w];F=F.pointsFrustum;F[0].z=v;F[1].z=v;F[2].z=v;F[3].z=v;F[4].z=B;F[5].z=B;F[6].z=B;F[7].z=B;K[s]=C;s++}else K[s]=r,s++;t=0;for(u=K.length;t<u;t++){r=K[t];r.shadowMap||(A=THREE.LinearFilter,b.shadowMapType===THREE.PCFSoftShadowMap&&(A=THREE.NearestFilter),r.shadowMap=new THREE.WebGLRenderTarget(r.shadowMapWidth,r.shadowMapHeight,{minFilter:A,magFilter:A,format:THREE.RGBAFormat}),r.shadowMapSize=new THREE.Vector2(r.shadowMapWidth,r.shadowMapHeight),r.shadowMatrix=new THREE.Matrix4);
if(!r.shadowCamera){if(r instanceof THREE.SpotLight)r.shadowCamera=new THREE.PerspectiveCamera(r.shadowCameraFov,r.shadowMapWidth/r.shadowMapHeight,r.shadowCameraNear,r.shadowCameraFar);else if(r instanceof THREE.DirectionalLight)r.shadowCamera=new THREE.OrthographicCamera(r.shadowCameraLeft,r.shadowCameraRight,r.shadowCameraTop,r.shadowCameraBottom,r.shadowCameraNear,r.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}q.add(r.shadowCamera);b.autoUpdateScene&&q.updateMatrixWorld()}r.shadowCameraVisible&&
!r.cameraHelper&&(r.cameraHelper=new THREE.CameraHelper(r.shadowCamera),r.shadowCamera.add(r.cameraHelper));if(r.isVirtual&&C.originalCamera==p){A=p;s=r.shadowCamera;v=r.pointsFrustum;F=r.pointsWorld;l.set(Infinity,Infinity,Infinity);m.set(-Infinity,-Infinity,-Infinity);for(B=0;8>B;B++)w=F[B],w.copy(v[B]),THREE.ShadowMapPlugin.__projector.unprojectVector(w,A),w.applyMatrix4(s.matrixWorldInverse),w.x<l.x&&(l.x=w.x),w.x>m.x&&(m.x=w.x),w.y<l.y&&(l.y=w.y),w.y>m.y&&(m.y=w.y),w.z<l.z&&(l.z=w.z),w.z>m.z&&
(m.z=w.z);s.left=l.x;s.right=m.x;s.top=m.y;s.bottom=l.y;s.updateProjectionMatrix()}s=r.shadowMap;v=r.shadowMatrix;A=r.shadowCamera;A.position.getPositionFromMatrix(r.matrixWorld);n.getPositionFromMatrix(r.target.matrixWorld);A.lookAt(n);A.updateMatrixWorld();A.matrixWorldInverse.getInverse(A.matrixWorld);r.cameraHelper&&(r.cameraHelper.visible=r.shadowCameraVisible);r.shadowCameraVisible&&r.cameraHelper.update();v.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);v.multiply(A.projectionMatrix);v.multiply(A.matrixWorldInverse);
h.multiplyMatrices(A.projectionMatrix,A.matrixWorldInverse);g.setFromMatrix(h);b.setRenderTarget(s);b.clear();F=q.__webglObjects;r=0;for(s=F.length;r<s;r++)if(B=F[r],v=B.object,B.render=!1,v.visible&&v.castShadow&&(!(v instanceof THREE.Mesh||v instanceof THREE.ParticleSystem)||!v.frustumCulled||g.intersectsObject(v)))v._modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,v.matrixWorld),B.render=!0;r=0;for(s=F.length;r<s;r++)B=F[r],B.render&&(v=B.object,B=B.buffer,z=v.material instanceof THREE.MeshFaceMaterial?
v.material.materials[0]:v.material,w=0<v.geometry.morphTargets.length&&z.morphTargets,z=v instanceof THREE.SkinnedMesh&&z.skinning,w=v.customDepthMaterial?v.customDepthMaterial:z?w?f:e:w?d:c,B instanceof THREE.BufferGeometry?b.renderBufferDirect(A,q.__lights,null,w,B,v):b.renderBuffer(A,q.__lights,null,w,B,v));F=q.__webglObjectsImmediate;r=0;for(s=F.length;r<s;r++)B=F[r],v=B.object,v.visible&&v.castShadow&&(v._modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,v.matrixWorld),b.renderImmediateObject(A,
q.__lights,null,c,v))}t=b.getClearColor();u=b.getClearAlpha();a.clearColor(t.r,t.g,t.b,u);a.enable(a.BLEND);b.shadowMapCullFace===THREE.CullFaceFront&&a.cullFace(a.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;
THREE.SpritePlugin=function(){function a(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var b,c,d,e,f,g,h,l,m,n;this.init=function(a){b=a.context;c=a;d=a.getPrecision();e=new Float32Array(16);f=new Uint16Array(6);a=0;e[a++]=-1;e[a++]=-1;e[a++]=0;e[a++]=0;e[a++]=1;e[a++]=-1;e[a++]=1;e[a++]=0;e[a++]=1;e[a++]=1;e[a++]=1;e[a++]=1;e[a++]=-1;e[a++]=1;e[a++]=0;e[a++]=1;a=0;f[a++]=0;f[a++]=1;f[a++]=2;f[a++]=0;f[a++]=2;f[a++]=3;g=b.createBuffer();h=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,
e,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,h);b.bufferData(b.ELEMENT_ARRAY_BUFFER,f,b.STATIC_DRAW);a=THREE.ShaderSprite.sprite;var p=b.createProgram(),t=b.createShader(b.FRAGMENT_SHADER),u=b.createShader(b.VERTEX_SHADER),r="precision "+d+" float;\n";b.shaderSource(t,r+a.fragmentShader);b.shaderSource(u,r+a.vertexShader);b.compileShader(t);b.compileShader(u);b.attachShader(p,t);b.attachShader(p,u);b.linkProgram(p);l=p;m={};n={};m.position=b.getAttribLocation(l,"position");m.uv=b.getAttribLocation(l,
"uv");n.uvOffset=b.getUniformLocation(l,"uvOffset");n.uvScale=b.getUniformLocation(l,"uvScale");n.rotation=b.getUniformLocation(l,"rotation");n.scale=b.getUniformLocation(l,"scale");n.alignment=b.getUniformLocation(l,"alignment");n.color=b.getUniformLocation(l,"color");n.map=b.getUniformLocation(l,"map");n.opacity=b.getUniformLocation(l,"opacity");n.useScreenCoordinates=b.getUniformLocation(l,"useScreenCoordinates");n.sizeAttenuation=b.getUniformLocation(l,"sizeAttenuation");n.screenPosition=b.getUniformLocation(l,
"screenPosition");n.modelViewMatrix=b.getUniformLocation(l,"modelViewMatrix");n.projectionMatrix=b.getUniformLocation(l,"projectionMatrix");n.fogType=b.getUniformLocation(l,"fogType");n.fogDensity=b.getUniformLocation(l,"fogDensity");n.fogNear=b.getUniformLocation(l,"fogNear");n.fogFar=b.getUniformLocation(l,"fogFar");n.fogColor=b.getUniformLocation(l,"fogColor");n.alphaTest=b.getUniformLocation(l,"alphaTest")};this.render=function(d,e,f,u){var r=d.__webglSprites,s=r.length;if(s){var A=m,v=n,B=u/
f;f*=0.5;var w=0.5*u;b.useProgram(l);b.enableVertexAttribArray(A.position);b.enableVertexAttribArray(A.uv);b.disable(b.CULL_FACE);b.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,g);b.vertexAttribPointer(A.position,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(A.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,h);b.uniformMatrix4fv(v.projectionMatrix,!1,e.projectionMatrix.elements);b.activeTexture(b.TEXTURE0);b.uniform1i(v.map,0);var F=A=0,K=d.fog;K?(b.uniform3f(v.fogColor,K.color.r,K.color.g,K.color.b),
K instanceof THREE.Fog?(b.uniform1f(v.fogNear,K.near),b.uniform1f(v.fogFar,K.far),b.uniform1i(v.fogType,1),F=A=1):K instanceof THREE.FogExp2&&(b.uniform1f(v.fogDensity,K.density),b.uniform1i(v.fogType,2),F=A=2)):(b.uniform1i(v.fogType,0),F=A=0);for(var C,z,N=[],K=0;K<s;K++)C=r[K],z=C.material,C.visible&&0!==z.opacity&&(z.useScreenCoordinates?C.z=-C.position.z:(C._modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,C.matrixWorld),C.z=-C._modelViewMatrix.elements[14]));r.sort(a);for(K=0;K<s;K++)C=
r[K],z=C.material,C.visible&&0!==z.opacity&&z.map&&(z.map.image&&z.map.image.width)&&(b.uniform1f(v.alphaTest,z.alphaTest),!0===z.useScreenCoordinates?(b.uniform1i(v.useScreenCoordinates,1),b.uniform3f(v.screenPosition,(C.position.x*c.devicePixelRatio-f)/f,(w-C.position.y*c.devicePixelRatio)/w,Math.max(0,Math.min(1,C.position.z))),N[0]=c.devicePixelRatio,N[1]=c.devicePixelRatio):(b.uniform1i(v.useScreenCoordinates,0),b.uniform1i(v.sizeAttenuation,z.sizeAttenuation?1:0),b.uniformMatrix4fv(v.modelViewMatrix,
!1,C._modelViewMatrix.elements),N[0]=1,N[1]=1),e=d.fog&&z.fog?F:0,A!==e&&(b.uniform1i(v.fogType,e),A=e),e=1/(z.scaleByViewport?u:1),N[0]*=e*B*C.scale.x,N[1]*=e*C.scale.y,b.uniform2f(v.uvScale,z.uvScale.x,z.uvScale.y),b.uniform2f(v.uvOffset,z.uvOffset.x,z.uvOffset.y),b.uniform2f(v.alignment,z.alignment.x,z.alignment.y),b.uniform1f(v.opacity,z.opacity),b.uniform3f(v.color,z.color.r,z.color.g,z.color.b),b.uniform1f(v.rotation,C.rotation),b.uniform2fv(v.scale,N),c.setBlending(z.blending,z.blendEquation,
z.blendSrc,z.blendDst),c.setDepthTest(z.depthTest),c.setDepthWrite(z.depthWrite),c.setTexture(z.map,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0));b.enable(b.CULL_FACE)}}};
THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var a,b,c,d,e,f,g=new THREE.Frustum,h=new THREE.Matrix4;this.init=function(g){a=g.context;b=g;g=THREE.ShaderLib.depthRGBA;var h=THREE.UniformsUtils.clone(g.uniforms);c=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h});d=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0});e=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,
vertexShader:g.vertexShader,uniforms:h,skinning:!0});f=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0,skinning:!0});c._shadowPass=!0;d._shadowPass=!0;e._shadowPass=!0;f._shadowPass=!0};this.render=function(a,b){this.enabled&&this.update(a,b)};this.update=function(l,m){var n,q,p,t,u,r;a.clearColor(1,1,1,1);a.disable(a.BLEND);b.setDepthTest(!0);b.autoUpdateScene&&l.updateMatrixWorld();m.matrixWorldInverse.getInverse(m.matrixWorld);h.multiplyMatrices(m.projectionMatrix,
m.matrixWorldInverse);g.setFromMatrix(h);b.setRenderTarget(this.renderTarget);b.clear();r=l.__webglObjects;n=0;for(q=r.length;n<q;n++)if(p=r[n],u=p.object,p.render=!1,u.visible&&(!(u instanceof THREE.Mesh||u instanceof THREE.ParticleSystem)||!u.frustumCulled||g.intersectsObject(u)))u._modelViewMatrix.multiplyMatrices(m.matrixWorldInverse,u.matrixWorld),p.render=!0;var s;n=0;for(q=r.length;n<q;n++)if(p=r[n],p.render&&(u=p.object,p=p.buffer,!(u instanceof THREE.ParticleSystem)||u.customDepthMaterial))(s=
u.material instanceof THREE.MeshFaceMaterial?u.material.materials[0]:u.material)&&b.setMaterialFaces(u.material),t=0<u.geometry.morphTargets.length&&s.morphTargets,s=u instanceof THREE.SkinnedMesh&&s.skinning,t=u.customDepthMaterial?u.customDepthMaterial:s?t?f:e:t?d:c,p instanceof THREE.BufferGeometry?b.renderBufferDirect(m,l.__lights,null,t,p,u):b.renderBuffer(m,l.__lights,null,t,p,u);r=l.__webglObjectsImmediate;n=0;for(q=r.length;n<q;n++)p=r[n],u=p.object,u.visible&&(u._modelViewMatrix.multiplyMatrices(m.matrixWorldInverse,
u.matrixWorld),b.renderImmediateObject(m,l.__lights,null,c,u));n=b.getClearColor();q=b.getClearAlpha();a.clearColor(n.r,n.g,n.b,q);a.enable(a.BLEND)}};
THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",
fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}};_typeface_js&&_typeface_js.loadFace&&_typeface_js.loadFace({glyphs:{S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},
"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},
",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},
'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},
"\u0192":{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},
J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},q:{x_min:0,x_max:683,ha:876,
o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},
D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},z:{x_min:-0.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},w:{x_min:0,x_max:1009.71875,
ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},
"\u2122":{x_min:0,x_max:894,ha:1E3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},"\\":{x_min:-0.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},
"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},
M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},
"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "}," ":{x_min:0,x_max:0,ha:375},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},
X:{x_min:-0.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},
"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},"+":{x_min:23,x_max:768,ha:792,
o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"}":{x_min:0,
x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},a:{x_min:0,
x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},
T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},
j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},
1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},
W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},
B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},
H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"&":{x_min:-3,
x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},
I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},"(":{x_min:0,x_max:318.0625,ha:415,
o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},
F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},
"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},
"0":{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},
f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},i:{x_min:14,x_max:136,
ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},
A:{x_min:0.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},
3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},"]":{x_min:0,
x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},
9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},
8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},
p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},
R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},
5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "}},cssFontWeight:"normal",ascender:1189,underlinePosition:-100,cssFontStyle:"normal",boundingBox:{yMin:-334,
xMin:-77.78125,yMax:1077,xMax:1263.890625},resolution:1E3,original_font_information:{postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) \u039cagenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"\u039cagenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:'Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r\n\r\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r\n\r\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r\n\r\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r\n\r\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r\n\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',
manufacturer_name:"\u039cagenta ltd",font_sub_family_name:"Regular"},descender:-334,familyName:"Helvetiker",lineHeight:1522,underlineThickness:50});THREE.AnaglyphEffect=function(a,b,c){var d=new THREE.Matrix4,e=new THREE.Matrix4,f,g,h,l,m=new THREE.PerspectiveCamera;m.matrixAutoUpdate=!1;var n=new THREE.PerspectiveCamera;n.matrixAutoUpdate=!1;var q=new THREE.OrthographicCamera(-1,1,1,-1,0,1),p=new THREE.Scene,t={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat};void 0===b&&(b=512);void 0===c&&(c=512);var u=new THREE.WebGLRenderTarget(b,c,t),r=new THREE.WebGLRenderTarget(b,c,t),s=new THREE.ShaderMaterial({uniforms:{mapLeft:{type:"t",
value:u},mapRight:{type:"t",value:r}},vertexShader:"varying vec2 vUv;\nvoid main() {\n\tvUv = vec2( uv.x, uv.y );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D mapLeft;\nuniform sampler2D mapRight;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 colorL, colorR;\n\tvec2 uv = vUv;\n\tcolorL = texture2D( mapLeft, uv );\n\tcolorR = texture2D( mapRight, uv );\n\tgl_FragColor = vec4( colorL.g * 0.7 + colorL.b * 0.3, colorR.g, colorR.b, colorL.a + colorR.a ) * 1.1;\n}"});
b=new THREE.Mesh(new THREE.PlaneGeometry(2,2),s);p.add(b);this.setSize=function(b,c){u=new THREE.WebGLRenderTarget(b,c,t);r=new THREE.WebGLRenderTarget(b,c,t);s.uniforms.mapLeft.value=u;s.uniforms.mapRight.value=r;a.setSize(b,c)};this.render=function(b,c){b.updateMatrixWorld();void 0===c.parent&&c.updateMatrixWorld();if(f!==c.aspect||g!==c.near||h!==c.far||l!==c.fov){f=c.aspect;g=c.near;h=c.far;l=c.fov;var s=c.projectionMatrix.clone(),t=0.5*(125/30),F=t*g/125,K=g*Math.tan(THREE.Math.degToRad(0.5*
l)),C;d.elements[12]=t;e.elements[12]=-t;t=-K*f+F;C=K*f+F;s.elements[0]=2*g/(C-t);s.elements[8]=(C+t)/(C-t);m.projectionMatrix.copy(s);t=-K*f-F;C=K*f-F;s.elements[0]=2*g/(C-t);s.elements[8]=(C+t)/(C-t);n.projectionMatrix.copy(s)}m.matrixWorld.copy(c.matrixWorld).multiply(e);m.position.copy(c.position);m.near=c.near;m.far=c.far;a.render(b,m,u,!0);n.matrixWorld.copy(c.matrixWorld).multiply(d);n.position.copy(c.position);n.near=c.near;n.far=c.far;a.render(b,n,r,!0);a.render(p,q)}};window.HexMapEditor=window.HexMapEditor||{};window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}());
HexMapEditor.init=function(){HexMapEditor.mapSamples=[];HexMapEditor.mapSamples[0]={name:"Mars",filename:"sample01.json"};HexMapEditor.mapSamples[1]={name:"Dam",filename:"sample02.json"};var a=window.innerWidth,b=window.innerHeight,c=a/b;HexMapEditor.isCameraMoving=!1;HexMapEditor.isCameraRotating=!1;HexMapEditor.isHeightDragging=!1;HexMapEditor.isShiftDown=!1;HexMapEditor.dontClickMe=!1;HexMapEditor.time=0;HexMapEditor.lastTime=Date.now();HexMapEditor.timeDelta=0;HexMapEditor.tileBeingEdited=null;
HexMapEditor.tileBeingCloned=null;HexMapEditor.mouse2D={x:0,y:0};HexMapEditor.dragStart={x:0,y:0};HexMapEditor.dragDelay=25;HexMapEditor.heightChangeMultiplier=50;HexMapEditor.rotationMultiplier=100;HexMapEditor.tiltMultiplier=50;HexMapEditor.cameraMovementMultiplier=1;HexMapEditor.clickIntersects=[];HexMapEditor.theta=0;HexMapEditor.tilt=0;HexMapEditor.cameraDistance=600;HexMapEditor.cameraAimPoint={x:0,y:0};HexMapEditor.renderer=new THREE.WebGLRenderer({antialias:!1});HexMapEditor.camera=new THREE.PerspectiveCamera(45,
c,0.1,1E4);HexMapEditor.scene=new THREE.Scene;HexMapEditor.camera.up.set(0,0,1);HexMapEditor.scene.add(HexMapEditor.camera);HexMapEditor.renderer.setSize(a,b);HexMapEditor.light=new THREE.PointLight(16720486,1,300);HexMapEditor.light.position.x=-100;HexMapEditor.light.position.y=100;HexMapEditor.light.position.z=100;HexMapEditor.scene.add(HexMapEditor.light);HexMapEditor.scene.add(THREE.AmbientLight(6710886));HexMapEditor.directionalLight=new THREE.DirectionalLight(16777215,1.4);HexMapEditor.directionalLight.position.set(0.6,
0.6,1).normalize();HexMapEditor.scene.add(HexMapEditor.directionalLight);document.body.appendChild(HexMapEditor.renderer.domElement);HexMapEditor.stats=new Stats;HexMapEditor.stats.domElement.style.position="absolute";HexMapEditor.stats.domElement.style.bottom="10px";HexMapEditor.stats.domElement.style.left="10px";document.body.appendChild(HexMapEditor.stats.domElement);HexMapEditor.anaglyph=!1;HexMapEditor.effect=new THREE.AnaglyphEffect(HexMapEditor.renderer);HexMapEditor.effect.setSize(a,b);HexMapEditor.projector=
new THREE.Projector;$("#startButton").click(HexMapEditor.start);$("#settingsToggleDiv").click(HexMapEditor.showSettings);$("#settingsButton1").click(HexMapEditor.showInstructions);$("#settingsButton1").append("Controls");$("#settingsButton2").click(HexMapEditor.showClone);$("#settingsButton2").append("Clone tool");$("#settingsButton3").click(HexMapEditor.showMaterialsList);$("#settingsButton3").append("Materials");$("#settingsButton4").click(HexMapEditor.showImportExport);$("#settingsButton4").append("Import/Export");
$("#settingsButton5").click(HexMapEditor.showMapSamples);$("#settingsButton5").append("Sample Maps");$("#settingsButton6").click(HexMapEditor.anaglyphToggle);HexMapEditor.isAnaglyphToggled=!0;$("#settingsButton6").click();$("#settingsButton7").append("CLOSE");$("#settingsButton7").click(HexMapEditor.hideSettings);$("#importButton").click(HexMapEditor.importMap);$("#exportButton").click(HexMapEditor.exportMap);$("#closeImportExportButton").click(HexMapEditor.hideImportExport);document.addEventListener("mousemove",
HexMapEditor.onMouseMove,!1);document.addEventListener("keydown",HexMapEditor.onKeyDown,!1);document.addEventListener("keyup",HexMapEditor.onKeyUp,!1);document.addEventListener("mousewheel",HexMapEditor.onMouseWheel,!1);$(HexMapEditor.renderer.domElement).dblclick(HexMapEditor.onMouseDoubleClick);$(HexMapEditor.renderer.domElement).click(HexMapEditor.onMouseClick);$(HexMapEditor.renderer.domElement).mousedown(HexMapEditor.onMouseDown);$(HexMapEditor.renderer.domElement).mouseup(HexMapEditor.onMouseUp);
window.addEventListener("resize",HexMapEditor.onWindowResize,!1);HexMapEditor.initMaterials();HexMapEditor.initEditTileDiv();HexMapEditor.initClone();$("#menu").toggle()};
HexMapEditor.addMaterial=function(a,b,c,d,e,f){var g={},h=0;null==b?b=HexMapEditor.materials.length:h=1;void 0!==d&&null!=d&&(g.color=d);void 0!==e&&null!=e&&(g.emissive=e);void 0!==f&&null!=f&&(g.wireframe=f);switch(c){case 0:HexMapEditor.materials.splice(b,h,{name:a,type:c,color:d,material:new THREE.MeshBasicMaterial(g)});break;case 1:HexMapEditor.materials.splice(b,h,{name:a,type:c,color:d,material:new THREE.MeshLambertMaterial(g)});break;case 2:HexMapEditor.materials.splice(b,h,{name:a,type:c,
color:d,material:new THREE.MeshPhongMaterial(g)});break;case 3:HexMapEditor.materials.splice(b,h,{name:a,type:c,color:d,material:new THREE.MeshNormalMaterial(g)})}};
HexMapEditor.initMaterials=function(){HexMapEditor.materialTypes=[];HexMapEditor.materialTypes[0]="Mesh Basic Material";HexMapEditor.materialTypes[1]="Mesh Lambert Material";HexMapEditor.materialTypes[2]="Mesh Phong Material";HexMapEditor.materialTypes[3]="Mesh Normal Material";HexMapEditor.materials=[];HexMapEditor.addMaterial("Grass",null,1,5956655,596740);HexMapEditor.addMaterial("Dirt",null,1,10640682,0);HexMapEditor.addMaterial("Water",null,1,4482815,0);HexMapEditor.addMaterial("Cement",null,
1,6710886,0)};HexMapEditor.start=function(){$("#menu").toggle();$("#tipDiv, #settingsToggleDiv").toggle();HexMapEditor.Map=new hexMap(HexMapEditor.scene,50,HexMapEditor.materials);HexMapEditor.Map.loadBlankMap();HexMapEditor.Map.showMap();HexMapEditor.moveCamera();HexMapEditor.animate()};
HexMapEditor.animate=function(){HexMapEditor.time=Date.now();HexMapEditor.timeDelta=HexMapEditor.lastTime-HexMapEditor.time;HexMapEditor.lastTime=HexMapEditor.time;HexMapEditor.Map.centerHexMarkerMesh.rotation.y+=HexMapEditor.timeDelta/2E3*Math.PI;HexMapEditor.Map.changeHeightHandleMesh.rotation.y-=HexMapEditor.timeDelta/2E3*Math.PI;if(HexMapEditor.isHeightDragging)0!=Math.round((HexMapEditor.heightChangeMultiplier+HexMapEditor.cameraDistance/5)*(HexMapEditor.mouse2D.y-HexMapEditor.dragStart.y))&&
(HexMapEditor.dontClickMe=!0,HexMapEditor.changeTileHeight(HexMapEditor.tileBeingEdited,(HexMapEditor.heightChangeMultiplier+HexMapEditor.cameraDistance/5)*(HexMapEditor.mouse2D.y-HexMapEditor.dragStart.y)),HexMapEditor.dragStart.y=HexMapEditor.mouse2D.y);else if(HexMapEditor.isCameraRotating){if(0!=Math.round(HexMapEditor.rotationMultiplier*(HexMapEditor.mouse2D.x-HexMapEditor.dragStart.x))||0!=Math.round(HexMapEditor.tiltMultiplier*(HexMapEditor.mouse2D.y-HexMapEditor.dragStart.y)))HexMapEditor.tilt-=
HexMapEditor.tiltMultiplier*(HexMapEditor.mouse2D.y-HexMapEditor.dragStart.y),HexMapEditor.theta+=HexMapEditor.rotationMultiplier*(HexMapEditor.mouse2D.x-HexMapEditor.dragStart.x),HexMapEditor.moveCamera(),HexMapEditor.dragStart.x=HexMapEditor.mouse2D.x,HexMapEditor.dragStart.y=HexMapEditor.mouse2D.y}else if(HexMapEditor.isCameraMoving){var a=HexMapEditor.cameraMovementMultiplier*HexMapEditor.cameraDistance*(HexMapEditor.mouse2D.x-HexMapEditor.dragStart.x),b=HexMapEditor.cameraMovementMultiplier*
HexMapEditor.cameraDistance*(HexMapEditor.mouse2D.y-HexMapEditor.dragStart.y);if(Math.abs(a)>HexMapEditor.dragDelay||Math.abs(b)>HexMapEditor.dragDelay||HexMapEditor.dontClickMe&&(0!=Math.round(a)||0!=Math.round(b))){HexMapEditor.dontClickMe=!0;var c=HexMapEditor.theta*Math.PI/180+Math.PI;HexMapEditor.cameraAimPoint.x+=a*Math.cos(c)-b*Math.sin(c);HexMapEditor.cameraAimPoint.y+=a*Math.sin(c)+b*Math.cos(c);HexMapEditor.cameraAimPoint.x<HexMapEditor.Map.bounds.lower.x?HexMapEditor.cameraAimPoint.x=HexMapEditor.Map.bounds.lower.x:
HexMapEditor.cameraAimPoint.x>HexMapEditor.Map.bounds.upper.x&&(HexMapEditor.cameraAimPoint.x=HexMapEditor.Map.bounds.upper.x);HexMapEditor.cameraAimPoint.y<HexMapEditor.Map.bounds.lower.y?HexMapEditor.cameraAimPoint.y=HexMapEditor.Map.bounds.lower.y:HexMapEditor.cameraAimPoint.y>HexMapEditor.Map.bounds.upper.y&&(HexMapEditor.cameraAimPoint.y=HexMapEditor.Map.bounds.upper.y);HexMapEditor.moveCamera();HexMapEditor.dragStart.x=HexMapEditor.mouse2D.x;HexMapEditor.dragStart.y=HexMapEditor.mouse2D.y}}HexMapEditor.isAnaglyphToggled?
HexMapEditor.effect.render(HexMapEditor.scene,HexMapEditor.camera):HexMapEditor.renderer.render(HexMapEditor.scene,HexMapEditor.camera);HexMapEditor.stats.update();0<HexMapEditor.Map.objectsToLoad.length&&HexMapEditor.Map.continueLoading(100);window.requestAnimationFrame(HexMapEditor.animate)};HexMapEditor.showSettings=function(){$("#settingsToggleDiv").toggle();$("#settingsDiv").toggle()};HexMapEditor.hideSettings=function(a){HexMapEditor.showSettings(a)};
HexMapEditor.anaglyphToggle=function(a){HexMapEditor.isAnaglyphToggled?($("#"+a.target.id).empty().append("Anaglyph 3D: OFF"),HexMapEditor.isAnaglyphToggled=!1):($("#"+a.target.id).empty().append("Anaglyph 3D: ON"),HexMapEditor.isAnaglyphToggled=!0)};HexMapEditor.onMouseMove=function(a){a.preventDefault();HexMapEditor.mouse2D.x=2*(a.clientX/window.innerWidth)-1;HexMapEditor.mouse2D.y=2*-(a.clientY/window.innerHeight)+1};
HexMapEditor.getIntersects=function(){var a=new THREE.Vector3(HexMapEditor.mouse2D.x,HexMapEditor.mouse2D.y,0.5);HexMapEditor.projector.unprojectVector(a,HexMapEditor.camera);return(new THREE.Raycaster(HexMapEditor.camera.position,a.sub(HexMapEditor.camera.position).normalize())).intersectObjects(HexMapEditor.scene.children,!0)};
HexMapEditor.onMouseDoubleClick=function(){var a=HexMapEditor.getIntersects(),b;for(b in a)if(a[b].object===HexMapEditor.tileBeingEdited.mesh){HexMapEditor.Map.setCenterHex(HexMapEditor.tileBeingEdited);HexMapEditor.Map.showEditMarkup(HexMapEditor.tileBeingEdited);HexMapEditor.updateCamera();break}};
HexMapEditor.onMouseClick=function(){if(HexMapEditor.dontClickMe)HexMapEditor.dontClickMe=!1;else for(var a in HexMapEditor.clickIntersects){var b=hexTile.prototype.getTileByMesh(HexMapEditor.clickIntersects[a].object);if(null!=b){HexMapEditor.showEditTile(b);break}else if(b=$.inArray(HexMapEditor.clickIntersects[a].object.parent,HexMapEditor.Map.addTiles),0<=b){HexMapEditor.addTile(HexMapEditor.tileBeingEdited,b);break}}};
HexMapEditor.onMouseDown=function(a){if(1==a.which){a=HexMapEditor.getIntersects();for(var b in a)a[b].object===HexMapEditor.Map.changeHeightHandleMesh&&(HexMapEditor.isHeightDragging=!0);!1==HexMapEditor.isHeightDragging&&(HexMapEditor.clickIntersects=a,HexMapEditor.isCameraMoving=!0)}else 2==a.which&&(HexMapEditor.isCameraRotating=!0,HexMapEditor.dontClickMe=!0);HexMapEditor.dragStart.x=HexMapEditor.mouse2D.x;HexMapEditor.dragStart.y=HexMapEditor.mouse2D.y};
HexMapEditor.onMouseUp=function(a){a.preventDefault();HexMapEditor.isCameraMoving=!1;HexMapEditor.isCameraRotating=!1;HexMapEditor.isHeightDragging=!1};HexMapEditor.onMouseWheel=function(a){HexMapEditor.cameraDistance=Math.min(5E3,Math.max(50,HexMapEditor.cameraDistance+a.wheelDelta/10));HexMapEditor.updateCamera()};
HexMapEditor.moveCamera=function(){HexMapEditor.tilt=Math.min(75,Math.max(5,HexMapEditor.tilt));0>HexMapEditor.theta?HexMapEditor.theta+=360:360<HexMapEditor.theta&&(HexMapEditor.theta-=360);HexMapEditor.updateCamera()};
HexMapEditor.updateCamera=function(){var a=Math.PI/180,b=Math.cos(HexMapEditor.tilt*a)*HexMapEditor.cameraDistance,c=Math.sin(HexMapEditor.tilt*a)*HexMapEditor.cameraDistance,d=Math.sin(HexMapEditor.theta*a)*c,a=-1*Math.cos(HexMapEditor.theta*a)*c,d=d+HexMapEditor.cameraAimPoint.x,a=a+HexMapEditor.cameraAimPoint.y;HexMapEditor.camera.position.set(d,a,b);HexMapEditor.camera.lookAt(new THREE.Vector3(HexMapEditor.cameraAimPoint.x,HexMapEditor.cameraAimPoint.y,0))};
HexMapEditor.onKeyDown=function(a){switch(a.keyCode){case 16:HexMapEditor.isShiftDown=!0}};HexMapEditor.onKeyUp=function(a){switch(a.keyCode){case 16:HexMapEditor.isShiftDown=!1;break;case 68:null!=HexMapEditor.tileBeingEdited&&HexMapEditor.Map.removeTile(HexMapEditor.tileBeingEdited,!1,!1);break;case 67:null!=HexMapEditor.tileBeingCloned&&(null!=HexMapEditor.tileBeingEdited&&$("#cloneDiv").is(":visible"))&&HexMapEditor.cloneTile()}};
HexMapEditor.onWindowResize=function(){HexMapEditor.camera.aspect=window.innerWidth/window.innerHeight;HexMapEditor.camera.updateProjectionMatrix();HexMapEditor.renderer.setSize(window.innerWidth,window.innerHeight)};HexMapEditor.addNewMaterial=function(){HexMapEditor.addMaterial("New Material",null,1);HexMapEditor.showMaterialsList()};
HexMapEditor.changeMaterialType=function(a,b){switch(HexMapEditor.materials[a].type){case 0:HexMapEditor.addMaterial(HexMapEditor.materials[a].name,a,b,parseInt(HexMapEditor.materials[a].material.color.getHex()),null,HexMapEditor.materials[a].material.wireframe);break;case 1:HexMapEditor.addMaterial(HexMapEditor.materials[a].name,a,b,parseInt(HexMapEditor.materials[a].material.color.getHex()),parseInt(HexMapEditor.materials[a].material.emissive.getHex()),HexMapEditor.materials[a].material.wireframe);
break;case 2:HexMapEditor.addMaterial(HexMapEditor.materials[a].name,a,b,parseInt(HexMapEditor.materials[a].material.color.getHex()),parseInt(HexMapEditor.materials[a].material.emissive.getHex()),HexMapEditor.materials[a].material.wireframe);break;case 3:HexMapEditor.addMaterial(HexMapEditor.materials[a].name,a,b,null,null,HexMapEditor.materials[a].material.wireframe)}HexMapEditor.Map.hideMap();HexMapEditor.Map.showMap();HexMapEditor.showMaterialsList();null!=HexMapEditor.tileBeingEdited&&HexMapEditor.Map.updateEditMarkup(HexMapEditor.tileBeingEdited);
HexMapEditor.moveCamera()};
HexMapEditor.showMaterialsList=function(){var a="";$("#settingsDiv").toggle(!1);$("#materialsListDiv .contentDiv").empty();var a=a+"<h2>Materials</h2><table><tr><td>name</td><td>type</td><td>color</td><td>emis.</td><td>wire</td></tr>",b;for(b in HexMapEditor.materials)a+="<tr id='materialListSpan_"+b+"'>",a+="<td><input type='text' onChange='HexMapEditor.materials["+b+"].name = this.value;' value='"+HexMapEditor.materials[b].name+"'></td>",a+="<td><select onChange='HexMapEditor.changeMaterialType( "+b+
", parseInt(this.value));'>",a+=HexMapEditor.listMaterialTypeOptions(HexMapEditor.materials[b].type),a+="</select></td>",a="3"!=HexMapEditor.materials[b].type?a+("<td><input type='color' name='color' onChange='HexMapEditor.materials["+b+"].material.color.setHex(parseInt(this.value.substr(1), 16));' value='#"+HexMapEditor.materials[b].material.color.getHexString()+"'/></td>"):a+"<td></td>",a="1"==HexMapEditor.materials[b].type||"2"==HexMapEditor.materials[b].type?a+("<td><input type='color' name='emissive' onChange='HexMapEditor.materials["+
b+"].material.emissive.setHex(parseInt(this.value.substr(1), 16));' value='#"+HexMapEditor.materials[b].material.emissive.getHexString()+"'/></td>"):a+"<td></td>",a+="<td><input type='checkbox' onclick='HexMapEditor.materials["+b+"].material.wireframe = !(HexMapEditor.materials["+b+"].material.wireframe);' ",HexMapEditor.materials[b].material.wireframe&&(a+=" checked"),a+="></td>",a+="</tr>";a+="</table><br>";a+="<button id='addMaterialButton' class='button'>New Material</button>";a+="<button id='closeMaterialsListDivButton' class='button closeButton'>CLOSE</button>";
$("#materialsListDiv .contentDiv").append(a);$("#addMaterialButton").click(HexMapEditor.addNewMaterial);$("#closeMaterialsListDivButton").click(HexMapEditor.hideMaterialsList);$("#materialsListDiv").toggle(!0)};HexMapEditor.hideMaterialsList=function(){$("#materialsListDiv").toggle(!1);$("#settingsDiv").toggle(!0)};
HexMapEditor.listMaterialTypeOptions=function(a){var b="",c;for(c in HexMapEditor.materialTypes)b+="<option value='"+c+"'",c==a&&(b+=" selected"),b+=">"+HexMapEditor.materialTypes[c]+"</option>";return b};HexMapEditor.listMaterialOptions=function(a){var b="",c;for(c in HexMapEditor.materials)b+="<option value='"+c+"'",c==a&&(b+=" selected"),b+=">"+HexMapEditor.materials[c].name+"</option>";return b};HexMapEditor.showInstructions=function(){$("#instructionsDiv").toggle(!0);$("#settingsDiv").toggle(!1)};
HexMapEditor.listGameEntityOptions=function(a){for(var b="<option value=''>None</option>",c=0;100>c;c++)b+="<option value='"+c+"'",c==a&&(b+=" selected"),b+=">"+c+"</option>";return b};
HexMapEditor.initEditTileDiv=function(){var a;a="<div id='editTileDivHeading'/><select id='tileMaterialSelect' onChange='HexMapEditor.changeTileMaterial(this.value);'></select><br><select id='tileGameEntitySelect' onChange='HexMapEditor.changeTileGameEntity(this.value);'></select>";a+="<br><fieldset id='splitHexFieldset'><legend>Split terrain</legend>";a+="<button id='rotateSplitHexButton' class='button'>Rotate</button><br>";a+="<button id='changeSizeSplitHexButton' class='button'>Size</button><br>";
a+="<select id='splitHexMaterialSelect' onChange='HexMapEditor.changeSplitHexMaterial(this.value);'></select><br>";a+="<button id='removeSplitHexButton' class='button'>Remove</button>";a+="</fieldset>";a+="<button id='addSplitHexButton' class='button'>Split terrain</button>";a+="<br><fieldset id='wallFieldset'><legend>Wall</legend>";a+="<select id='wallMaterialSelect' onChange='HexMapEditor.changeWallMaterial(this.value);'></select><br>";a+="Height: <input type='text' id='wallHeight' size='2'><br>";
a+="<button id='wallRelativeHeightButton' class='button'></button><br>";a+="<button id='rotateWallButton' class='button'>Rotate wall</button><br>";a+="<button id='taperWallButton' class='button'></button><br>";a+="<button id='removeWallButton' class='button'>Remove wall</button>";a+="</fieldset>";a+="<button id='addWallButton' class='button'>Add wall</button>";a+="<br><fieldset id='pillarFieldset'><legend>Pillar</legend>";a+="<select id='pillarMaterialSelect' onChange='HexMapEditor.changePillarMaterial(this.value);'></select><br>";
a+="Height: <input type='text' id='pillarHeight' size='2'><br>";a+="<button id='pillarRelativeHeightButton' class='button'></button><br>";a+="<button id='rotatePillarButton' class='button'>Rotate pillar</button><br>";a+="<button id='taperPillarButton' class='button'></button><br>";a+="<button id='changeSizePillarButton' class='button'>Size</button><br>";a+="<button id='removePillarButton' class='button'>Remove pillar</button>";a+="</fieldset>";a+="<button id='addPillarButton' class='button'>Add pillar</button><br>";
a+="<button id='deleteTileButton' class='button' onClick='HexMapEditor.Map.removeTile(HexMapEditor.tileBeingEdited, false, false);'>[D]ELETE</button><BR>";a+="<button id='closeEditButton' class='button'>CLOSE</button>";$("#editTileDiv .contentDiv").empty().append(a);$("#addSplitHexButton, #removeSplitHexButton").click(HexMapEditor.toggleSplitHex);$("#rotateSplitHexButton").click(HexMapEditor.rotateSplitHex);$("#changeSizeSplitHexButton").click(HexMapEditor.changeSizeSplitHex);$("#addWallButton, #removeWallButton").click(HexMapEditor.toggleTileWall);
$("#rotateWallButton").click(HexMapEditor.rotateTileWall);$("#taperWallButton").click(HexMapEditor.taperTileWall);$("#wallRelativeHeightButton").click(HexMapEditor.toggleTileWallRelativeHeight);$("#wallHeight").change(HexMapEditor.setTileWallHeight);$("#addPillarButton, #removePillarButton").click(HexMapEditor.togglePillar);$("#rotatePillarButton").click(HexMapEditor.rotatePillar);$("#taperPillarButton").click(HexMapEditor.taperPillar);$("#changeSizePillarButton").click(HexMapEditor.changeSizePillar);
$("#pillarRelativeHeightButton").click(HexMapEditor.togglePillarRelativeHeight);$("#pillarHeight").change(HexMapEditor.setPillarHeight);$("#closeEditButton").click(HexMapEditor.hideEditTile)};
HexMapEditor.showEditTile=function(a){HexMapEditor.tileBeingEdited=a;HexMapEditor.updateEditTileDivHeading();a.wall?HexMapEditor.toggleTileWall(null,!0):HexMapEditor.toggleTileWall(null,!1);a.pillar?HexMapEditor.togglePillar(null,!0):HexMapEditor.togglePillar(null,!1);a.splitHex?HexMapEditor.toggleSplitHex(null,!0):HexMapEditor.toggleSplitHex(null,!1);$("#tileGameEntitySelect").empty().append(HexMapEditor.listGameEntityOptions(a.gameEntity));$("#tileMaterialSelect").empty().append(HexMapEditor.listMaterialOptions(a.materialIndex));
$("#splitHexMaterialSelect").empty().append(HexMapEditor.listMaterialOptions(a.splitHexMaterialIndex));$("#wallMaterialSelect").empty().append(HexMapEditor.listMaterialOptions(a.wallMaterialIndex));$("#pillarMaterialSelect").empty().append(HexMapEditor.listMaterialOptions(a.pillarMaterialIndex));$("#editTileDiv").toggle(!0);HexMapEditor.Map.showAddTiles(a);HexMapEditor.Map.showEditMarkup(a)};
HexMapEditor.updateEditTileDivHeading=function(){$("#editTileDivHeading").empty().append("<h2>Tile "+HexMapEditor.tileBeingEdited.id+"</h2>Height: "+Math.round(100*HexMapEditor.tileBeingEdited.height)/100)};HexMapEditor.hideEditTile=function(){HexMapEditor.Map.hideEditMarkup();HexMapEditor.Map.hideAddTiles();$("#editTileDiv").toggle(!1);HexMapEditor.tileBeingEdited=null};
HexMapEditor.changeTileGameEntity=function(a){HexMapEditor.tileBeingEdited.gameEntity=void 0===a||null==a||""==a?null:parseInt(a);HexMapEditor.scene.remove(HexMapEditor.tileBeingEdited.gameEntityMesh);HexMapEditor.tileBeingEdited.gameEntityMesh=null;HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};HexMapEditor.changeTileMaterial=function(a){HexMapEditor.tileBeingEdited.setMaterial(a);HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.changeWallMaterial=function(a){HexMapEditor.tileBeingEdited.setWallMaterial(a);HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.toggleTileWall=function(a,b){void 0===b&&(b=HexMapEditor.tileBeingEdited.toggleWall(),HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited));b?($("#addWallButton, #addPillarButton").toggle(!1),$("#wallFieldset").toggle(!0),$("#wallHeight").val(HexMapEditor.tileBeingEdited.wallHeight),HexMapEditor.setWallRelativeHeightButtonText(),HexMapEditor.setWallTaperButtonText()):($("#addWallButton, #addPillarButton").toggle(!0),$("#wallFieldset").toggle(!1))};
HexMapEditor.rotateTileWall=function(){HexMapEditor.tileBeingEdited.rotateWall();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};HexMapEditor.setWallRelativeHeightButtonText=function(){HexMapEditor.tileBeingEdited.wallRelativeHeight?$("#wallRelativeHeightButton").empty().append("Relative Height"):$("#wallRelativeHeightButton").empty().append("Absolute Height")};
HexMapEditor.setWallTaperButtonText=function(){$("#taperWallButton").empty().append("Taper: "+Math.round(100*HexMapEditor.tileBeingEdited.wallTaper)+"%")};HexMapEditor.taperTileWall=function(){HexMapEditor.tileBeingEdited.changeWallTaper();HexMapEditor.setWallTaperButtonText();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.toggleTileWallRelativeHeight=function(){HexMapEditor.tileBeingEdited.toggleWallRelativeHeight();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited);HexMapEditor.setWallRelativeHeightButtonText()};HexMapEditor.setTileWallHeight=function(){HexMapEditor.tileBeingEdited.setWallHeight(Number($("#wallHeight").val()));HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};HexMapEditor.changePillarMaterial=function(a){HexMapEditor.tileBeingEdited.setPillarMaterial(a);HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.togglePillar=function(a,b){void 0===b&&(b=HexMapEditor.tileBeingEdited.togglePillar(),HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited));b?($("#addPillarButton, #addWallButton").toggle(!1),$("#pillarFieldset").toggle(!0),$("#pillarHeight").val(HexMapEditor.tileBeingEdited.pillarHeight),HexMapEditor.setPillarRelativeHeightButtonText(),HexMapEditor.setPillarTaperButtonText()):($("#addPillarButton, #addWallButton").toggle(!0),$("#pillarFieldset").toggle(!1))};
HexMapEditor.rotatePillar=function(){HexMapEditor.tileBeingEdited.rotatePillar();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};HexMapEditor.setPillarRelativeHeightButtonText=function(){HexMapEditor.tileBeingEdited.pillarRelativeHeight?$("#pillarRelativeHeightButton").empty().append("Relative Height"):$("#pillarRelativeHeightButton").empty().append("Absolute Height")};
HexMapEditor.setPillarTaperButtonText=function(){$("#taperPillarButton").empty().append("Taper: "+Math.round(100*HexMapEditor.tileBeingEdited.pillarTaper)+"%")};HexMapEditor.taperPillar=function(){HexMapEditor.tileBeingEdited.changePillarTaper();HexMapEditor.setPillarTaperButtonText();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.togglePillarRelativeHeight=function(){HexMapEditor.tileBeingEdited.togglePillarRelativeHeight();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited);HexMapEditor.setPillarRelativeHeightButtonText()};HexMapEditor.setPillarHeight=function(){HexMapEditor.tileBeingEdited.setPillarHeight(Number($("#pillarHeight").val()));HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};HexMapEditor.changeSizePillar=function(){HexMapEditor.tileBeingEdited.changeSizePillar();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.toggleSplitHex=function(a,b){void 0===b&&(b=HexMapEditor.tileBeingEdited.toggleSplitHex(),HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited));b?($("#addSplitHexButton").toggle(!1),$("#splitHexFieldset").toggle(!0)):($("#addSplitHexButton").toggle(!0),$("#splitHexFieldset").toggle(!1))};HexMapEditor.rotateSplitHex=function(){HexMapEditor.tileBeingEdited.rotateSplitHex();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.changeSizeSplitHex=function(){HexMapEditor.tileBeingEdited.changeSizeSplitHex();HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};HexMapEditor.changeSplitHexMaterial=function(a){HexMapEditor.tileBeingEdited.setSplitHexMaterial(a);HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited)};
HexMapEditor.addTile=function(a,b){a.neighbors[b]=new hexTile(a.height,a.materialIndex,a,(b+3)%6);a.neighbors[b].calculateCornerHeights(1);var c=a.mesh.position.x+HexMapEditor.Map.tileOffset[b].x,d=a.mesh.position.y+HexMapEditor.Map.tileOffset[b].y,e=a.mesh.position.z;HexMapEditor.Map.hideTile(a.neighbors[b],!0,!1);HexMapEditor.Map.showTile(a.neighbors[b],c,d,e);$("#addTileButton"+b).remove();HexMapEditor.scene.remove(HexMapEditor.Map.addTiles[b]);HexMapEditor.showEditTile(a.neighbors[b])};
HexMapEditor.hideAndShowTile=function(a){var b=a.mesh.position.x,c=a.mesh.position.y,d=a.mesh.position.z;HexMapEditor.Map.hideTile(a,!0,!1);HexMapEditor.Map.showTile(a,b,c,d);a===HexMapEditor.tileBeingEdited&&HexMapEditor.Map.updateEditMarkup(a)};HexMapEditor.changeTileHeight=function(a,b){0!=Math.round(b)&&(a.height+=b,a.clearCornerHeights(1),a.calculateHeights(!1),HexMapEditor.hideAndShowTile(a),HexMapEditor.Map.updateEditMarkup(a),HexMapEditor.updateEditTileDivHeading())};
HexMapEditor.showImportExport=function(){$("#importExportDiv").toggle(!0);$("#settingsDiv").toggle(!1)};HexMapEditor.hideImportExport=function(){$("#importExportDiv").toggle(!1);$("#settingsDiv").toggle(!0)};HexMapEditor.importMap=function(a,b){$("#loadingDiv").toggle(!0);void 0!==b&&null!=HexMapEditor.mapSamples[b]?$.getJSON("sample_maps/"+HexMapEditor.mapSamples[b].filename,function(a){HexMapEditor.processImportedMapObject(a)}):HexMapEditor.processImportedMapObject(JSON.parse($("#importExportTextarea").val()))};
HexMapEditor.processImportedMapObject=function(a){if(void 0!==a.materials&&0<a.materials.length)for(var b in a.materials)HexMapEditor.addMaterial(a.materials[b].name,a.materials[b].index,a.materials[b].type,a.materials[b].color,a.materials[b].emissive,a.materials[b].wireframe);HexMapEditor.tileBeingCloned=null;HexMapEditor.hideEditTile();HexMapEditor.Map.importFromObject(a.tiles);$("#closeImportExportButton").click()};HexMapEditor.exportMap=function(){$("#importExportTextarea").val(HexMapEditor.Map.exportToJSON())};
HexMapEditor.showMapSamples=function(){var a="<h2>Sample Maps</h2>Loading a sample will<br>erase the current map.",b;for(b in HexMapEditor.mapSamples)a+="<br><button class='button' onClick='HexMapEditor.importMap(null, "+b+"); HexMapEditor.hideMapSamples();'>Load: "+HexMapEditor.mapSamples[b].name+"</button>";$("#mapSamplesDiv .contentDiv").empty().append(a+"<br><button class='button' onClick='HexMapEditor.hideMapSamples();'>CLOSE</button>");$("#mapSamplesDiv").toggle(!0);$("#settingsDiv").toggle(!1)};
HexMapEditor.hideMapSamples=function(){$("#mapSamplesDiv").toggle(!1);$("#settingsDiv").toggle(!0)};
HexMapEditor.initClone=function(){var a;a="<h2>Clone tool</h2><span id='cloneHeading'></span><br><div style='padding-left: 15px; text-align: left;'>";a+="<input type='checkbox' id='cloneHeight'>Height<br>";a+="<input type='checkbox' id='cloneMaterial'>Material<br>";a+="<input type='checkbox' id='cloneGameEntity'>Game Entity<br>";a+="<input type='checkbox' id='cloneSplitHex'>Split terrain<br>";a+="<input type='checkbox' id='cloneWall'>Wall<br>";a+="<input type='checkbox' id='clonePillar'>Pillar<br>";
a+="</div>";a+="<button class='button' onclick='HexMapEditor.cloneTile();'>[C]lone values</button><br>";a+="<button class='button' onclick='HexMapEditor.hideClone();'>CLOSE</button>";$("#cloneDiv .contentDiv").empty().append(a)};
HexMapEditor.cloneTile=function(){null==HexMapEditor.tileBeingEdited||(null==HexMapEditor.tileBeingCloned||HexMapEditor.tileBeingEdited===HexMapEditor.tileBeingCloned)||($("#cloneHeight").is(":checked")&&(HexMapEditor.changeTileHeight(HexMapEditor.tileBeingEdited,HexMapEditor.tileBeingCloned.height-HexMapEditor.tileBeingEdited.height),HexMapEditor.tileBeingEdited.height=HexMapEditor.tileBeingCloned.height,HexMapEditor.tileBeingEdited.clearCornerHeights(1),HexMapEditor.tileBeingEdited.calculateCornerHeights(1)),
$("#cloneMaterial").is(":checked")&&(HexMapEditor.tileBeingEdited.materialIndex=HexMapEditor.tileBeingCloned.materialIndex),$("#cloneGameEntity").is(":checked")&&(HexMapEditor.scene.remove(HexMapEditor.tileBeingEdited.gameEntityMesh),HexMapEditor.tileBeingEdited.gameEntity=HexMapEditor.tileBeingCloned.gameEntity),$("#cloneSplitHex").is(":checked")&&(HexMapEditor.tileBeingEdited.splitHex=HexMapEditor.tileBeingCloned.splitHex,HexMapEditor.tileBeingEdited.splitHexMaterialIndex=HexMapEditor.tileBeingCloned.splitHexMaterialIndex,
HexMapEditor.tileBeingEdited.splitHexSide=HexMapEditor.tileBeingCloned.splitHexSide,HexMapEditor.tileBeingEdited.splitHexSize=HexMapEditor.tileBeingCloned.splitHexSize),$("#cloneWall").is(":checked")&&(HexMapEditor.tileBeingEdited.wall=HexMapEditor.tileBeingCloned.wall,HexMapEditor.tileBeingEdited.wallMaterialIndex=HexMapEditor.tileBeingCloned.wallMaterialIndex,HexMapEditor.tileBeingEdited.wallSide=HexMapEditor.tileBeingCloned.wallSide,HexMapEditor.tileBeingEdited.wallHeight=HexMapEditor.tileBeingCloned.wallHeight,
HexMapEditor.tileBeingEdited.wallRelativeHeight=HexMapEditor.tileBeingCloned.wallRelativeHeight,HexMapEditor.tileBeingEdited.wallTaper=HexMapEditor.tileBeingCloned.wallTaper),$("#clonePillar").is(":checked")&&(HexMapEditor.tileBeingEdited.pillar=HexMapEditor.tileBeingCloned.pillar,HexMapEditor.tileBeingEdited.pillarMaterialIndex=HexMapEditor.tileBeingCloned.pillarMaterialIndex,HexMapEditor.tileBeingEdited.pillarSide=HexMapEditor.tileBeingCloned.pillarSide,HexMapEditor.tileBeingEdited.pillarHeight=
HexMapEditor.tileBeingCloned.pillarHeight,HexMapEditor.tileBeingEdited.pillarRelativeHeight=HexMapEditor.tileBeingCloned.pillarRelativeHeight,HexMapEditor.tileBeingEdited.pillarSize=HexMapEditor.tileBeingCloned.pillarSize,HexMapEditor.tileBeingEdited.pillarTaper=HexMapEditor.tileBeingCloned.pillarTaper),HexMapEditor.hideAndShowTile(HexMapEditor.tileBeingEdited),HexMapEditor.showEditTile(HexMapEditor.tileBeingEdited))};
HexMapEditor.setCloneHeading=function(){var a="",a=null==HexMapEditor.tileBeingCloned?a+"No cloned tile.<br>":a+"<button class='button' onclick='HexMapEditor.showEditTile(HexMapEditor.tileBeingCloned);'>Select cloned tile</button><br>";$("#cloneHeading").empty().append(a+"<button class='button' onclick='HexMapEditor.tileBeingCloned = HexMapEditor.tileBeingEdited; HexMapEditor.setCloneHeading();'>Clone selected tile</button>")};
HexMapEditor.showClone=function(){HexMapEditor.setCloneHeading();$("#cloneDiv").toggle(!0);$("#settingsDiv").toggle(!1)};HexMapEditor.hideClone=function(){$("#cloneDiv").toggle(!1);$("#settingsDiv").toggle(!0)};function hexMap(a,b,c){this.centerHex={};this.centerHexMarkerMesh=null;this.bounds={lower:{x:0,y:0},upper:{x:0,y:0}};this.materials=c;this.defaultMaterialIndex=0;this.tileRadius=b;this.halfTileRadius=this.tileRadius/2;this.toSide=this.tileRadius*hexTile.prototype.toSide;this.scene=a;this.addTiles=[];this.editMarkupMesh=null;this.editMarkupLineMaterial=new THREE.LineBasicMaterial({color:2105376,linewidth:5});this.changeHeightHandleMesh=null;this.changeHeightHandleMesh=this.getChangeHeightHandleMesh();
this.tileOffset=[{},{},{},{},{},{}];this.objectsToLoad=[];this.loadedObjects=[];for(a=0;6>a;a++)this.tileOffset[a].x=this.tileRadius*hexTile.prototype.neighborOffset[a].x,this.tileOffset[a].y=this.tileRadius*hexTile.prototype.neighborOffset[a].y}
hexMap.prototype.getChangeHeightHandleMesh=function(){if(null!=this.changeHeightHandleMesh)return this.changeHeightHandleMesh;var a=new THREE.CylinderGeometry(0,this.tileRadius/4,this.tileRadius/4,6,1,!1),b=new THREE.Mesh(a);b.position.y+=this.tileRadius/4;a=new THREE.CylinderGeometry(this.tileRadius/10,this.tileRadius/10,this.tileRadius/4,6,1,!0);THREE.GeometryUtils.merge(a,b);b=new THREE.Mesh(a);b.position.y+=this.tileRadius/4;a=new THREE.CylinderGeometry(this.tileRadius/4,0,this.tileRadius/4,6,
1,!1);THREE.GeometryUtils.merge(a,b);b=new THREE.Mesh(a,new THREE.MeshNormalMaterial);b.rotation.x=Math.PI/2;return b};hexMap.prototype.loadBlankMap=function(){this.centerHex=new hexTile(0,this.defaultMaterialIndex);this.centerHex.calculateHeights(!0)};
hexMap.prototype.getCenterHexMarkerMesh=function(){if(null==this.centerHexMarkerMesh){var a=new THREE.CylinderGeometry(this.tileRadius/6,0,this.tileRadius,6,1,!1);a.computeCentroids();a.computeFaceNormals();this.centerHexMarkerMesh=new THREE.Mesh(a,new THREE.MeshLambertMaterial({color:16711680,emissive:8912896,opacity:0.6,transparent:!0}));this.centerHexMarkerMesh.rotation.x=Math.PI/2}return this.centerHexMarkerMesh};
hexMap.prototype.showEditMarkup=function(a){this.updateEditMarkup(a);this.scene.add(this.changeHeightHandleMesh);a===this.centerHex?(this.centerHexMarkerMesh.scale.y=0.2,this.centerHexMarkerMesh.position.z=a.minMarkupHeight+this.tileRadius/5):(this.centerHexMarkerMesh.scale.y=1,this.centerHexMarkerMesh.position.z=this.centerHex.minMarkupHeight+this.tileRadius/2)};
hexMap.prototype.updateEditMarkup=function(a){this.changeHeightHandleMesh.position.x=a.mesh.position.x;this.changeHeightHandleMesh.position.y=a.mesh.position.y;this.changeHeightHandleMesh.position.z=a.minMarkupHeight+25;a===this.centerHex&&(this.getCenterHexMarkerMesh().position.z=a.minMarkupHeight+this.tileRadius/5);for(var b=0;6>b;b++)this.addTiles[b].position.z=a.mesh.position.z-3;b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(this.halfTileRadius,this.toSide,a.cornerHeight[0]-a.height));
b.vertices.push(new THREE.Vector3(this.tileRadius,0,a.cornerHeight[1]-a.height));b.vertices.push(new THREE.Vector3(this.halfTileRadius,-1*this.toSide,a.cornerHeight[2]-a.height));b.vertices.push(new THREE.Vector3(-1*this.halfTileRadius,-1*this.toSide,a.cornerHeight[3]-a.height));b.vertices.push(new THREE.Vector3(-1*this.tileRadius,0,a.cornerHeight[4]-a.height));b.vertices.push(new THREE.Vector3(-1*this.halfTileRadius,this.toSide,a.cornerHeight[5]-a.height));b.vertices.push(new THREE.Vector3(this.halfTileRadius,
this.toSide,a.cornerHeight[0]-a.height));this.scene.remove(this.editMarkupMesh);this.editMarkupMesh=new THREE.Line(b,this.editMarkupLineMaterial);this.editMarkupMesh.position=a.mesh.position.clone();this.editMarkupMesh.position.z+=5;this.scene.add(this.editMarkupMesh)};
hexMap.prototype.hideEditMarkup=function(){this.scene.remove(this.changeHeightHandleMesh);this.scene.remove(this.editMarkupMesh);this.centerHexMarkerMesh.scale.z=1;this.centerHexMarkerMesh.position.z=this.centerHex.mesh.position.z+this.tileRadius/2};
hexMap.prototype.showAddTiles=function(a){for(var b=null,c=null,d=null,e=new THREE.CylinderGeometry(this.tileRadius-3,this.tileRadius,10,6,1,!1),f=new THREE.TextGeometry("NEW",{size:this.tileRadius/2-2,height:4,curveSegments:6,font:"helvetiker",weight:"normal",style:"normal"}),g=new THREE.MeshLambertMaterial({color:16777215}),h=new THREE.MeshLambertMaterial({color:13382451}),l=0;6>l;l++)null==this.addTiles[l]&&(c=new THREE.Mesh(e,g),c.rotation.x=Math.PI/2,c.rotation.y=Math.PI/6,d=new THREE.Mesh(f,
h),d.position.x-=2*this.tileRadius/3,d.position.y-=this.tileRadius/4,d.position.z+=6,b=new THREE.Object3D,b.add(c),b.add(d),b.rotation.z=-l*Math.PI/3,this.addTiles[l]=b),this.scene.remove(this.addTiles[l]),null==a.neighbors[l]&&(this.addTiles[l].position.x=a.mesh.position.x+this.tileOffset[l].x,this.addTiles[l].position.y=a.mesh.position.y+this.tileOffset[l].y,this.addTiles[l].position.z=a.mesh.position.z-3,this.scene.add(this.addTiles[l]))};
hexMap.prototype.hideAddTiles=function(){for(var a=0;6>a;a++)this.scene.remove(this.addTiles[a])};hexMap.prototype.showMap=function(){this.showTile(this.centerHex,0,0,0);this.setCenterHex(this.centerHex)};
hexMap.prototype.showTile=function(a,b,c,d){var e=0,f=0,e=0,f=!1,g=new THREE.Geometry;g.vertices.push(new THREE.Vector3(0,0,0));g.vertices.push(new THREE.Vector3(this.halfTileRadius,this.toSide,a.cornerHeight[0]-a.height));g.vertices.push(new THREE.Vector3(this.tileRadius,0,a.cornerHeight[1]-a.height));g.vertices.push(new THREE.Vector3(this.halfTileRadius,-1*this.toSide,a.cornerHeight[2]-a.height));g.vertices.push(new THREE.Vector3(-1*this.halfTileRadius,-1*this.toSide,a.cornerHeight[3]-a.height));
g.vertices.push(new THREE.Vector3(-1*this.tileRadius,0,a.cornerHeight[4]-a.height));g.vertices.push(new THREE.Vector3(-1*this.halfTileRadius,this.toSide,a.cornerHeight[5]-a.height));if(a.pillar)switch(e=a.pillarRelativeHeight?a.pillarHeight:a.pillarHeight-a.height,a.minMarkupHeight=a.height+e,g.vertices.push(new THREE.Vector3(0,0,e)),g.vertices.push(new THREE.Vector3((1-a.pillarTaper)*g.vertices[(a.pillarSide+2)%6+1].x,(1-a.pillarTaper)*g.vertices[(a.pillarSide+2)%6+1].y,e)),g.vertices.push(new THREE.Vector3((1-
a.pillarTaper)*g.vertices[(a.pillarSide+3)%6+1].x,(1-a.pillarTaper)*g.vertices[(a.pillarSide+3)%6+1].y,e)),g.vertices.push(new THREE.Vector3((1-a.pillarTaper)*g.vertices[(a.pillarSide+1)%6+1].x,(1-a.pillarTaper)*g.vertices[(a.pillarSide+1)%6+1].y,e)),g.vertices.push(new THREE.Vector3((1-a.pillarTaper)*g.vertices[(a.pillarSide+4)%6+1].x,(1-a.pillarTaper)*g.vertices[(a.pillarSide+4)%6+1].y,e)),g.vertices.push(new THREE.Vector3((1-a.pillarTaper)*g.vertices[a.pillarSide+1].x,(1-a.pillarTaper)*g.vertices[a.pillarSide+
1].y,e)),g.vertices.push(new THREE.Vector3((1-a.pillarTaper)*g.vertices[(a.pillarSide+5)%6+1].x,(1-a.pillarTaper)*g.vertices[(a.pillarSide+5)%6+1].y,e)),g.faces.push(new THREE.Face3(0,1,6)),g.faces.push(new THREE.Face3(0,2,1)),g.faces.push(new THREE.Face3(0,3,2)),g.faces.push(new THREE.Face3(0,4,3)),g.faces.push(new THREE.Face3(0,5,4)),g.faces.push(new THREE.Face3(0,6,5)),a.pillarSize){case 3:g.faces.push(new THREE.Face3(7,9,8)),g.faces.push(new THREE.Face4(8,9,(a.pillarSide+3)%6+1,(a.pillarSide+
2)%6+1)),f=!0;case 2:g.faces.push(new THREE.Face3(7,8,10)),g.faces.push(new THREE.Face4(10,8,(a.pillarSide+2)%6+1,(a.pillarSide+1)%6+1)),g.faces.push(new THREE.Face3(7,11,9)),g.faces.push(new THREE.Face4(9,11,(a.pillarSide+4)%6+1,(a.pillarSide+3)%6+1)),f||(g.faces.push(new THREE.Face4(7,0,(a.pillarSide+2)%6+1,8)),g.faces.push(new THREE.Face4(0,7,9,(a.pillarSide+3)%6+1)),f=!0);case 1:g.faces.push(new THREE.Face3(7,10,12)),g.faces.push(new THREE.Face4(12,10,(a.pillarSide+1)%6+1,a.pillarSide+1)),g.faces.push(new THREE.Face3(7,
13,11)),g.faces.push(new THREE.Face4(11,13,(a.pillarSide+5)%6+1,(a.pillarSide+4)%6+1)),f||(g.faces.push(new THREE.Face4(7,0,(a.pillarSide+1)%6+1,10)),g.faces.push(new THREE.Face4(0,7,11,(a.pillarSide+4)%6+1)),f=!0);case 0:g.faces.push(new THREE.Face3(7,12,13)),g.faces.push(new THREE.Face4(13,12,a.pillarSide+1,(a.pillarSide+5)%6+1)),f||(g.faces.push(new THREE.Face4(7,0,a.pillarSide+1,12)),g.faces.push(new THREE.Face4(0,7,13,(a.pillarSide+5)%6+1)))}else a.wall?(a.wallRelativeHeight?(e=Math.max(a.cornerHeight[(a.wallSide+
5)%6],a.cornerHeight[a.wallSide])+a.wallHeight-a.height,f=Math.max(a.cornerHeight[(a.wallSide+2)%6],a.cornerHeight[(a.wallSide+3)%6])+a.wallHeight-a.height):(e=Math.max(a.wallHeight,Math.max(a.cornerHeight[(a.wallSide+5)%6],a.cornerHeight[a.wallSide]))-a.height,f=Math.max(a.wallHeight,Math.max(a.cornerHeight[(a.wallSide+2)%6],a.cornerHeight[(a.wallSide+3)%6]))-a.height),a.minMarkupHeight=a.height+(e+f)/2,g.vertices.push(new THREE.Vector3(0.625*g.vertices[a.wallSide+2].x,0.625*g.vertices[a.wallSide+
2].y,(a.cornerHeight[a.wallSide+1]-a.height)/2)),g.vertices.push(new THREE.Vector3(0.625*g.vertices[(a.wallSide+4)%6+1].x,0.625*g.vertices[(a.wallSide+4)%6+1].y,(a.cornerHeight[(a.wallSide+4)%6]-a.height)/2)),g.vertices.push(new THREE.Vector3(0.5*g.vertices[a.wallSide+2].x,0.5*g.vertices[a.wallSide+2].y,Math.min((e+f)/2-5,g.vertices[7].z+5))),g.vertices.push(new THREE.Vector3(0.5*g.vertices[(a.wallSide+4)%6+1].x,0.5*g.vertices[(a.wallSide+4)%6+1].y,Math.min((e+f)/2-5,g.vertices[8].z+5))),g.vertices.push(new THREE.Vector3((1-
a.wallTaper)*g.vertices[a.wallSide+1].x,(1-a.wallTaper)*g.vertices[a.wallSide+1].y,e)),g.vertices.push(new THREE.Vector3((1-a.wallTaper)*g.vertices[a.wallSide+3].x,(1-a.wallTaper)*g.vertices[a.wallSide+3].y,f)),g.vertices.push(new THREE.Vector3((1-a.wallTaper)*g.vertices[a.wallSide+4].x,(1-a.wallTaper)*g.vertices[a.wallSide+4].y,f)),g.vertices.push(new THREE.Vector3((1-a.wallTaper)*g.vertices[(a.wallSide+5)%6+1].x,(1-a.wallTaper)*g.vertices[(a.wallSide+5)%6+1].y,e)),g.faces.push(new THREE.Face3(7,
a.wallSide+2,a.wallSide+1)),g.faces.push(new THREE.Face3(7,a.wallSide+2,a.wallSide+1)),g.faces.push(new THREE.Face3(7,a.wallSide+3,a.wallSide+2)),g.faces.push(new THREE.Face3(8,(a.wallSide+4)%6+1,(a.wallSide+3)%6+1)),g.faces.push(new THREE.Face3(8,(a.wallSide+4)%6+1,(a.wallSide+3)%6+1)),g.faces.push(new THREE.Face3(8,(a.wallSide+5)%6+1,(a.wallSide+4)%6+1)),g.faces.push(new THREE.Face3(9,7,a.wallSide+1)),g.faces.push(new THREE.Face3(7,9,a.wallSide+3)),g.faces.push(new THREE.Face3(10,8,(a.wallSide+
3)%6+1)),g.faces.push(new THREE.Face3(8,10,(a.wallSide+5)%6+1)),g.faces.push(new THREE.Face3(9,a.wallSide+1,11)),g.faces.push(new THREE.Face3(9,11,12)),g.faces.push(new THREE.Face3(9,12,a.wallSide+3)),g.faces.push(new THREE.Face3(10,(a.wallSide+3)%6+1,13)),g.faces.push(new THREE.Face3(10,13,14)),g.faces.push(new THREE.Face3(10,14,(a.wallSide+5)%6+1)),g.faces.push(new THREE.Face4(14,13,12,11)),(0<a.wallTaper||null==a.neighbors[a.wallSide]||null!=a.neighbors[a.wallSide]&&(!a.neighbors[a.wallSide].wall||
!(0==a.neighbors[a.wallSide].wallTaper&&a.wallSide==a.neighbors[a.wallSide].wallSide&&a.wallRelativeHeight==a.neighbors[a.wallSide].wallRelativeHeight&&a.wallHeight==a.neighbors[a.wallSide].wallHeight)))&&g.faces.push(new THREE.Face4(a.wallSide+1,(a.wallSide+5)%6+1,14,11)),(0<a.wallTaper||null==a.neighbors[a.wallSide+3]||null!=a.neighbors[a.wallSide+3]&&(!a.neighbors[a.wallSide+3].wall||!(0==a.neighbors[a.wallSide+3].wallTaper&&a.wallSide==a.neighbors[a.wallSide+3].wallSide&&a.wallRelativeHeight==
a.neighbors[a.wallSide+3].wallRelativeHeight&&a.wallHeight==a.neighbors[a.wallSide+3].wallHeight)))&&g.faces.push(new THREE.Face4(a.wallSide+3,12,13,(a.wallSide+3)%6+1))):(g.faces.push(new THREE.Face3(0,1,6)),g.faces.push(new THREE.Face3(0,2,1)),g.faces.push(new THREE.Face3(0,3,2)),g.faces.push(new THREE.Face3(0,4,3)),g.faces.push(new THREE.Face3(0,5,4)),g.faces.push(new THREE.Face3(0,6,5)),a.minMarkupHeight=a.height);g.materials=[this.materials[a.materialIndex].material,this.materials[a.splitHexMaterialIndex].material];
a.wall&&g.materials.push(this.materials[a.wallMaterialIndex].material);a.pillar&&g.materials.push(this.materials[a.pillarMaterialIndex].material);for(var h in g.faces)if(6>h)g.faces[h].materialIndex=0;else if(a.wall||a.pillar)g.faces[h].materialIndex=2;if(a.splitHex)switch(a.splitHexSize){case 2:g.faces[(a.splitHexSide+4)%6].materialIndex=1,g.faces[(a.splitHexSide+2)%6].materialIndex=1;case 1:g.faces[(a.splitHexSide+5)%6].materialIndex=1,g.faces[(a.splitHexSide+1)%6].materialIndex=1;case 0:g.faces[a.splitHexSide].materialIndex=
1}if(a.wall)g.faces.splice(3,1),g.faces.splice(0,1),g.faces[4].materialIndex=g.faces[0].materialIndex,g.faces[5].materialIndex=g.faces[1].materialIndex,g.faces[6].materialIndex=g.faces[2].materialIndex,g.faces[7].materialIndex=g.faces[3].materialIndex;else if(a.pillar)for(h=5;0<=h;h--)(a.pillarSide==h||1<=a.pillarSize&&((a.pillarSide+1)%6==h||(a.pillarSide+5)%6==h)||2<=a.pillarSize&&((a.pillarSide+2)%6==h||(a.pillarSide+4)%6==h)||3==a.pillarSize)&&g.faces.splice(h,1);g.computeFaceNormals();g.mergeVertices();
g=new THREE.Mesh(g,new THREE.MeshFaceMaterial(g.materials));g.position.set(b,c,a.height);this.scene.add(g);a.mesh=g;b<this.bounds.lower.x?this.bounds.lower.x=b:b>this.bounds.upper.x&&(this.bounds.upper.x=b);c<this.bounds.lower.y?this.bounds.lower.y=c:c>this.bounds.upper.y&&(this.bounds.upper.y=c);null!=a.gameEntity&&(null==a.gameEntityMesh&&(g=new THREE.TextGeometry(a.gameEntity,{size:this.tileRadius,height:3,curveSegments:6,font:"helvetiker",weight:"normal",style:"normal"}),a.gameEntityMesh=new THREE.Mesh(g,
new THREE.MeshBasicMaterial({color:16777215,opacity:0.6,transparent:!0}))),a.gameEntityMesh.position.x=10>a.gameEntity?b-this.tileRadius/2+5:b-this.tileRadius+5,a.gameEntityMesh.position.y=c-this.tileRadius/2,a.gameEntityMesh.position.z=a.minMarkupHeight+5,this.scene.add(a.gameEntityMesh));for(h=0;6>h;h++)null!=a.neighbors[h]&&null==a.neighbors[h].mesh&&this.showTile(a.neighbors[h],b+this.tileOffset[h].x,c+this.tileOffset[h].y,d)};
hexMap.prototype.hideMap=function(){this.hideTile(this.centerHex,!1,!0)};hexMap.prototype.hideTile=function(a,b,c){null!=a.mesh&&(this.scene.remove(a.mesh),this.scene.remove(a.gameEntityMesh),a.mesh=null);if(b||c)for(b=0;6>b;b++)null!=a.neighbors[b]&&null!=a.neighbors[b].mesh&&(c?this.hideTile(a.neighbors[b],!1,!0):this.hideTile(a.neighbors[b]))};
hexMap.prototype.removeTile=function(a){if(a===this.centerHex)for(var b=0;6>b;b++)if(null!=a.neighbors[b]){this.setCenterHex(a.neighbors[b]);break}if(a===this.centerHex)alert("Can't delete last tile.");else{for(var c=!0,b=0;6>b;b++)if(null!=a.neighbors[b]&&(0==b||null==a.neighbors[b-1])&&!(5==b&&null!=a.neighbors[0])){var d=[];d[a.id]=1;null!=a.neighbors[b]&&null==a.neighbors[b].anyPathToTile(this.centerHex,d,1E3)&&(c=!1)}c?(this.hideTile(a,!1,!1),a.destroy(),$("#closeEditButton").click()):alert("Can't leave part of the map unconnected. Move centerhex closer if it is connected.")}};
hexMap.prototype.setCenterHex=function(a){if(a.__proto__===this.centerHex.__proto__){this.centerHex=a;var b=this.getCenterHexMarkerMesh();this.scene.remove(b);this.scene.add(b);b.position=a.mesh.position.clone();b.position.z=a.minMarkupHeight+this.tileRadius/2;this.scene.__lights[0].position.x=b.position.x;this.scene.__lights[0].position.y=b.position.y;this.scene.__lights[0].position.z=b.position.z}};
hexMap.prototype.exportToJSON=function(){var a=[],b=[],c=this.centerHex.getExportTileMin();a.push(c);for(b.push(this.centerHex);a.length<hexTile.prototype.tiles.length;){var d;a:for(d in hexTile.prototype.tiles)if(!(0<=$.inArray(hexTile.prototype.tiles[d],b)))for(var e in hexTile.prototype.tiles[d].neighbors)if(null!=hexTile.prototype.tiles[d].neighbors[e])for(var f in a)if(a[f][0]==hexTile.prototype.tiles[d].neighbors[e].id){c=hexTile.prototype.tiles[d].getExportTileMin();c[1]=a[f][0];c[2]=parseInt(e);
a.push(c);b.push(hexTile.prototype.tiles[d]);continue a}}var b=[],g;for(g in this.materials)c={},c.index=g,c.type=this.materials[g].type,c.name=this.materials[g].name,0<=$.inArray(c.type,[0,1,2])&&(c.color=this.materials[g].material.color.getHex()),0<=$.inArray(c.type,[1,2])&&(c.emissive=this.materials[g].material.emissive.getHex()),c.wireframe=this.materials[g].material.wireframe,b.push(c);return JSON.stringify({materials:b,tiles:a})};
hexMap.prototype.importFromObject=function(a){this.hideMap();for(this.centerHex=null;0<hexTile.prototype.tiles.length;)hexTile.prototype.tiles[0].destroy();this.objectsToLoad.length=0;this.loadedObjects.length=0;this.objectsToLoad=a;this.continueLoading(1)};
hexMap.prototype.continueLoading=function(a){if(0==this.objectsToLoad.length)this.centerHex.calculateHeights(!0),this.showMap(),$("#loadingDiv").toggle(!1);else if(0==a)$("#loadcount").empty().append(hexTile.prototype.tiles.length);else for(var b in this.objectsToLoad){b=parseInt(b);if(null==this.centerHex&&null==this.objectsToLoad[b][1])var c=this.centerHex=new hexTile(this.objectsToLoad[b][3],0);else{if(void 0===this.loadedObjects[this.objectsToLoad[b][1]])continue;c=this.loadedObjects[this.objectsToLoad[b][1]];
c.neighbors[(this.objectsToLoad[b][2]+3)%6]=new hexTile(this.objectsToLoad[b][3],0,c,this.objectsToLoad[b][2]);c=c.neighbors[(this.objectsToLoad[b][2]+3)%6]}c.setFromImport(this.objectsToLoad[b]);this.loadedObjects[this.objectsToLoad[b][0]]=c;this.objectsToLoad.splice(b,1);this.continueLoading(a-1);break}};function hexTile(a,b,c,d){this.id=hexTile.prototype.idCounter++;this.neighbors=[];this.materialIndex=b;this.height=a;this.sideHeight=[a,a,a,a,a,a];this.cornerHeight=[null,null,null,null,null,null];this.position=new THREE.Vector3(0,0,0);this.cornerPoints=[];this.sidePoints=[];for(var e=0;6>e;e++)this.cornerPoints.push(new THREE.Vector3),this.sidePoints.push(new THREE.Vector3);this.minMarkupHeight=a;this.cornersCalculated=!1;this.gameEntityMesh=this.gameEntity=this.mesh=null;this.splitHex=!1;this.splitHexMaterialIndex=
b;this.splitHexSide=0;this.splitHexSize=1;this.wall=!1;this.wallMaterialIndex=b;this.wallSide=0;this.wallHeight=10;this.wallRelativeHeight=!0;this.wallTaper=0;this.pillar=!1;this.pillarMaterialIndex=b;this.pillarSide=0;this.pillarHeight=10;this.pillarRelativeHeight=!0;this.pillarSize=3;this.pillarTaper=0;void 0!==c&&(this.addNeighbor(c,d),this.findNeighbors(this,[],0,0));hexTile.prototype.tiles.push(this)}hexTile.prototype.idCounter=0;hexTile.prototype.tiles=[];
hexTile.prototype.toSide=Math.round(1E6*Math.cos(Math.PI/6))/1E6;hexTile.prototype.neighborOffset=[{},{},{},{},{},{}];hexTile.prototype.neighborOffset[0].x=0;hexTile.prototype.neighborOffset[1].x=1.5;hexTile.prototype.neighborOffset[2].x=1.5;hexTile.prototype.neighborOffset[3].x=-1*hexTile.prototype.neighborOffset[0].x;hexTile.prototype.neighborOffset[4].x=-1*hexTile.prototype.neighborOffset[1].x;hexTile.prototype.neighborOffset[5].x=-1*hexTile.prototype.neighborOffset[2].x;
hexTile.prototype.neighborOffset[0].y=2*hexTile.prototype.toSide;hexTile.prototype.neighborOffset[1].y=hexTile.prototype.toSide;hexTile.prototype.neighborOffset[2].y=-1*hexTile.prototype.toSide;hexTile.prototype.neighborOffset[3].y=-1*hexTile.prototype.neighborOffset[0].y;hexTile.prototype.neighborOffset[4].y=-1*hexTile.prototype.neighborOffset[1].y;hexTile.prototype.neighborOffset[5].y=-1*hexTile.prototype.neighborOffset[2].y;
hexTile.prototype.getTileById=function(a){for(var b in hexTile.prototype.tiles)if(hexTile.prototype.tiles[b].id==a)return hexTile.prototype.tiles[b];return null};hexTile.prototype.getTileByMesh=function(a){for(var b in hexTile.prototype.tiles)if(hexTile.prototype.tiles[b].mesh===a)return hexTile.prototype.tiles[b];return null};
hexTile.prototype.getTileByPosition=function(a,b){var c=0,d=999999999,e=null,f;for(f in hexTile.prototype.tiles)Math.abs(hexTile.prototype.tiles[f].position.x-a.x)<b&&Math.abs(hexTile.prototype.tiles[f].position.y-a.y)<b&&(c=Math.sqrt(Math.abs(hexTile.prototype.tiles[f].position.x-a.x)^2+Math.abs(hexTile.prototype.tiles[f].position.y-a.y)^2),c<d&&(d=c,e=hexTile.prototype.tiles[f]));return e};
hexTile.prototype.destroy=function(){hexTile.prototype.tiles.splice(hexTile.prototype.tiles.indexOf(this),1);for(var a=0;6>a;a++)null!=this.neighbors[a]&&(this.neighbors[a].neighbors[(a+3)%6]=null)};hexTile.prototype.setMaterial=function(a){this.materialIndex=a};hexTile.prototype.setWallMaterial=function(a){this.wallMaterialIndex=a};hexTile.prototype.setPillarMaterial=function(a){this.pillarMaterialIndex=a};hexTile.prototype.setSplitHexMaterial=function(a){this.splitHexMaterialIndex=a};
hexTile.prototype.findNeighbors=function(a,b,c,d){2>(-2<c)&&2>(-2<d)&&(1E-6>Math.abs(c-hexTile.prototype.neighborOffset[5].x)?1E-6>Math.abs(d-hexTile.prototype.neighborOffset[5].y)?a.addNeighbor(this,5):1E-6>Math.abs(d-hexTile.prototype.neighborOffset[4].y)&&a.addNeighbor(this,4):1E-6>Math.abs(c-hexTile.prototype.neighborOffset[0].x)?1E-6>Math.abs(d-hexTile.prototype.neighborOffset[0].y)?a.addNeighbor(this,0):1E-6>Math.abs(d-hexTile.prototype.neighborOffset[3].y)&&a.addNeighbor(this,3):1E-6>Math.abs(c-
hexTile.prototype.neighborOffset[1].x)&&(1E-6>Math.abs(d-hexTile.prototype.neighborOffset[1].y)?a.addNeighbor(this,1):1E-6>Math.abs(d-hexTile.prototype.neighborOffset[2].y)&&a.addNeighbor(this,2)));b[this.id]=!0;for(var e=0;6>e&&(!(null!=this.neighbors[e]&&!0!=b[this.neighbors[e].id])||!(this.neighbors[e].findNeighbors(a,b,c+hexTile.prototype.neighborOffset[e].x,d+hexTile.prototype.neighborOffset[e].y),this===a));e++);};
hexTile.prototype.addNeighbor=function(a,b){this.neighbors[b]=a;a.neighbors[(b+3)%6]=this;this.sideHeight[b]=a.sideHeight[(b+3)%6]=(this.height+a.height)/2};
hexTile.prototype.calculateHeights=function(a){if(a){for(var b in hexTile.prototype.tiles)hexTile.prototype.tiles[b].calculateSideHeights();for(b in hexTile.prototype.tiles)hexTile.prototype.tiles[b].calculateCornerHeights()}else for(b in this.clearCornerHeights(1),this.calculateSideHeights(),this.calculateCornerHeights(),this.neighbors)this.neighbors[b].calculateSideHeights(),this.neighbors[b].calculateCornerHeights()};
hexTile.prototype.calculateSideHeights=function(){for(var a=0;6>a;a++)this.sideHeight[a]=null!=this.neighbors[a]?(this.height+this.neighbors[a].height)/2:this.height};
hexTile.prototype.calculateCornerHeights=function(){for(var a=0;6>a;a++)if(null==this.cornerHeight[a]||void 0===this.cornerHeight[a])null!=this.neighbors[a]?(this.cornerHeight[a]=(this.sideHeight[a]+this.sideHeight[(a+1)%6]+this.neighbors[a].sideHeight[(a+2)%6])/3,this.neighbors[a].cornerHeight[(a+2)%6]=this.cornerHeight[a],null!=this.neighbors[(a+1)%6]&&(this.neighbors[(a+1)%6].cornerHeight[(a+4)%6]=this.cornerHeight[a])):null!=this.neighbors[(a+1)%6]?(this.cornerHeight[a]=(this.sideHeight[a]+this.sideHeight[(a+
1)%6]+this.neighbors[(a+1)%6].sideHeight[(a+4)%6])/3,this.neighbors[(a+1)%6].cornerHeight[(a+4)%6]=this.cornerHeight[a]):this.cornerHeight[a]=(this.sideHeight[a]+this.sideHeight[(a+1)%6])/2};hexTile.prototype.clearCornerHeights=function(a){for(var b=0;6>b;b++)this.cornerHeight[b]=null;this.cornersCalculated=!1;if(1!=a)for(b=0;6>b;b++)null!=this.neighbors[b]&&!0==this.neighbors[b].cornersCalculated&&this.neighbors[b].clearCornerHeights(a-1)};
hexTile.prototype.anyPathToTile=function(a,b,c){var d=null;if(0==c)return null;b[this.id]=1;for(var e in this.neighbors){if(this.neighbors[e]===a||this===a)return[a];if(null!=this.neighbors[e]&&void 0===b[this.neighbors[e].id]&&(d=this.neighbors[e].anyPathToTile(a,b,c-1),null!=d))return[this].concat(d)}return null};hexTile.prototype.toggleSplitHex=function(){return this.splitHex=!this.splitHex};hexTile.prototype.rotateSplitHex=function(){this.splitHexSide=(this.splitHexSide+1)%6};
hexTile.prototype.changeSizeSplitHex=function(){this.splitHexSize=(this.splitHexSize+1)%3};hexTile.prototype.toggleWall=function(){return this.wall=!this.wall};hexTile.prototype.rotateWall=function(){this.wallSide=(this.wallSide+1)%3};hexTile.prototype.toggleWallRelativeHeight=function(){this.wallRelativeHeight=!this.wallRelativeHeight};hexTile.prototype.setWallHeight=function(a){this.wallHeight=a};hexTile.prototype.changeWallTaper=function(){this.wallTaper=(this.wallTaper+0.2)%1};
hexTile.prototype.togglePillar=function(){return this.pillar=!this.pillar};hexTile.prototype.rotatePillar=function(){this.pillarSide=(this.pillarSide+1)%6};hexTile.prototype.togglePillarRelativeHeight=function(){this.pillarRelativeHeight=!this.pillarRelativeHeight};hexTile.prototype.setPillarHeight=function(a){this.pillarHeight=a};hexTile.prototype.changeSizePillar=function(){this.pillarSize=(this.pillarSize+1)%4};
hexTile.prototype.changePillarTaper=function(){this.pillarTaper=(this.pillarTaper+0.2)%1};
hexTile.prototype.getExportTileMin=function(){var a=[],b={},c=!1;a[0]=this.id;a[1]=null;a[2]=null;a[3]=Math.round(this.height);0!=this.materialIndex&&(b.m=parseInt(this.materialIndex),c=!0);null!=this.gameEntity&&(b.g=parseInt(this.gameEntity),c=!0);this.splitHex&&(b.s=[],b.s[0]=parseInt(this.splitHexMaterialIndex),b.s[1]=this.splitHexSide,b.s[2]=this.splitHexSize,c=!0);this.wall&&(b.w=[],b.w[0]=parseInt(this.wallMaterialIndex),b.w[1]=this.wallSide,b.w[2]=Math.round(this.wallHeight),b.w[3]=this.wallRelativeHeight?
1:0,b.w[4]=Math.round(10*this.wallTaper)/10,c=!0);this.pillar&&(b.p=[],b.p[0]=parseInt(this.pillarMaterialIndex),b.p[1]=this.pillarSide,b.p[2]=Math.round(this.pillarHeight),b.p[3]=this.pillarRelativeHeight?1:0,b.p[4]=this.pillarSize,b.p[5]=Math.round(10*this.pillarTaper)/10,c=!0);c&&(a[4]=b);return a};
hexTile.prototype.setFromImport=function(a){this.height=a[3];void 0!==a[4]&&(a=a[4],this.materialIndex=a.m||0,void 0!==a.g&&(this.gameEntity=a.g),void 0!==a.s&&(this.splitHex=!0,this.splitHexMaterialIndex=a.s[0],this.splitHexSide=a.s[1],this.splitHexSize=a.s[2]),void 0!==a.w&&(this.wall=!0,this.wallMaterialIndex=a.w[0],this.wallSide=a.w[1],this.wallHeight=a.w[2],this.wallRelativeHeight=a.w[3],this.wallTaper=a.w[4]),void 0!==a.p&&(this.pillar=!0,this.pillarMaterialIndex=a.p[0],this.pillarSide=a.p[1],
this.pillarHeight=a.p[2],this.pillarRelativeHeight=a.p[3],this.pillarSize=a.p[4],this.pillarTaper=a.p[5]))};hexTile.prototype.getLowestCornerHeight=function(){for(var a=this.cornerHeight[0],b=1;6>b;b++)a=Math.min(a,this.cornerHeight[b]);return a};hexTile.prototype.getHighestCornerHeight=function(){for(var a=this.cornerHeight[0],b=1;6>b;b++)a=Math.max(a,this.cornerHeight[b]);return a};